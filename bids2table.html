<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="generator" content="pdoc 14.0.0"/>
    <title>bids2table API documentation</title>

    <style>/*! * Bootstrap Reboot v5.0.0 (https://getbootstrap.com/) * Copyright 2011-2021 The Bootstrap Authors * Copyright 2011-2021 Twitter, Inc. * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE) * Forked from Normalize.css, licensed MIT (https://github.com/necolas/normalize.css/blob/master/LICENSE.md) */*,::after,::before{box-sizing:border-box}@media (prefers-reduced-motion:no-preference){:root{scroll-behavior:smooth}}body{margin:0;font-family:system-ui,-apple-system,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Noto Sans","Liberation Sans",sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji";font-size:1rem;font-weight:400;line-height:1.5;color:#212529;background-color:#fff;-webkit-text-size-adjust:100%;-webkit-tap-highlight-color:transparent}hr{margin:1rem 0;color:inherit;background-color:currentColor;border:0;opacity:.25}hr:not([size]){height:1px}h1,h2,h3,h4,h5,h6{margin-top:0;margin-bottom:.5rem;font-weight:500;line-height:1.2}h1{font-size:calc(1.375rem + 1.5vw)}@media (min-width:1200px){h1{font-size:2.5rem}}h2{font-size:calc(1.325rem + .9vw)}@media (min-width:1200px){h2{font-size:2rem}}h3{font-size:calc(1.3rem + .6vw)}@media (min-width:1200px){h3{font-size:1.75rem}}h4{font-size:calc(1.275rem + .3vw)}@media (min-width:1200px){h4{font-size:1.5rem}}h5{font-size:1.25rem}h6{font-size:1rem}p{margin-top:0;margin-bottom:1rem}abbr[data-bs-original-title],abbr[title]{-webkit-text-decoration:underline dotted;text-decoration:underline dotted;cursor:help;-webkit-text-decoration-skip-ink:none;text-decoration-skip-ink:none}address{margin-bottom:1rem;font-style:normal;line-height:inherit}ol,ul{padding-left:2rem}dl,ol,ul{margin-top:0;margin-bottom:1rem}ol ol,ol ul,ul ol,ul ul{margin-bottom:0}dt{font-weight:700}dd{margin-bottom:.5rem;margin-left:0}blockquote{margin:0 0 1rem}b,strong{font-weight:bolder}small{font-size:.875em}mark{padding:.2em;background-color:#fcf8e3}sub,sup{position:relative;font-size:.75em;line-height:0;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}a{color:#0d6efd;text-decoration:underline}a:hover{color:#0a58ca}a:not([href]):not([class]),a:not([href]):not([class]):hover{color:inherit;text-decoration:none}code,kbd,pre,samp{font-family:SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace;font-size:1em;direction:ltr;unicode-bidi:bidi-override}pre{display:block;margin-top:0;margin-bottom:1rem;overflow:auto;font-size:.875em}pre code{font-size:inherit;color:inherit;word-break:normal}code{font-size:.875em;color:#d63384;word-wrap:break-word}a>code{color:inherit}kbd{padding:.2rem .4rem;font-size:.875em;color:#fff;background-color:#212529;border-radius:.2rem}kbd kbd{padding:0;font-size:1em;font-weight:700}figure{margin:0 0 1rem}img,svg{vertical-align:middle}table{caption-side:bottom;border-collapse:collapse}caption{padding-top:.5rem;padding-bottom:.5rem;color:#6c757d;text-align:left}th{text-align:inherit;text-align:-webkit-match-parent}tbody,td,tfoot,th,thead,tr{border-color:inherit;border-style:solid;border-width:0}label{display:inline-block}button{border-radius:0}button:focus:not(:focus-visible){outline:0}button,input,optgroup,select,textarea{margin:0;font-family:inherit;font-size:inherit;line-height:inherit}button,select{text-transform:none}[role=button]{cursor:pointer}select{word-wrap:normal}select:disabled{opacity:1}[list]::-webkit-calendar-picker-indicator{display:none}[type=button],[type=reset],[type=submit],button{-webkit-appearance:button}[type=button]:not(:disabled),[type=reset]:not(:disabled),[type=submit]:not(:disabled),button:not(:disabled){cursor:pointer}::-moz-focus-inner{padding:0;border-style:none}textarea{resize:vertical}fieldset{min-width:0;padding:0;margin:0;border:0}legend{float:left;width:100%;padding:0;margin-bottom:.5rem;font-size:calc(1.275rem + .3vw);line-height:inherit}@media (min-width:1200px){legend{font-size:1.5rem}}legend+*{clear:left}::-webkit-datetime-edit-day-field,::-webkit-datetime-edit-fields-wrapper,::-webkit-datetime-edit-hour-field,::-webkit-datetime-edit-minute,::-webkit-datetime-edit-month-field,::-webkit-datetime-edit-text,::-webkit-datetime-edit-year-field{padding:0}::-webkit-inner-spin-button{height:auto}[type=search]{outline-offset:-2px;-webkit-appearance:textfield}::-webkit-search-decoration{-webkit-appearance:none}::-webkit-color-swatch-wrapper{padding:0}::file-selector-button{font:inherit}::-webkit-file-upload-button{font:inherit;-webkit-appearance:button}output{display:inline-block}iframe{border:0}summary{display:list-item;cursor:pointer}progress{vertical-align:baseline}[hidden]{display:none!important}</style>
    <style>/*! syntax-highlighting.css */pre{line-height:125%;}span.linenos{color:inherit; background-color:transparent; padding-left:5px; padding-right:20px;}.pdoc-code .hll{background-color:#ffffcc}.pdoc-code{background:#f8f8f8;}.pdoc-code .c{color:#3D7B7B; font-style:italic}.pdoc-code .err{border:1px solid #FF0000}.pdoc-code .k{color:#008000; font-weight:bold}.pdoc-code .o{color:#666666}.pdoc-code .ch{color:#3D7B7B; font-style:italic}.pdoc-code .cm{color:#3D7B7B; font-style:italic}.pdoc-code .cp{color:#9C6500}.pdoc-code .cpf{color:#3D7B7B; font-style:italic}.pdoc-code .c1{color:#3D7B7B; font-style:italic}.pdoc-code .cs{color:#3D7B7B; font-style:italic}.pdoc-code .gd{color:#A00000}.pdoc-code .ge{font-style:italic}.pdoc-code .gr{color:#E40000}.pdoc-code .gh{color:#000080; font-weight:bold}.pdoc-code .gi{color:#008400}.pdoc-code .go{color:#717171}.pdoc-code .gp{color:#000080; font-weight:bold}.pdoc-code .gs{font-weight:bold}.pdoc-code .gu{color:#800080; font-weight:bold}.pdoc-code .gt{color:#0044DD}.pdoc-code .kc{color:#008000; font-weight:bold}.pdoc-code .kd{color:#008000; font-weight:bold}.pdoc-code .kn{color:#008000; font-weight:bold}.pdoc-code .kp{color:#008000}.pdoc-code .kr{color:#008000; font-weight:bold}.pdoc-code .kt{color:#B00040}.pdoc-code .m{color:#666666}.pdoc-code .s{color:#BA2121}.pdoc-code .na{color:#687822}.pdoc-code .nb{color:#008000}.pdoc-code .nc{color:#0000FF; font-weight:bold}.pdoc-code .no{color:#880000}.pdoc-code .nd{color:#AA22FF}.pdoc-code .ni{color:#717171; font-weight:bold}.pdoc-code .ne{color:#CB3F38; font-weight:bold}.pdoc-code .nf{color:#0000FF}.pdoc-code .nl{color:#767600}.pdoc-code .nn{color:#0000FF; font-weight:bold}.pdoc-code .nt{color:#008000; font-weight:bold}.pdoc-code .nv{color:#19177C}.pdoc-code .ow{color:#AA22FF; font-weight:bold}.pdoc-code .w{color:#bbbbbb}.pdoc-code .mb{color:#666666}.pdoc-code .mf{color:#666666}.pdoc-code .mh{color:#666666}.pdoc-code .mi{color:#666666}.pdoc-code .mo{color:#666666}.pdoc-code .sa{color:#BA2121}.pdoc-code .sb{color:#BA2121}.pdoc-code .sc{color:#BA2121}.pdoc-code .dl{color:#BA2121}.pdoc-code .sd{color:#BA2121; font-style:italic}.pdoc-code .s2{color:#BA2121}.pdoc-code .se{color:#AA5D1F; font-weight:bold}.pdoc-code .sh{color:#BA2121}.pdoc-code .si{color:#A45A77; font-weight:bold}.pdoc-code .sx{color:#008000}.pdoc-code .sr{color:#A45A77}.pdoc-code .s1{color:#BA2121}.pdoc-code .ss{color:#19177C}.pdoc-code .bp{color:#008000}.pdoc-code .fm{color:#0000FF}.pdoc-code .vc{color:#19177C}.pdoc-code .vg{color:#19177C}.pdoc-code .vi{color:#19177C}.pdoc-code .vm{color:#19177C}.pdoc-code .il{color:#666666}</style>
    <style>/*! theme.css */:root{--pdoc-background:#fff;}.pdoc{--text:#212529;--muted:#6c757d;--link:#3660a5;--link-hover:#1659c5;--code:#f8f8f8;--active:#fff598;--accent:#eee;--accent2:#c1c1c1;--nav-hover:rgba(255, 255, 255, 0.5);--name:#0066BB;--def:#008800;--annotation:#007020;}</style>
    <style>/*! layout.css */html, body{width:100%;height:100%;}html, main{scroll-behavior:smooth;}body{background-color:var(--pdoc-background);}@media (max-width:769px){#navtoggle{cursor:pointer;position:absolute;width:50px;height:40px;top:1rem;right:1rem;border-color:var(--text);color:var(--text);display:flex;opacity:0.8;z-index:999;}#navtoggle:hover{opacity:1;}#togglestate + div{display:none;}#togglestate:checked + div{display:inherit;}main, header{padding:2rem 3vw;}header + main{margin-top:-3rem;}.git-button{display:none !important;}nav input[type="search"]{max-width:77%;}nav input[type="search"]:first-child{margin-top:-6px;}nav input[type="search"]:valid ~ *{display:none !important;}}@media (min-width:770px){:root{--sidebar-width:clamp(12.5rem, 28vw, 22rem);}nav{position:fixed;overflow:auto;height:100vh;width:var(--sidebar-width);}main, header{padding:3rem 2rem 3rem calc(var(--sidebar-width) + 3rem);width:calc(54rem + var(--sidebar-width));max-width:100%;}header + main{margin-top:-4rem;}#navtoggle{display:none;}}#togglestate{position:absolute;height:0;opacity:0;}nav.pdoc{--pad:clamp(0.5rem, 2vw, 1.75rem);--indent:1.5rem;background-color:var(--accent);border-right:1px solid var(--accent2);box-shadow:0 0 20px rgba(50, 50, 50, .2) inset;padding:0 0 0 var(--pad);overflow-wrap:anywhere;scrollbar-width:thin; scrollbar-color:var(--accent2) transparent }nav.pdoc::-webkit-scrollbar{width:.4rem; }nav.pdoc::-webkit-scrollbar-thumb{background-color:var(--accent2); }nav.pdoc > div{padding:var(--pad) 0;}nav.pdoc .module-list-button{display:inline-flex;align-items:center;color:var(--text);border-color:var(--muted);margin-bottom:1rem;}nav.pdoc .module-list-button:hover{border-color:var(--text);}nav.pdoc input[type=search]{display:block;outline-offset:0;width:calc(100% - var(--pad));}nav.pdoc .logo{max-width:calc(100% - var(--pad));max-height:35vh;display:block;margin:0 auto 1rem;transform:translate(calc(-.5 * var(--pad)), 0);}nav.pdoc ul{list-style:none;padding-left:0;}nav.pdoc > div > ul{margin-left:calc(0px - var(--pad));}nav.pdoc li a{padding:.2rem 0 .2rem calc(var(--pad) + var(--indent));}nav.pdoc > div > ul > li > a{padding-left:var(--pad);}nav.pdoc li{transition:all 100ms;}nav.pdoc li:hover{background-color:var(--nav-hover);}nav.pdoc a, nav.pdoc a:hover{color:var(--text);}nav.pdoc a{display:block;}nav.pdoc > h2:first-of-type{margin-top:1.5rem;}nav.pdoc .class:before{content:"class ";color:var(--muted);}nav.pdoc .function:after{content:"()";color:var(--muted);}nav.pdoc footer:before{content:"";display:block;width:calc(100% - var(--pad));border-top:solid var(--accent2) 1px;margin-top:1.5rem;padding-top:.5rem;}nav.pdoc footer{font-size:small;}</style>
    <style>/*! content.css */.pdoc{color:var(--text);box-sizing:border-box;line-height:1.5;background:none;}.pdoc .pdoc-button{cursor:pointer;display:inline-block;border:solid black 1px;border-radius:2px;font-size:.75rem;padding:calc(0.5em - 1px) 1em;transition:100ms all;}.pdoc .pdoc-alert{padding:1rem 1rem 1rem calc(1.5rem + 24px);border:1px solid transparent;border-radius:.25rem;background-repeat:no-repeat;background-position:1rem center;margin-bottom:1rem;}.pdoc .pdoc-alert > *:last-child{margin-bottom:0;}.pdoc .pdoc-alert-note {color:#084298;background-color:#cfe2ff;border-color:#b6d4fe;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23084298%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M8%2016A8%208%200%201%200%208%200a8%208%200%200%200%200%2016zm.93-9.412-1%204.705c-.07.34.029.533.304.533.194%200%20.487-.07.686-.246l-.088.416c-.287.346-.92.598-1.465.598-.703%200-1.002-.422-.808-1.319l.738-3.468c.064-.293.006-.399-.287-.47l-.451-.081.082-.381%202.29-.287zM8%205.5a1%201%200%201%201%200-2%201%201%200%200%201%200%202z%22/%3E%3C/svg%3E");}.pdoc .pdoc-alert-warning{color:#664d03;background-color:#fff3cd;border-color:#ffecb5;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23664d03%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M8.982%201.566a1.13%201.13%200%200%200-1.96%200L.165%2013.233c-.457.778.091%201.767.98%201.767h13.713c.889%200%201.438-.99.98-1.767L8.982%201.566zM8%205c.535%200%20.954.462.9.995l-.35%203.507a.552.552%200%200%201-1.1%200L7.1%205.995A.905.905%200%200%201%208%205zm.002%206a1%201%200%201%201%200%202%201%201%200%200%201%200-2z%22/%3E%3C/svg%3E");}.pdoc .pdoc-alert-danger{color:#842029;background-color:#f8d7da;border-color:#f5c2c7;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23842029%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M5.52.359A.5.5%200%200%201%206%200h4a.5.5%200%200%201%20.474.658L8.694%206H12.5a.5.5%200%200%201%20.395.807l-7%209a.5.5%200%200%201-.873-.454L6.823%209.5H3.5a.5.5%200%200%201-.48-.641l2.5-8.5z%22/%3E%3C/svg%3E");}.pdoc .visually-hidden{position:absolute !important;width:1px !important;height:1px !important;padding:0 !important;margin:-1px !important;overflow:hidden !important;clip:rect(0, 0, 0, 0) !important;white-space:nowrap !important;border:0 !important;}.pdoc h1, .pdoc h2, .pdoc h3{font-weight:300;margin:.3em 0;padding:.2em 0;}.pdoc > section:not(.module-info) h1{font-size:1.5rem;font-weight:500;}.pdoc > section:not(.module-info) h2{font-size:1.4rem;font-weight:500;}.pdoc > section:not(.module-info) h3{font-size:1.3rem;font-weight:500;}.pdoc > section:not(.module-info) h4{font-size:1.2rem;}.pdoc > section:not(.module-info) h5{font-size:1.1rem;}.pdoc a{text-decoration:none;color:var(--link);}.pdoc a:hover{color:var(--link-hover);}.pdoc blockquote{margin-left:2rem;}.pdoc pre{border-top:1px solid var(--accent2);border-bottom:1px solid var(--accent2);margin-top:0;margin-bottom:1em;padding:.5rem 0 .5rem .5rem;overflow-x:auto;background-color:var(--code);}.pdoc code{color:var(--text);padding:.2em .4em;margin:0;font-size:85%;background-color:var(--code);border-radius:6px;}.pdoc a > code{color:inherit;}.pdoc pre > code{display:inline-block;font-size:inherit;background:none;border:none;padding:0;}.pdoc > section:not(.module-info){margin-bottom:1.5rem;}.pdoc .modulename{margin-top:0;font-weight:bold;}.pdoc .modulename a{color:var(--link);transition:100ms all;}.pdoc .git-button{float:right;border:solid var(--link) 1px;}.pdoc .git-button:hover{background-color:var(--link);color:var(--pdoc-background);}.view-source-toggle-state,.view-source-toggle-state ~ .pdoc-code{display:none;}.view-source-toggle-state:checked ~ .pdoc-code{display:block;}.view-source-button{display:inline-block;float:right;font-size:.75rem;line-height:1.5rem;color:var(--muted);padding:0 .4rem 0 1.3rem;cursor:pointer;text-indent:-2px;}.view-source-button > span{visibility:hidden;}.module-info .view-source-button{float:none;display:flex;justify-content:flex-end;margin:-1.2rem .4rem -.2rem 0;}.view-source-button::before{position:absolute;content:"View Source";display:list-item;list-style-type:disclosure-closed;}.view-source-toggle-state:checked ~ .attr .view-source-button::before,.view-source-toggle-state:checked ~ .view-source-button::before{list-style-type:disclosure-open;}.pdoc .docstring{margin-bottom:1.5rem;}.pdoc section:not(.module-info) .docstring{margin-left:clamp(0rem, 5vw - 2rem, 1rem);}.pdoc .docstring .pdoc-code{margin-left:1em;margin-right:1em;}.pdoc h1:target,.pdoc h2:target,.pdoc h3:target,.pdoc h4:target,.pdoc h5:target,.pdoc h6:target,.pdoc .pdoc-code > pre > span:target{background-color:var(--active);box-shadow:-1rem 0 0 0 var(--active);}.pdoc .pdoc-code > pre > span:target{display:block;}.pdoc div:target > .attr,.pdoc section:target > .attr,.pdoc dd:target > a{background-color:var(--active);}.pdoc *{scroll-margin:2rem;}.pdoc .pdoc-code .linenos{user-select:none;}.pdoc .attr:hover{filter:contrast(0.95);}.pdoc section, .pdoc .classattr{position:relative;}.pdoc .headerlink{--width:clamp(1rem, 3vw, 2rem);position:absolute;top:0;left:calc(0rem - var(--width));transition:all 100ms ease-in-out;opacity:0;}.pdoc .headerlink::before{content:"#";display:block;text-align:center;width:var(--width);height:2.3rem;line-height:2.3rem;font-size:1.5rem;}.pdoc .attr:hover ~ .headerlink,.pdoc *:target > .headerlink,.pdoc .headerlink:hover{opacity:1;}.pdoc .attr{display:block;margin:.5rem 0 .5rem;padding:.4rem .4rem .4rem 1rem;background-color:var(--accent);overflow-x:auto;}.pdoc .classattr{margin-left:2rem;}.pdoc .name{color:var(--name);font-weight:bold;}.pdoc .def{color:var(--def);font-weight:bold;}.pdoc .signature{background-color:transparent;}.pdoc .param, .pdoc .return-annotation{white-space:pre;}.pdoc .signature.multiline .param{display:block;}.pdoc .signature.condensed .param{display:inline-block;}.pdoc .annotation{color:var(--annotation);}.pdoc .view-value-toggle-state,.pdoc .view-value-toggle-state ~ .default_value{display:none;}.pdoc .view-value-toggle-state:checked ~ .default_value{display:inherit;}.pdoc .view-value-button{font-size:.5rem;vertical-align:middle;border-style:dashed;margin-top:-0.1rem;}.pdoc .view-value-button:hover{background:white;}.pdoc .view-value-button::before{content:"show";text-align:center;width:2.2em;display:inline-block;}.pdoc .view-value-toggle-state:checked ~ .view-value-button::before{content:"hide";}.pdoc .inherited{margin-left:2rem;}.pdoc .inherited dt{font-weight:700;}.pdoc .inherited dt, .pdoc .inherited dd{display:inline;margin-left:0;margin-bottom:.5rem;}.pdoc .inherited dd:not(:last-child):after{content:", ";}.pdoc .inherited .class:before{content:"class ";}.pdoc .inherited .function a:after{content:"()";}.pdoc .search-result .docstring{overflow:auto;max-height:25vh;}.pdoc .search-result.focused > .attr{background-color:var(--active);}.pdoc .attribution{margin-top:2rem;display:block;opacity:0.5;transition:all 200ms;filter:grayscale(100%);}.pdoc .attribution:hover{opacity:1;filter:grayscale(0%);}.pdoc .attribution img{margin-left:5px;height:35px;vertical-align:middle;width:70px;transition:all 200ms;}.pdoc table{display:block;width:max-content;max-width:100%;overflow:auto;margin-bottom:1rem;}.pdoc table th{font-weight:600;}.pdoc table th, .pdoc table td{padding:6px 13px;border:1px solid var(--accent2);}</style>
    <style>/*! custom.css */</style></head>
<body>
    <nav class="pdoc">
        <label id="navtoggle" for="togglestate" class="pdoc-button"><svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 30 30'><path stroke-linecap='round' stroke="currentColor" stroke-miterlimit='10' stroke-width='2' d='M4 7h22M4 15h22M4 23h22'/></svg></label>
        <input id="togglestate" type="checkbox" aria-hidden="true" tabindex="-1">
        <div>


            <h2>Contents</h2>
            <ul>
  <li><a href="#installation">Installation</a></li>
  <li><a href="#quickstart">Quickstart</a></li>
  <li><a href="#table-representation">Table representation</a></li>
</ul>



            <h2>API Documentation</h2>
                <ul class="memberlist">
            <li>
                    <a class="function" href="#bids2table">bids2table</a>
            </li>
            <li>
                    <a class="class" href="#BIDSTable">BIDSTable</a>
                            <ul class="memberlist">
                        <li>
                                <a class="variable" href="#BIDSTable.ds">ds</a>
                        </li>
                        <li>
                                <a class="variable" href="#BIDSTable.ent">ent</a>
                        </li>
                        <li>
                                <a class="variable" href="#BIDSTable.meta">meta</a>
                        </li>
                        <li>
                                <a class="variable" href="#BIDSTable.finfo">finfo</a>
                        </li>
                        <li>
                                <a class="variable" href="#BIDSTable.files">files</a>
                        </li>
                        <li>
                                <a class="variable" href="#BIDSTable.datatypes">datatypes</a>
                        </li>
                        <li>
                                <a class="variable" href="#BIDSTable.modalities">modalities</a>
                        </li>
                        <li>
                                <a class="variable" href="#BIDSTable.subjects">subjects</a>
                        </li>
                        <li>
                                <a class="variable" href="#BIDSTable.entities">entities</a>
                        </li>
                        <li>
                                <a class="variable" href="#BIDSTable.flat_meta">flat_meta</a>
                        </li>
                        <li>
                                <a class="variable" href="#BIDSTable.nested">nested</a>
                        </li>
                        <li>
                                <a class="variable" href="#BIDSTable.flat">flat</a>
                        </li>
                        <li>
                                <a class="function" href="#BIDSTable.filter">filter</a>
                        </li>
                        <li>
                                <a class="function" href="#BIDSTable.filter_multi">filter_multi</a>
                        </li>
                        <li>
                                <a class="function" href="#BIDSTable.sort_entities">sort_entities</a>
                        </li>
                        <li>
                                <a class="function" href="#BIDSTable.from_df">from_df</a>
                        </li>
                        <li>
                                <a class="function" href="#BIDSTable.from_parquet">from_parquet</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#BIDSFile">BIDSFile</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#BIDSFile.__init__">BIDSFile</a>
                        </li>
                        <li>
                                <a class="variable" href="#BIDSFile.dataset">dataset</a>
                        </li>
                        <li>
                                <a class="variable" href="#BIDSFile.root">root</a>
                        </li>
                        <li>
                                <a class="variable" href="#BIDSFile.path">path</a>
                        </li>
                        <li>
                                <a class="variable" href="#BIDSFile.entities">entities</a>
                        </li>
                        <li>
                                <a class="variable" href="#BIDSFile.metadata">metadata</a>
                        </li>
                        <li>
                                <a class="variable" href="#BIDSFile.relative_path">relative_path</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#BIDSEntities">BIDSEntities</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#BIDSEntities.__init__">BIDSEntities</a>
                        </li>
                        <li>
                                <a class="variable" href="#BIDSEntities.sub">sub</a>
                        </li>
                        <li>
                                <a class="variable" href="#BIDSEntities.ses">ses</a>
                        </li>
                        <li>
                                <a class="variable" href="#BIDSEntities.sample">sample</a>
                        </li>
                        <li>
                                <a class="variable" href="#BIDSEntities.task">task</a>
                        </li>
                        <li>
                                <a class="variable" href="#BIDSEntities.acq">acq</a>
                        </li>
                        <li>
                                <a class="variable" href="#BIDSEntities.ce">ce</a>
                        </li>
                        <li>
                                <a class="variable" href="#BIDSEntities.trc">trc</a>
                        </li>
                        <li>
                                <a class="variable" href="#BIDSEntities.stain">stain</a>
                        </li>
                        <li>
                                <a class="variable" href="#BIDSEntities.rec">rec</a>
                        </li>
                        <li>
                                <a class="variable" href="#BIDSEntities.dir">dir</a>
                        </li>
                        <li>
                                <a class="variable" href="#BIDSEntities.run">run</a>
                        </li>
                        <li>
                                <a class="variable" href="#BIDSEntities.mod">mod</a>
                        </li>
                        <li>
                                <a class="variable" href="#BIDSEntities.echo">echo</a>
                        </li>
                        <li>
                                <a class="variable" href="#BIDSEntities.flip">flip</a>
                        </li>
                        <li>
                                <a class="variable" href="#BIDSEntities.inv">inv</a>
                        </li>
                        <li>
                                <a class="variable" href="#BIDSEntities.mt">mt</a>
                        </li>
                        <li>
                                <a class="variable" href="#BIDSEntities.part">part</a>
                        </li>
                        <li>
                                <a class="variable" href="#BIDSEntities.proc">proc</a>
                        </li>
                        <li>
                                <a class="variable" href="#BIDSEntities.hemi">hemi</a>
                        </li>
                        <li>
                                <a class="variable" href="#BIDSEntities.space">space</a>
                        </li>
                        <li>
                                <a class="variable" href="#BIDSEntities.split">split</a>
                        </li>
                        <li>
                                <a class="variable" href="#BIDSEntities.recording">recording</a>
                        </li>
                        <li>
                                <a class="variable" href="#BIDSEntities.chunk">chunk</a>
                        </li>
                        <li>
                                <a class="variable" href="#BIDSEntities.atlas">atlas</a>
                        </li>
                        <li>
                                <a class="variable" href="#BIDSEntities.res">res</a>
                        </li>
                        <li>
                                <a class="variable" href="#BIDSEntities.den">den</a>
                        </li>
                        <li>
                                <a class="variable" href="#BIDSEntities.label">label</a>
                        </li>
                        <li>
                                <a class="variable" href="#BIDSEntities.desc">desc</a>
                        </li>
                        <li>
                                <a class="variable" href="#BIDSEntities.datatype">datatype</a>
                        </li>
                        <li>
                                <a class="variable" href="#BIDSEntities.suffix">suffix</a>
                        </li>
                        <li>
                                <a class="variable" href="#BIDSEntities.ext">ext</a>
                        </li>
                        <li>
                                <a class="variable" href="#BIDSEntities.extra_entities">extra_entities</a>
                        </li>
                        <li>
                                <a class="function" href="#BIDSEntities.special">special</a>
                        </li>
                        <li>
                                <a class="function" href="#BIDSEntities.from_dict">from_dict</a>
                        </li>
                        <li>
                                <a class="function" href="#BIDSEntities.from_path">from_path</a>
                        </li>
                        <li>
                                <a class="function" href="#BIDSEntities.to_dict">to_dict</a>
                        </li>
                        <li>
                                <a class="function" href="#BIDSEntities.to_path">to_path</a>
                        </li>
                        <li>
                                <a class="function" href="#BIDSEntities.with_update">with_update</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="function" href="#parse_bids_entities">parse_bids_entities</a>
            </li>
            <li>
                    <a class="function" href="#join_bids_path">join_bids_path</a>
            </li>
    </ul>



        <a class="attribution" title="pdoc: Python API documentation generator" href="https://pdoc.dev" target="_blank">
            built with <span class="visually-hidden">pdoc</span><img
                alt="pdoc logo"
                src="data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20role%3D%22img%22%20aria-label%3D%22pdoc%20logo%22%20width%3D%22300%22%20height%3D%22150%22%20viewBox%3D%22-1%200%2060%2030%22%3E%3Ctitle%3Epdoc%3C/title%3E%3Cpath%20d%3D%22M29.621%2021.293c-.011-.273-.214-.475-.511-.481a.5.5%200%200%200-.489.503l-.044%201.393c-.097.551-.695%201.215-1.566%201.704-.577.428-1.306.486-2.193.182-1.426-.617-2.467-1.654-3.304-2.487l-.173-.172a3.43%203.43%200%200%200-.365-.306.49.49%200%200%200-.286-.196c-1.718-1.06-4.931-1.47-7.353.191l-.219.15c-1.707%201.187-3.413%202.131-4.328%201.03-.02-.027-.49-.685-.141-1.763.233-.721.546-2.408.772-4.076.042-.09.067-.187.046-.288.166-1.347.277-2.625.241-3.351%201.378-1.008%202.271-2.586%202.271-4.362%200-.976-.272-1.935-.788-2.774-.057-.094-.122-.18-.184-.268.033-.167.052-.339.052-.516%200-1.477-1.202-2.679-2.679-2.679-.791%200-1.496.352-1.987.9a6.3%206.3%200%200%200-1.001.029c-.492-.564-1.207-.929-2.012-.929-1.477%200-2.679%201.202-2.679%202.679A2.65%202.65%200%200%200%20.97%206.554c-.383.747-.595%201.572-.595%202.41%200%202.311%201.507%204.29%203.635%205.107-.037.699-.147%202.27-.423%203.294l-.137.461c-.622%202.042-2.515%208.257%201.727%2010.643%201.614.908%203.06%201.248%204.317%201.248%202.665%200%204.492-1.524%205.322-2.401%201.476-1.559%202.886-1.854%206.491.82%201.877%201.393%203.514%201.753%204.861%201.068%202.223-1.713%202.811-3.867%203.399-6.374.077-.846.056-1.469.054-1.537zm-4.835%204.313c-.054.305-.156.586-.242.629-.034-.007-.131-.022-.307-.157-.145-.111-.314-.478-.456-.908.221.121.432.25.675.355.115.039.219.051.33.081zm-2.251-1.238c-.05.33-.158.648-.252.694-.022.001-.125-.018-.307-.157-.217-.166-.488-.906-.639-1.573.358.344.754.693%201.198%201.036zm-3.887-2.337c-.006-.116-.018-.231-.041-.342.635.145%201.189.368%201.599.625.097.231.166.481.174.642-.03.049-.055.101-.067.158-.046.013-.128.026-.298.004-.278-.037-.901-.57-1.367-1.087zm-1.127-.497c.116.306.176.625.12.71-.019.014-.117.045-.345.016-.206-.027-.604-.332-.986-.695.41-.051.816-.056%201.211-.031zm-4.535%201.535c.209.22.379.47.358.598-.006.041-.088.138-.351.234-.144.055-.539-.063-.979-.259a11.66%2011.66%200%200%200%20.972-.573zm.983-.664c.359-.237.738-.418%201.126-.554.25.237.479.548.457.694-.006.042-.087.138-.351.235-.174.064-.694-.105-1.232-.375zm-3.381%201.794c-.022.145-.061.29-.149.401-.133.166-.358.248-.69.251h-.002c-.133%200-.306-.26-.45-.621.417.091.854.07%201.291-.031zm-2.066-8.077a4.78%204.78%200%200%201-.775-.584c.172-.115.505-.254.88-.378l-.105.962zm-.331%202.302a10.32%2010.32%200%200%201-.828-.502c.202-.143.576-.328.984-.49l-.156.992zm-.45%202.157l-.701-.403c.214-.115.536-.249.891-.376a11.57%2011.57%200%200%201-.19.779zm-.181%201.716c.064.398.194.702.298.893-.194-.051-.435-.162-.736-.398.061-.119.224-.3.438-.495zM8.87%204.141c0%20.152-.123.276-.276.276s-.275-.124-.275-.276.123-.276.276-.276.275.124.275.276zm-.735-.389a1.15%201.15%200%200%200-.314.783%201.16%201.16%200%200%200%201.162%201.162c.457%200%20.842-.27%201.032-.653.026.117.042.238.042.362a1.68%201.68%200%200%201-1.679%201.679%201.68%201.68%200%200%201-1.679-1.679c0-.843.626-1.535%201.436-1.654zM5.059%205.406A1.68%201.68%200%200%201%203.38%207.085a1.68%201.68%200%200%201-1.679-1.679c0-.037.009-.072.011-.109.21.3.541.508.935.508a1.16%201.16%200%200%200%201.162-1.162%201.14%201.14%200%200%200-.474-.912c.015%200%20.03-.005.045-.005.926.001%201.679.754%201.679%201.68zM3.198%204.141c0%20.152-.123.276-.276.276s-.275-.124-.275-.276.123-.276.276-.276.275.124.275.276zM1.375%208.964c0-.52.103-1.035.288-1.52.466.394%201.06.64%201.717.64%201.144%200%202.116-.725%202.499-1.738.383%201.012%201.355%201.738%202.499%201.738.867%200%201.631-.421%202.121-1.062.307.605.478%201.267.478%201.942%200%202.486-2.153%204.51-4.801%204.51s-4.801-2.023-4.801-4.51zm24.342%2019.349c-.985.498-2.267.168-3.813-.979-3.073-2.281-5.453-3.199-7.813-.705-1.315%201.391-4.163%203.365-8.423.97-3.174-1.786-2.239-6.266-1.261-9.479l.146-.492c.276-1.02.395-2.457.444-3.268a6.11%206.11%200%200%200%201.18.115%206.01%206.01%200%200%200%202.536-.562l-.006.175c-.802.215-1.848.612-2.021%201.25-.079.295.021.601.274.837.219.203.415.364.598.501-.667.304-1.243.698-1.311%201.179-.02.144-.022.507.393.787.213.144.395.26.564.365-1.285.521-1.361.96-1.381%201.126-.018.142-.011.496.427.746l.854.489c-.473.389-.971.914-.999%201.429-.018.278.095.532.316.713.675.556%201.231.721%201.653.721.059%200%20.104-.014.158-.02.207.707.641%201.64%201.513%201.64h.013c.8-.008%201.236-.345%201.462-.626.173-.216.268-.457.325-.692.424.195.93.374%201.372.374.151%200%20.294-.021.423-.068.732-.27.944-.704.993-1.021.009-.061.003-.119.002-.179.266.086.538.147.789.147.15%200%20.294-.021.423-.069.542-.2.797-.489.914-.754.237.147.478.258.704.288.106.014.205.021.296.021.356%200%20.595-.101.767-.229.438.435%201.094.992%201.656%201.067.106.014.205.021.296.021a1.56%201.56%200%200%200%20.323-.035c.17.575.453%201.289.866%201.605.358.273.665.362.914.362a.99.99%200%200%200%20.421-.093%201.03%201.03%200%200%200%20.245-.164c.168.428.39.846.68%201.068.358.273.665.362.913.362a.99.99%200%200%200%20.421-.093c.317-.148.512-.448.639-.762.251.157.495.257.726.257.127%200%20.25-.024.37-.071.427-.17.706-.617.841-1.314.022-.015.047-.022.068-.038.067-.051.133-.104.196-.159-.443%201.486-1.107%202.761-2.086%203.257zM8.66%209.925a.5.5%200%201%200-1%200c0%20.653-.818%201.205-1.787%201.205s-1.787-.552-1.787-1.205a.5.5%200%201%200-1%200c0%201.216%201.25%202.205%202.787%202.205s2.787-.989%202.787-2.205zm4.4%2015.965l-.208.097c-2.661%201.258-4.708%201.436-6.086.527-1.542-1.017-1.88-3.19-1.844-4.198a.4.4%200%200%200-.385-.414c-.242-.029-.406.164-.414.385-.046%201.249.367%203.686%202.202%204.896.708.467%201.547.7%202.51.7%201.248%200%202.706-.392%204.362-1.174l.185-.086a.4.4%200%200%200%20.205-.527c-.089-.204-.326-.291-.527-.206zM9.547%202.292c.093.077.205.114.317.114a.5.5%200%200%200%20.318-.886L8.817.397a.5.5%200%200%200-.703.068.5.5%200%200%200%20.069.703l1.364%201.124zm-7.661-.065c.086%200%20.173-.022.253-.068l1.523-.893a.5.5%200%200%200-.506-.863l-1.523.892a.5.5%200%200%200-.179.685c.094.158.261.247.432.247z%22%20transform%3D%22matrix%28-1%200%200%201%2058%200%29%22%20fill%3D%22%233bb300%22/%3E%3Cpath%20d%3D%22M.3%2021.86V10.18q0-.46.02-.68.04-.22.18-.5.28-.54%201.34-.54%201.06%200%201.42.28.38.26.44.78.76-1.04%202.38-1.04%201.64%200%203.1%201.54%201.46%201.54%201.46%203.58%200%202.04-1.46%203.58-1.44%201.54-3.08%201.54-1.64%200-2.38-.92v4.04q0%20.46-.04.68-.02.22-.18.5-.14.3-.5.42-.36.12-.98.12-.62%200-1-.12-.36-.12-.52-.4-.14-.28-.18-.5-.02-.22-.02-.68zm3.96-9.42q-.46.54-.46%201.18%200%20.64.46%201.18.48.52%201.2.52.74%200%201.24-.52.52-.52.52-1.18%200-.66-.48-1.18-.48-.54-1.26-.54-.76%200-1.22.54zm14.741-8.36q.16-.3.54-.42.38-.12%201-.12.64%200%201.02.12.38.12.52.42.16.3.18.54.04.22.04.68v11.94q0%20.46-.04.7-.02.22-.18.5-.3.54-1.7.54-1.38%200-1.54-.98-.84.96-2.34.96-1.8%200-3.28-1.56-1.48-1.58-1.48-3.66%200-2.1%201.48-3.68%201.5-1.58%203.28-1.58%201.48%200%202.3%201v-4.2q0-.46.02-.68.04-.24.18-.52zm-3.24%2010.86q.52.54%201.26.54.74%200%201.22-.54.5-.54.5-1.18%200-.66-.48-1.22-.46-.56-1.26-.56-.8%200-1.28.56-.48.54-.48%201.2%200%20.66.52%201.2zm7.833-1.2q0-2.4%201.68-3.96%201.68-1.56%203.84-1.56%202.16%200%203.82%201.56%201.66%201.54%201.66%203.94%200%201.66-.86%202.96-.86%201.28-2.1%201.9-1.22.6-2.54.6-1.32%200-2.56-.64-1.24-.66-2.1-1.92-.84-1.28-.84-2.88zm4.18%201.44q.64.48%201.3.48.66%200%201.32-.5.66-.5.66-1.48%200-.98-.62-1.46-.62-.48-1.34-.48-.72%200-1.34.5-.62.5-.62%201.48%200%20.96.64%201.46zm11.412-1.44q0%20.84.56%201.32.56.46%201.18.46.64%200%201.18-.36.56-.38.9-.38.6%200%201.46%201.06.46.58.46%201.04%200%20.76-1.1%201.42-1.14.8-2.8.8-1.86%200-3.58-1.34-.82-.64-1.34-1.7-.52-1.08-.52-2.36%200-1.3.52-2.34.52-1.06%201.34-1.7%201.66-1.32%203.54-1.32.76%200%201.48.22.72.2%201.06.4l.32.2q.36.24.56.38.52.4.52.92%200%20.5-.42%201.14-.72%201.1-1.38%201.1-.38%200-1.08-.44-.36-.34-1.04-.34-.66%200-1.24.48-.58.48-.58%201.34z%22%20fill%3D%22green%22/%3E%3C/svg%3E"/>
        </a>
</div>
    </nav>
    <main class="pdoc">
            <section class="module-info">
                    <h1 class="modulename">
bids2table    </h1>

                        <div class="docstring"><p><a href="https://github.com/cmi-dair/bids2table">bids2table</a> is a library for efficiently
indexing and querying large-scale BIDS neuroimaging datasets and derivatives. It aims to
improve upon the efficiency of <a href="https://github.com/bids-standard/pybids">PyBIDS</a> by
leveraging modern data science tools.</p>

<p>bids2table represents a BIDS dataset index as a single table with columns for BIDS
entities and file metadata. The index is constructed using
<a href="https://arrow.apache.org/">Arrow</a> and stored in <a href="https://parquet.apache.org/">Parquet</a>
format, a binary tabular file format optimized for efficient storage and retrieval.</p>

<h2 id="installation">Installation</h2>

<p>A pre-release version of bids2table can be installed with</p>

<div class="pdoc-code codehilite">
<pre><span></span><code>pip<span class="w"> </span>install<span class="w"> </span>bids2table
</code></pre>
</div>

<p>The latest development version can be installed with</p>

<div class="pdoc-code codehilite">
<pre><span></span><code>pip<span class="w"> </span>install<span class="w"> </span>git+https://github.com/cmi-dair/bids2table.git
</code></pre>
</div>

<h2 id="quickstart">Quickstart</h2>

<p>The main entrypoint to the library is the <code><a href="#bids2table">bids2table.bids2table</a></code> function, which builds
the index.</p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="n">tab</span> <span class="o">=</span> <span class="n">bids2table</span><span class="p">(</span><span class="s2">&quot;path/to/dataset&quot;</span><span class="p">)</span>
</code></pre>
</div>

<p>You can also build the index in parallel</p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="n">tab</span> <span class="o">=</span> <span class="n">bids2table</span><span class="p">(</span><span class="s2">&quot;path/to/dataset&quot;</span><span class="p">,</span> <span class="n">workers</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
</code></pre>
</div>

<p>To save the index to disk as a <a href="https://parquet.apache.org/">Parquet</a> dataset for later
reuse, run</p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="n">tab</span> <span class="o">=</span> <span class="n">bids2table</span><span class="p">(</span><span class="s2">&quot;path/to/dataset&quot;</span><span class="p">,</span> <span class="n">persistent</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</code></pre>
</div>

<p>By default this saves the index to an <code>index.b2t</code> directory under the dataset root
directory. To change the output destination, use the <code>index_path</code> argument.</p>

<p>To generate and save an index from the command line, you can use the <code><a href="#bids2table">bids2table</a></code> CLI.</p>

<div class="pdoc-code codehilite">
<pre><span></span><code>usage:<span class="w"> </span>bids2table<span class="w"> </span><span class="o">[</span>-h<span class="o">]</span><span class="w"> </span><span class="o">[</span>--output<span class="w"> </span>OUTPUT<span class="o">]</span><span class="w"> </span><span class="o">[</span>--incremental<span class="o">]</span><span class="w"> </span><span class="o">[</span>--overwrite<span class="o">]</span><span class="w"> </span><span class="o">[</span>--workers<span class="w"> </span>COUNT<span class="o">]</span>
<span class="w">                  </span><span class="o">[</span>--worker_id<span class="w"> </span>RANK<span class="o">]</span><span class="w"> </span><span class="o">[</span>--verbose<span class="o">]</span>
<span class="w">                  </span>ROOT
</code></pre>
</div>

<p>See <code>bids2table --help</code> for more information.</p>

<h2 id="table-representation">Table representation</h2>

<p>The generated index is represented as a <code><a href="#BIDSTable">bids2table.BIDSTable</a></code>, which is just a subclass
of a <code>pandas.DataFrame</code>. Each row in the table corresponds to a BIDS data file, and the
columns are organized into groups:</p>

<ul>
<li>dataset (<code><a href="#BIDSTable.ds">BIDSTable.ds</a></code>): dataset name, relative dataset path, and the JSON dataset
description</li>
<li>entities (<code><a href="#BIDSTable.ent">BIDSTable.ent</a></code>): All <a href="https://bids-specification.readthedocs.io/en/stable/appendices/entities.html">valid BIDS
entities</a>
plus an <code>extra_entities</code> dict containing any extra entities</li>
<li>metadata (<code><a href="#BIDSTable.meta">BIDSTable.meta</a></code>): BIDS JSON metadata</li>
<li>file info (<code><a href="#BIDSTable.finfo">BIDSTable.finfo</a></code>): General file info including the full file path and last
modified time</li>
</ul>

<p>The <code><a href="#BIDSTable">BIDSTable</a></code> also makes it easy to access some of the key characteristics of your
dataset. The BIDS datatypes, modalities, subjects, and entities present in the dataset
are each accessible as properties of the table.</p>

<p>In addition, the associated JSON metadata for each file can be conveniently accessed via
the <code><a href="#BIDSTable.flat_meta">BIDSTable.flat_meta</a></code> property.</p>

<h3 id="filtering">Filtering</h3>

<p>To filter the table for files matching certain criteria, you can use the
<code><a href="#BIDSTable.filter">BIDSTable.filter</a></code> method which selects for rows based on whether a specified column
meets a condition.</p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="n">filtered</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">tab</span>
    <span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="s2">&quot;task&quot;</span><span class="p">,</span> <span class="s2">&quot;rest&quot;</span><span class="p">)</span>
    <span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="s2">&quot;sub&quot;</span><span class="p">,</span> <span class="n">items</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;04&quot;</span><span class="p">,</span> <span class="s2">&quot;06&quot;</span><span class="p">])</span>
    <span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="s2">&quot;RepetitionTime&quot;</span><span class="p">,</span> <span class="mf">2.5</span><span class="p">)</span>
<span class="p">)</span>
</code></pre>
</div>

<p>To apply multiple filters at once, you can also use <code><a href="#BIDSTable.filter_multi">BIDSTable.filter_multi</a></code></p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="n">filtered</span> <span class="o">=</span> <span class="n">tab</span><span class="o">.</span><span class="n">filter_multi</span><span class="p">(</span>
    <span class="n">task</span><span class="o">=</span><span class="s2">&quot;rest&quot;</span>
    <span class="n">sub</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;items&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;04&quot;</span><span class="p">,</span> <span class="s2">&quot;06&quot;</span><span class="p">]},</span>
    <span class="n">RepetitionTime</span><span class="o">=</span><span class="mf">2.5</span><span class="p">,</span>
<span class="p">)</span>
</code></pre>
</div>

<p>This is similar to the
<a href="https://bids-standard.github.io/pybids/generated/bids.layout.BIDSLayout.html#bids.layout.BIDSLayout"><code>BIDSLayout.get()</code></a>
method in <a href="https://bids-standard.github.io/pybids/"><code>PyBIDS</code></a>, where each <code>key=value</code>
pair specifies the column to filter on and the condition to apply.</p>

<h3 id="advanced-usage">Advanced usage</h3>

<p>For more advanced usage that goes beyond what's supported in this higher-level
interface, you can also interact directly with the underlying
<a href="https://pandas.pydata.org/docs/user_guide/index.html"><code>DataFrame</code></a>.</p>

<p>The column labels of the raw table indicate the group as a prefix, e.g. <code>ent__*</code> for
BIDS entities. However, you may find one of the alternative views of the table more
useful:</p>

<ul>
<li><code><a href="#BIDSTable.nested">BIDSTable.nested</a></code>: Columns organized as a nested pandas
<a href="https://pandas.pydata.org/docs/user_guide/advanced.html#hierarchical-indexing-multiindex"><code>MultiIndex</code></a>.</li>
<li><code><a href="#BIDSTable.flat">BIDSTable.flat</a></code>: Flattened columns without any nesting or group prefix.</li>
</ul>

<div class="pdoc-alert pdoc-alert-warning">

<p>You should avoid manipulating the table in place if possible, as this may interfere
with the higher-level accessors. If you must manipulate in place, consider
converting the <code><a href="#BIDSTable">BIDSTable</a></code> to a plain <code>DataFrame</code> first.</p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">tab</span><span class="p">)</span>
</code></pre>
</div>

</div>
</div>

                        <input id="mod-bids2table-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">

                        <label class="view-source-button" for="mod-bids2table-view-source"><span>View Source</span></label>

                        <div class="pdoc-code codehilite"><pre><span></span><span id="L-1"><a href="#L-1"><span class="linenos">  1</span></a><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-2"><a href="#L-2"><span class="linenos">  2</span></a><span class="sd">[bids2table](https://github.com/cmi-dair/bids2table) is a library for efficiently</span>
</span><span id="L-3"><a href="#L-3"><span class="linenos">  3</span></a><span class="sd">indexing and querying large-scale BIDS neuroimaging datasets and derivatives. It aims to</span>
</span><span id="L-4"><a href="#L-4"><span class="linenos">  4</span></a><span class="sd">improve upon the efficiency of [PyBIDS](https://github.com/bids-standard/pybids) by</span>
</span><span id="L-5"><a href="#L-5"><span class="linenos">  5</span></a><span class="sd">leveraging modern data science tools.</span>
</span><span id="L-6"><a href="#L-6"><span class="linenos">  6</span></a>
</span><span id="L-7"><a href="#L-7"><span class="linenos">  7</span></a><span class="sd">bids2table represents a BIDS dataset index as a single table with columns for BIDS</span>
</span><span id="L-8"><a href="#L-8"><span class="linenos">  8</span></a><span class="sd">entities and file metadata. The index is constructed using</span>
</span><span id="L-9"><a href="#L-9"><span class="linenos">  9</span></a><span class="sd">[Arrow](https://arrow.apache.org/) and stored in [Parquet](https://parquet.apache.org/)</span>
</span><span id="L-10"><a href="#L-10"><span class="linenos"> 10</span></a><span class="sd">format, a binary tabular file format optimized for efficient storage and retrieval.</span>
</span><span id="L-11"><a href="#L-11"><span class="linenos"> 11</span></a>
</span><span id="L-12"><a href="#L-12"><span class="linenos"> 12</span></a><span class="sd">## Installation</span>
</span><span id="L-13"><a href="#L-13"><span class="linenos"> 13</span></a>
</span><span id="L-14"><a href="#L-14"><span class="linenos"> 14</span></a><span class="sd">A pre-release version of bids2table can be installed with</span>
</span><span id="L-15"><a href="#L-15"><span class="linenos"> 15</span></a>
</span><span id="L-16"><a href="#L-16"><span class="linenos"> 16</span></a><span class="sd">```sh</span>
</span><span id="L-17"><a href="#L-17"><span class="linenos"> 17</span></a><span class="sd">pip install bids2table</span>
</span><span id="L-18"><a href="#L-18"><span class="linenos"> 18</span></a><span class="sd">```</span>
</span><span id="L-19"><a href="#L-19"><span class="linenos"> 19</span></a>
</span><span id="L-20"><a href="#L-20"><span class="linenos"> 20</span></a><span class="sd">The latest development version can be installed with</span>
</span><span id="L-21"><a href="#L-21"><span class="linenos"> 21</span></a>
</span><span id="L-22"><a href="#L-22"><span class="linenos"> 22</span></a><span class="sd">```sh</span>
</span><span id="L-23"><a href="#L-23"><span class="linenos"> 23</span></a><span class="sd">pip install git+https://github.com/cmi-dair/bids2table.git</span>
</span><span id="L-24"><a href="#L-24"><span class="linenos"> 24</span></a><span class="sd">```</span>
</span><span id="L-25"><a href="#L-25"><span class="linenos"> 25</span></a>
</span><span id="L-26"><a href="#L-26"><span class="linenos"> 26</span></a><span class="sd">## Quickstart</span>
</span><span id="L-27"><a href="#L-27"><span class="linenos"> 27</span></a>
</span><span id="L-28"><a href="#L-28"><span class="linenos"> 28</span></a><span class="sd">The main entrypoint to the library is the `bids2table.bids2table` function, which builds</span>
</span><span id="L-29"><a href="#L-29"><span class="linenos"> 29</span></a><span class="sd">the index.</span>
</span><span id="L-30"><a href="#L-30"><span class="linenos"> 30</span></a>
</span><span id="L-31"><a href="#L-31"><span class="linenos"> 31</span></a><span class="sd">```python</span>
</span><span id="L-32"><a href="#L-32"><span class="linenos"> 32</span></a><span class="sd">tab = bids2table(&quot;path/to/dataset&quot;)</span>
</span><span id="L-33"><a href="#L-33"><span class="linenos"> 33</span></a><span class="sd">```</span>
</span><span id="L-34"><a href="#L-34"><span class="linenos"> 34</span></a>
</span><span id="L-35"><a href="#L-35"><span class="linenos"> 35</span></a><span class="sd">You can also build the index in parallel</span>
</span><span id="L-36"><a href="#L-36"><span class="linenos"> 36</span></a>
</span><span id="L-37"><a href="#L-37"><span class="linenos"> 37</span></a><span class="sd">```python</span>
</span><span id="L-38"><a href="#L-38"><span class="linenos"> 38</span></a><span class="sd">tab = bids2table(&quot;path/to/dataset&quot;, workers=8)</span>
</span><span id="L-39"><a href="#L-39"><span class="linenos"> 39</span></a><span class="sd">```</span>
</span><span id="L-40"><a href="#L-40"><span class="linenos"> 40</span></a>
</span><span id="L-41"><a href="#L-41"><span class="linenos"> 41</span></a><span class="sd">To save the index to disk as a [Parquet](https://parquet.apache.org/) dataset for later</span>
</span><span id="L-42"><a href="#L-42"><span class="linenos"> 42</span></a><span class="sd">reuse, run</span>
</span><span id="L-43"><a href="#L-43"><span class="linenos"> 43</span></a>
</span><span id="L-44"><a href="#L-44"><span class="linenos"> 44</span></a><span class="sd">```python</span>
</span><span id="L-45"><a href="#L-45"><span class="linenos"> 45</span></a><span class="sd">tab = bids2table(&quot;path/to/dataset&quot;, persistent=True)</span>
</span><span id="L-46"><a href="#L-46"><span class="linenos"> 46</span></a><span class="sd">```</span>
</span><span id="L-47"><a href="#L-47"><span class="linenos"> 47</span></a>
</span><span id="L-48"><a href="#L-48"><span class="linenos"> 48</span></a><span class="sd">By default this saves the index to an `index.b2t` directory under the dataset root</span>
</span><span id="L-49"><a href="#L-49"><span class="linenos"> 49</span></a><span class="sd">directory. To change the output destination, use the `index_path` argument.</span>
</span><span id="L-50"><a href="#L-50"><span class="linenos"> 50</span></a>
</span><span id="L-51"><a href="#L-51"><span class="linenos"> 51</span></a><span class="sd">To generate and save an index from the command line, you can use the `bids2table` CLI.</span>
</span><span id="L-52"><a href="#L-52"><span class="linenos"> 52</span></a>
</span><span id="L-53"><a href="#L-53"><span class="linenos"> 53</span></a><span class="sd">```sh</span>
</span><span id="L-54"><a href="#L-54"><span class="linenos"> 54</span></a><span class="sd">usage: bids2table [-h] [--output OUTPUT] [--incremental] [--overwrite] [--workers COUNT]</span>
</span><span id="L-55"><a href="#L-55"><span class="linenos"> 55</span></a><span class="sd">                  [--worker_id RANK] [--verbose]</span>
</span><span id="L-56"><a href="#L-56"><span class="linenos"> 56</span></a><span class="sd">                  ROOT</span>
</span><span id="L-57"><a href="#L-57"><span class="linenos"> 57</span></a><span class="sd">```</span>
</span><span id="L-58"><a href="#L-58"><span class="linenos"> 58</span></a>
</span><span id="L-59"><a href="#L-59"><span class="linenos"> 59</span></a><span class="sd">See `bids2table --help` for more information.</span>
</span><span id="L-60"><a href="#L-60"><span class="linenos"> 60</span></a>
</span><span id="L-61"><a href="#L-61"><span class="linenos"> 61</span></a><span class="sd">## Table representation</span>
</span><span id="L-62"><a href="#L-62"><span class="linenos"> 62</span></a>
</span><span id="L-63"><a href="#L-63"><span class="linenos"> 63</span></a><span class="sd">The generated index is represented as a `bids2table.BIDSTable`, which is just a subclass</span>
</span><span id="L-64"><a href="#L-64"><span class="linenos"> 64</span></a><span class="sd">of a `pandas.DataFrame`. Each row in the table corresponds to a BIDS data file, and the</span>
</span><span id="L-65"><a href="#L-65"><span class="linenos"> 65</span></a><span class="sd">columns are organized into groups:</span>
</span><span id="L-66"><a href="#L-66"><span class="linenos"> 66</span></a>
</span><span id="L-67"><a href="#L-67"><span class="linenos"> 67</span></a><span class="sd">- dataset (`BIDSTable.ds`): dataset name, relative dataset path, and the JSON dataset</span>
</span><span id="L-68"><a href="#L-68"><span class="linenos"> 68</span></a><span class="sd">description</span>
</span><span id="L-69"><a href="#L-69"><span class="linenos"> 69</span></a><span class="sd">- entities (`BIDSTable.ent`): All [valid BIDS</span>
</span><span id="L-70"><a href="#L-70"><span class="linenos"> 70</span></a><span class="sd">entities](https://bids-specification.readthedocs.io/en/stable/appendices/entities.html)</span>
</span><span id="L-71"><a href="#L-71"><span class="linenos"> 71</span></a><span class="sd">plus an `extra_entities` dict containing any extra entities</span>
</span><span id="L-72"><a href="#L-72"><span class="linenos"> 72</span></a><span class="sd">- metadata (`BIDSTable.meta`): BIDS JSON metadata</span>
</span><span id="L-73"><a href="#L-73"><span class="linenos"> 73</span></a><span class="sd">- file info (`BIDSTable.finfo`): General file info including the full file path and last</span>
</span><span id="L-74"><a href="#L-74"><span class="linenos"> 74</span></a><span class="sd">modified time</span>
</span><span id="L-75"><a href="#L-75"><span class="linenos"> 75</span></a>
</span><span id="L-76"><a href="#L-76"><span class="linenos"> 76</span></a><span class="sd">The `BIDSTable` also makes it easy to access some of the key characteristics of your</span>
</span><span id="L-77"><a href="#L-77"><span class="linenos"> 77</span></a><span class="sd">dataset. The BIDS datatypes, modalities, subjects, and entities present in the dataset</span>
</span><span id="L-78"><a href="#L-78"><span class="linenos"> 78</span></a><span class="sd">are each accessible as properties of the table.</span>
</span><span id="L-79"><a href="#L-79"><span class="linenos"> 79</span></a>
</span><span id="L-80"><a href="#L-80"><span class="linenos"> 80</span></a><span class="sd">In addition, the associated JSON metadata for each file can be conveniently accessed via</span>
</span><span id="L-81"><a href="#L-81"><span class="linenos"> 81</span></a><span class="sd">the `BIDSTable.flat_meta` property.</span>
</span><span id="L-82"><a href="#L-82"><span class="linenos"> 82</span></a>
</span><span id="L-83"><a href="#L-83"><span class="linenos"> 83</span></a><span class="sd">### Filtering</span>
</span><span id="L-84"><a href="#L-84"><span class="linenos"> 84</span></a>
</span><span id="L-85"><a href="#L-85"><span class="linenos"> 85</span></a><span class="sd">To filter the table for files matching certain criteria, you can use the</span>
</span><span id="L-86"><a href="#L-86"><span class="linenos"> 86</span></a><span class="sd">`BIDSTable.filter` method which selects for rows based on whether a specified column</span>
</span><span id="L-87"><a href="#L-87"><span class="linenos"> 87</span></a><span class="sd">meets a condition.</span>
</span><span id="L-88"><a href="#L-88"><span class="linenos"> 88</span></a>
</span><span id="L-89"><a href="#L-89"><span class="linenos"> 89</span></a><span class="sd">```python</span>
</span><span id="L-90"><a href="#L-90"><span class="linenos"> 90</span></a><span class="sd">filtered = (</span>
</span><span id="L-91"><a href="#L-91"><span class="linenos"> 91</span></a><span class="sd">    tab</span>
</span><span id="L-92"><a href="#L-92"><span class="linenos"> 92</span></a><span class="sd">    .filter(&quot;task&quot;, &quot;rest&quot;)</span>
</span><span id="L-93"><a href="#L-93"><span class="linenos"> 93</span></a><span class="sd">    .filter(&quot;sub&quot;, items=[&quot;04&quot;, &quot;06&quot;])</span>
</span><span id="L-94"><a href="#L-94"><span class="linenos"> 94</span></a><span class="sd">    .filter(&quot;RepetitionTime&quot;, 2.5)</span>
</span><span id="L-95"><a href="#L-95"><span class="linenos"> 95</span></a><span class="sd">)</span>
</span><span id="L-96"><a href="#L-96"><span class="linenos"> 96</span></a><span class="sd">```</span>
</span><span id="L-97"><a href="#L-97"><span class="linenos"> 97</span></a>
</span><span id="L-98"><a href="#L-98"><span class="linenos"> 98</span></a><span class="sd">To apply multiple filters at once, you can also use `BIDSTable.filter_multi`</span>
</span><span id="L-99"><a href="#L-99"><span class="linenos"> 99</span></a>
</span><span id="L-100"><a href="#L-100"><span class="linenos">100</span></a><span class="sd">```python</span>
</span><span id="L-101"><a href="#L-101"><span class="linenos">101</span></a>
</span><span id="L-102"><a href="#L-102"><span class="linenos">102</span></a><span class="sd">filtered = tab.filter_multi(</span>
</span><span id="L-103"><a href="#L-103"><span class="linenos">103</span></a><span class="sd">    task=&quot;rest&quot;</span>
</span><span id="L-104"><a href="#L-104"><span class="linenos">104</span></a><span class="sd">    sub={&quot;items&quot;: [&quot;04&quot;, &quot;06&quot;]},</span>
</span><span id="L-105"><a href="#L-105"><span class="linenos">105</span></a><span class="sd">    RepetitionTime=2.5,</span>
</span><span id="L-106"><a href="#L-106"><span class="linenos">106</span></a><span class="sd">)</span>
</span><span id="L-107"><a href="#L-107"><span class="linenos">107</span></a><span class="sd">```</span>
</span><span id="L-108"><a href="#L-108"><span class="linenos">108</span></a>
</span><span id="L-109"><a href="#L-109"><span class="linenos">109</span></a><span class="sd">This is similar to the</span>
</span><span id="L-110"><a href="#L-110"><span class="linenos">110</span></a><span class="sd">[`BIDSLayout.get()`](https://bids-standard.github.io/pybids/generated/bids.layout.BIDSLayout.html#bids.layout.BIDSLayout)</span>
</span><span id="L-111"><a href="#L-111"><span class="linenos">111</span></a><span class="sd">method in [`PyBIDS`](https://bids-standard.github.io/pybids/), where each `key=value`</span>
</span><span id="L-112"><a href="#L-112"><span class="linenos">112</span></a><span class="sd">pair specifies the column to filter on and the condition to apply.</span>
</span><span id="L-113"><a href="#L-113"><span class="linenos">113</span></a>
</span><span id="L-114"><a href="#L-114"><span class="linenos">114</span></a><span class="sd">### Advanced usage</span>
</span><span id="L-115"><a href="#L-115"><span class="linenos">115</span></a>
</span><span id="L-116"><a href="#L-116"><span class="linenos">116</span></a><span class="sd">For more advanced usage that goes beyond what&#39;s supported in this higher-level</span>
</span><span id="L-117"><a href="#L-117"><span class="linenos">117</span></a><span class="sd">interface, you can also interact directly with the underlying</span>
</span><span id="L-118"><a href="#L-118"><span class="linenos">118</span></a><span class="sd">[`DataFrame`](https://pandas.pydata.org/docs/user_guide/index.html).</span>
</span><span id="L-119"><a href="#L-119"><span class="linenos">119</span></a>
</span><span id="L-120"><a href="#L-120"><span class="linenos">120</span></a><span class="sd">The column labels of the raw table indicate the group as a prefix, e.g. `ent__*` for</span>
</span><span id="L-121"><a href="#L-121"><span class="linenos">121</span></a><span class="sd">BIDS entities. However, you may find one of the alternative views of the table more</span>
</span><span id="L-122"><a href="#L-122"><span class="linenos">122</span></a><span class="sd">useful:</span>
</span><span id="L-123"><a href="#L-123"><span class="linenos">123</span></a>
</span><span id="L-124"><a href="#L-124"><span class="linenos">124</span></a><span class="sd">- `BIDSTable.nested`: Columns organized as a nested pandas</span>
</span><span id="L-125"><a href="#L-125"><span class="linenos">125</span></a><span class="sd">[`MultiIndex`](https://pandas.pydata.org/docs/user_guide/advanced.html#hierarchical-indexing-multiindex).</span>
</span><span id="L-126"><a href="#L-126"><span class="linenos">126</span></a><span class="sd">- `BIDSTable.flat`: Flattened columns without any nesting or group prefix.</span>
</span><span id="L-127"><a href="#L-127"><span class="linenos">127</span></a>
</span><span id="L-128"><a href="#L-128"><span class="linenos">128</span></a><span class="sd">.. warning::</span>
</span><span id="L-129"><a href="#L-129"><span class="linenos">129</span></a><span class="sd">    You should avoid manipulating the table in place if possible, as this may interfere</span>
</span><span id="L-130"><a href="#L-130"><span class="linenos">130</span></a><span class="sd">    with the higher-level accessors. If you must manipulate in place, consider</span>
</span><span id="L-131"><a href="#L-131"><span class="linenos">131</span></a><span class="sd">    converting the `BIDSTable` to a plain `DataFrame` first.</span>
</span><span id="L-132"><a href="#L-132"><span class="linenos">132</span></a>
</span><span id="L-133"><a href="#L-133"><span class="linenos">133</span></a><span class="sd">    ```python</span>
</span><span id="L-134"><a href="#L-134"><span class="linenos">134</span></a><span class="sd">    df = pd.DataFrame(tab)</span>
</span><span id="L-135"><a href="#L-135"><span class="linenos">135</span></a><span class="sd">    ```</span>
</span><span id="L-136"><a href="#L-136"><span class="linenos">136</span></a><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-137"><a href="#L-137"><span class="linenos">137</span></a>
</span><span id="L-138"><a href="#L-138"><span class="linenos">138</span></a><span class="c1"># Register elbow extension types</span>
</span><span id="L-139"><a href="#L-139"><span class="linenos">139</span></a><span class="kn">import</span> <span class="nn">elbow.dtypes</span>  <span class="c1"># noqa</span>
</span><span id="L-140"><a href="#L-140"><span class="linenos">140</span></a>
</span><span id="L-141"><a href="#L-141"><span class="linenos">141</span></a><span class="kn">from</span> <span class="nn">._b2t</span> <span class="kn">import</span> <span class="n">bids2table</span>
</span><span id="L-142"><a href="#L-142"><span class="linenos">142</span></a><span class="kn">from</span> <span class="nn">._version</span> <span class="kn">import</span> <span class="n">__version__</span><span class="p">,</span> <span class="n">__version_tuple__</span>  <span class="c1"># noqa</span>
</span><span id="L-143"><a href="#L-143"><span class="linenos">143</span></a><span class="kn">from</span> <span class="nn">.entities</span> <span class="kn">import</span> <span class="n">BIDSEntities</span><span class="p">,</span> <span class="n">parse_bids_entities</span>
</span><span id="L-144"><a href="#L-144"><span class="linenos">144</span></a><span class="kn">from</span> <span class="nn">.table</span> <span class="kn">import</span> <span class="n">BIDSFile</span><span class="p">,</span> <span class="n">BIDSTable</span><span class="p">,</span> <span class="n">join_bids_path</span>
</span><span id="L-145"><a href="#L-145"><span class="linenos">145</span></a>
</span><span id="L-146"><a href="#L-146"><span class="linenos">146</span></a><span class="n">__all__</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="L-147"><a href="#L-147"><span class="linenos">147</span></a>    <span class="s2">&quot;bids2table&quot;</span><span class="p">,</span>
</span><span id="L-148"><a href="#L-148"><span class="linenos">148</span></a>    <span class="s2">&quot;BIDSTable&quot;</span><span class="p">,</span>
</span><span id="L-149"><a href="#L-149"><span class="linenos">149</span></a>    <span class="s2">&quot;BIDSFile&quot;</span><span class="p">,</span>
</span><span id="L-150"><a href="#L-150"><span class="linenos">150</span></a>    <span class="s2">&quot;BIDSEntities&quot;</span><span class="p">,</span>
</span><span id="L-151"><a href="#L-151"><span class="linenos">151</span></a>    <span class="s2">&quot;parse_bids_entities&quot;</span><span class="p">,</span>
</span><span id="L-152"><a href="#L-152"><span class="linenos">152</span></a>    <span class="s2">&quot;join_bids_path&quot;</span><span class="p">,</span>
</span><span id="L-153"><a href="#L-153"><span class="linenos">153</span></a><span class="p">]</span>
</span></pre></div>


            </section>
                <section id="bids2table">
                            <input id="bids2table-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">bids2table</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">root</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">]</span>,</span><span class="param">	<span class="o">*</span>,</span><span class="param">	<span class="n">persistent</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>,</span><span class="param">	<span class="n">index_path</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">,</span> <span class="n">NoneType</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">incremental</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>,</span><span class="param">	<span class="n">overwrite</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>,</span><span class="param">	<span class="n">workers</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">worker_id</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">return_table</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span></span><span class="return-annotation">) -> <span class="n">Optional</span><span class="p">[</span><span class="n"><a href="#BIDSTable">bids2table.BIDSTable</a></span><span class="p">]</span>:</span></span>

                <label class="view-source-button" for="bids2table-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#bids2table"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="bids2table-17"><a href="#bids2table-17"><span class="linenos"> 17</span></a><span class="k">def</span> <span class="nf">bids2table</span><span class="p">(</span>
</span><span id="bids2table-18"><a href="#bids2table-18"><span class="linenos"> 18</span></a>    <span class="n">root</span><span class="p">:</span> <span class="n">StrOrPath</span><span class="p">,</span>
</span><span id="bids2table-19"><a href="#bids2table-19"><span class="linenos"> 19</span></a>    <span class="o">*</span><span class="p">,</span>
</span><span id="bids2table-20"><a href="#bids2table-20"><span class="linenos"> 20</span></a>    <span class="n">persistent</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="bids2table-21"><a href="#bids2table-21"><span class="linenos"> 21</span></a>    <span class="n">index_path</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">StrOrPath</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="bids2table-22"><a href="#bids2table-22"><span class="linenos"> 22</span></a>    <span class="n">incremental</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="bids2table-23"><a href="#bids2table-23"><span class="linenos"> 23</span></a>    <span class="n">overwrite</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="bids2table-24"><a href="#bids2table-24"><span class="linenos"> 24</span></a>    <span class="n">workers</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="bids2table-25"><a href="#bids2table-25"><span class="linenos"> 25</span></a>    <span class="n">worker_id</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="bids2table-26"><a href="#bids2table-26"><span class="linenos"> 26</span></a>    <span class="n">return_table</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
</span><span id="bids2table-27"><a href="#bids2table-27"><span class="linenos"> 27</span></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">BIDSTable</span><span class="p">]:</span>
</span><span id="bids2table-28"><a href="#bids2table-28"><span class="linenos"> 28</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="bids2table-29"><a href="#bids2table-29"><span class="linenos"> 29</span></a><span class="sd">    Index a BIDS dataset directory and load as a pandas DataFrame.</span>
</span><span id="bids2table-30"><a href="#bids2table-30"><span class="linenos"> 30</span></a>
</span><span id="bids2table-31"><a href="#bids2table-31"><span class="linenos"> 31</span></a><span class="sd">    Args:</span>
</span><span id="bids2table-32"><a href="#bids2table-32"><span class="linenos"> 32</span></a><span class="sd">        root: path to BIDS dataset</span>
</span><span id="bids2table-33"><a href="#bids2table-33"><span class="linenos"> 33</span></a><span class="sd">        persistent: whether to save index to disk as a Parquet dataset</span>
</span><span id="bids2table-34"><a href="#bids2table-34"><span class="linenos"> 34</span></a><span class="sd">        index_path: path to BIDS Parquet index to generate or load. Defaults to `root /</span>
</span><span id="bids2table-35"><a href="#bids2table-35"><span class="linenos"> 35</span></a><span class="sd">            &quot;index.b2t&quot;`. Index generation requires `persistent=True`.</span>
</span><span id="bids2table-36"><a href="#bids2table-36"><span class="linenos"> 36</span></a><span class="sd">        incremental: update index incrementally with only new or changed files.</span>
</span><span id="bids2table-37"><a href="#bids2table-37"><span class="linenos"> 37</span></a><span class="sd">        overwrite: overwrite previous index.</span>
</span><span id="bids2table-38"><a href="#bids2table-38"><span class="linenos"> 38</span></a><span class="sd">        workers: number of parallel processes. If `None` or 1, run in the main</span>
</span><span id="bids2table-39"><a href="#bids2table-39"><span class="linenos"> 39</span></a><span class="sd">            process. Setting to &lt;= 0 runs as many processes as there are cores</span>
</span><span id="bids2table-40"><a href="#bids2table-40"><span class="linenos"> 40</span></a><span class="sd">            available.</span>
</span><span id="bids2table-41"><a href="#bids2table-41"><span class="linenos"> 41</span></a><span class="sd">        worker_id: optional worker ID to use when scheduling parallel tasks externally.</span>
</span><span id="bids2table-42"><a href="#bids2table-42"><span class="linenos"> 42</span></a><span class="sd">            Specifying the number of workers is required in this case. Incompatible with</span>
</span><span id="bids2table-43"><a href="#bids2table-43"><span class="linenos"> 43</span></a><span class="sd">            overwrite.</span>
</span><span id="bids2table-44"><a href="#bids2table-44"><span class="linenos"> 44</span></a><span class="sd">        return_table: whether to return the BIDS table or just build the persistent</span>
</span><span id="bids2table-45"><a href="#bids2table-45"><span class="linenos"> 45</span></a><span class="sd">            index.</span>
</span><span id="bids2table-46"><a href="#bids2table-46"><span class="linenos"> 46</span></a>
</span><span id="bids2table-47"><a href="#bids2table-47"><span class="linenos"> 47</span></a><span class="sd">    Returns:</span>
</span><span id="bids2table-48"><a href="#bids2table-48"><span class="linenos"> 48</span></a><span class="sd">        A `BIDSTable` representing the indexed dataset(s), or `None` if `return_table`</span>
</span><span id="bids2table-49"><a href="#bids2table-49"><span class="linenos"> 49</span></a><span class="sd">        is `False`.</span>
</span><span id="bids2table-50"><a href="#bids2table-50"><span class="linenos"> 50</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="bids2table-51"><a href="#bids2table-51"><span class="linenos"> 51</span></a>    <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">return_table</span> <span class="ow">or</span> <span class="n">persistent</span><span class="p">):</span>
</span><span id="bids2table-52"><a href="#bids2table-52"><span class="linenos"> 52</span></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;persistent and return_table should not both be False&quot;</span><span class="p">)</span>
</span><span id="bids2table-53"><a href="#bids2table-53"><span class="linenos"> 53</span></a>
</span><span id="bids2table-54"><a href="#bids2table-54"><span class="linenos"> 54</span></a>    <span class="n">root</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">root</span><span class="p">)</span><span class="o">.</span><span class="n">expanduser</span><span class="p">()</span><span class="o">.</span><span class="n">resolve</span><span class="p">()</span>
</span><span id="bids2table-55"><a href="#bids2table-55"><span class="linenos"> 55</span></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">root</span><span class="o">.</span><span class="n">is_dir</span><span class="p">():</span>
</span><span id="bids2table-56"><a href="#bids2table-56"><span class="linenos"> 56</span></a>        <span class="k">raise</span> <span class="ne">FileNotFoundError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;root directory </span><span class="si">{</span><span class="n">root</span><span class="si">}</span><span class="s2"> does not exists&quot;</span><span class="p">)</span>
</span><span id="bids2table-57"><a href="#bids2table-57"><span class="linenos"> 57</span></a>
</span><span id="bids2table-58"><a href="#bids2table-58"><span class="linenos"> 58</span></a>    <span class="n">source</span> <span class="o">=</span> <span class="n">Crawler</span><span class="p">(</span>
</span><span id="bids2table-59"><a href="#bids2table-59"><span class="linenos"> 59</span></a>        <span class="n">root</span><span class="o">=</span><span class="n">root</span><span class="p">,</span>
</span><span id="bids2table-60"><a href="#bids2table-60"><span class="linenos"> 60</span></a>        <span class="n">include</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;sub-*&quot;</span><span class="p">],</span>  <span class="c1"># find subject dirs</span>
</span><span id="bids2table-61"><a href="#bids2table-61"><span class="linenos"> 61</span></a>        <span class="n">skip</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;sub-*&quot;</span><span class="p">],</span>  <span class="c1"># but don&#39;t crawl into subject dirs</span>
</span><span id="bids2table-62"><a href="#bids2table-62"><span class="linenos"> 62</span></a>        <span class="n">dirs_only</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="bids2table-63"><a href="#bids2table-63"><span class="linenos"> 63</span></a>        <span class="n">follow_links</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="bids2table-64"><a href="#bids2table-64"><span class="linenos"> 64</span></a>    <span class="p">)</span>
</span><span id="bids2table-65"><a href="#bids2table-65"><span class="linenos"> 65</span></a>
</span><span id="bids2table-66"><a href="#bids2table-66"><span class="linenos"> 66</span></a>    <span class="k">if</span> <span class="n">index_path</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="bids2table-67"><a href="#bids2table-67"><span class="linenos"> 67</span></a>        <span class="n">index_path</span> <span class="o">=</span> <span class="n">root</span> <span class="o">/</span> <span class="s2">&quot;index.b2t&quot;</span>
</span><span id="bids2table-68"><a href="#bids2table-68"><span class="linenos"> 68</span></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="bids2table-69"><a href="#bids2table-69"><span class="linenos"> 69</span></a>        <span class="n">index_path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">index_path</span><span class="p">)</span><span class="o">.</span><span class="n">resolve</span><span class="p">()</span>
</span><span id="bids2table-70"><a href="#bids2table-70"><span class="linenos"> 70</span></a>
</span><span id="bids2table-71"><a href="#bids2table-71"><span class="linenos"> 71</span></a>    <span class="n">stale</span> <span class="o">=</span> <span class="n">overwrite</span> <span class="ow">or</span> <span class="n">incremental</span> <span class="ow">or</span> <span class="n">worker_id</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
</span><span id="bids2table-72"><a href="#bids2table-72"><span class="linenos"> 72</span></a>    <span class="k">if</span> <span class="n">index_path</span><span class="o">.</span><span class="n">exists</span><span class="p">()</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">stale</span><span class="p">:</span>
</span><span id="bids2table-73"><a href="#bids2table-73"><span class="linenos"> 73</span></a>        <span class="k">if</span> <span class="n">return_table</span><span class="p">:</span>
</span><span id="bids2table-74"><a href="#bids2table-74"><span class="linenos"> 74</span></a>            <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Loading cached index </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">index_path</span><span class="p">)</span>
</span><span id="bids2table-75"><a href="#bids2table-75"><span class="linenos"> 75</span></a>            <span class="n">tab</span> <span class="o">=</span> <span class="n">BIDSTable</span><span class="o">.</span><span class="n">from_parquet</span><span class="p">(</span><span class="n">index_path</span><span class="p">)</span>
</span><span id="bids2table-76"><a href="#bids2table-76"><span class="linenos"> 76</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="bids2table-77"><a href="#bids2table-77"><span class="linenos"> 77</span></a>            <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Found cached index </span><span class="si">%s</span><span class="s2">; nothing to do&quot;</span><span class="p">,</span> <span class="n">index_path</span><span class="p">)</span>
</span><span id="bids2table-78"><a href="#bids2table-78"><span class="linenos"> 78</span></a>            <span class="n">tab</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="bids2table-79"><a href="#bids2table-79"><span class="linenos"> 79</span></a>        <span class="k">return</span> <span class="n">tab</span>
</span><span id="bids2table-80"><a href="#bids2table-80"><span class="linenos"> 80</span></a>
</span><span id="bids2table-81"><a href="#bids2table-81"><span class="linenos"> 81</span></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">persistent</span><span class="p">:</span>
</span><span id="bids2table-82"><a href="#bids2table-82"><span class="linenos"> 82</span></a>        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Building index in memory&quot;</span><span class="p">)</span>
</span><span id="bids2table-83"><a href="#bids2table-83"><span class="linenos"> 83</span></a>        <span class="n">df</span> <span class="o">=</span> <span class="n">build_table</span><span class="p">(</span>
</span><span id="bids2table-84"><a href="#bids2table-84"><span class="linenos"> 84</span></a>            <span class="n">source</span><span class="o">=</span><span class="n">source</span><span class="p">,</span>
</span><span id="bids2table-85"><a href="#bids2table-85"><span class="linenos"> 85</span></a>            <span class="n">extract</span><span class="o">=</span><span class="n">extract_bids_subdir</span><span class="p">,</span>
</span><span id="bids2table-86"><a href="#bids2table-86"><span class="linenos"> 86</span></a>            <span class="n">workers</span><span class="o">=</span><span class="n">workers</span><span class="p">,</span>
</span><span id="bids2table-87"><a href="#bids2table-87"><span class="linenos"> 87</span></a>            <span class="n">worker_id</span><span class="o">=</span><span class="n">worker_id</span><span class="p">,</span>
</span><span id="bids2table-88"><a href="#bids2table-88"><span class="linenos"> 88</span></a>        <span class="p">)</span>
</span><span id="bids2table-89"><a href="#bids2table-89"><span class="linenos"> 89</span></a>        <span class="n">tab</span> <span class="o">=</span> <span class="n">BIDSTable</span><span class="o">.</span><span class="n">from_df</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
</span><span id="bids2table-90"><a href="#bids2table-90"><span class="linenos"> 90</span></a>        <span class="k">return</span> <span class="n">tab</span>
</span><span id="bids2table-91"><a href="#bids2table-91"><span class="linenos"> 91</span></a>
</span><span id="bids2table-92"><a href="#bids2table-92"><span class="linenos"> 92</span></a>    <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Building persistent Parquet index&quot;</span><span class="p">)</span>
</span><span id="bids2table-93"><a href="#bids2table-93"><span class="linenos"> 93</span></a>    <span class="n">build_parquet</span><span class="p">(</span>
</span><span id="bids2table-94"><a href="#bids2table-94"><span class="linenos"> 94</span></a>        <span class="n">source</span><span class="o">=</span><span class="n">source</span><span class="p">,</span>
</span><span id="bids2table-95"><a href="#bids2table-95"><span class="linenos"> 95</span></a>        <span class="n">extract</span><span class="o">=</span><span class="n">extract_bids_subdir</span><span class="p">,</span>
</span><span id="bids2table-96"><a href="#bids2table-96"><span class="linenos"> 96</span></a>        <span class="n">output</span><span class="o">=</span><span class="n">index_path</span><span class="p">,</span>
</span><span id="bids2table-97"><a href="#bids2table-97"><span class="linenos"> 97</span></a>        <span class="n">incremental</span><span class="o">=</span><span class="n">incremental</span><span class="p">,</span>
</span><span id="bids2table-98"><a href="#bids2table-98"><span class="linenos"> 98</span></a>        <span class="n">overwrite</span><span class="o">=</span><span class="n">overwrite</span><span class="p">,</span>
</span><span id="bids2table-99"><a href="#bids2table-99"><span class="linenos"> 99</span></a>        <span class="n">workers</span><span class="o">=</span><span class="n">workers</span><span class="p">,</span>
</span><span id="bids2table-100"><a href="#bids2table-100"><span class="linenos">100</span></a>        <span class="n">worker_id</span><span class="o">=</span><span class="n">worker_id</span><span class="p">,</span>
</span><span id="bids2table-101"><a href="#bids2table-101"><span class="linenos">101</span></a>        <span class="n">path_column</span><span class="o">=</span><span class="s2">&quot;file__file_path&quot;</span><span class="p">,</span>
</span><span id="bids2table-102"><a href="#bids2table-102"><span class="linenos">102</span></a>        <span class="n">mtime_column</span><span class="o">=</span><span class="s2">&quot;file__mod_time&quot;</span><span class="p">,</span>
</span><span id="bids2table-103"><a href="#bids2table-103"><span class="linenos">103</span></a>    <span class="p">)</span>
</span><span id="bids2table-104"><a href="#bids2table-104"><span class="linenos">104</span></a>    <span class="n">tab</span> <span class="o">=</span> <span class="n">BIDSTable</span><span class="o">.</span><span class="n">from_parquet</span><span class="p">(</span><span class="n">index_path</span><span class="p">)</span> <span class="k">if</span> <span class="n">return_table</span> <span class="k">else</span> <span class="kc">None</span>
</span><span id="bids2table-105"><a href="#bids2table-105"><span class="linenos">105</span></a>    <span class="k">return</span> <span class="n">tab</span>
</span></pre></div>


            <div class="docstring"><p>Index a BIDS dataset directory and load as a pandas DataFrame.</p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>root:</strong>  path to BIDS dataset</li>
<li><strong>persistent:</strong>  whether to save index to disk as a Parquet dataset</li>
<li><strong>index_path:</strong>  path to BIDS Parquet index to generate or load. Defaults to <code>root /
"index.b2t"</code>. Index generation requires <code>persistent=True</code>.</li>
<li><strong>incremental:</strong>  update index incrementally with only new or changed files.</li>
<li><strong>overwrite:</strong>  overwrite previous index.</li>
<li><strong>workers:</strong>  number of parallel processes. If <code>None</code> or 1, run in the main
process. Setting to &lt;= 0 runs as many processes as there are cores
available.</li>
<li><strong>worker_id:</strong>  optional worker ID to use when scheduling parallel tasks externally.
Specifying the number of workers is required in this case. Incompatible with
overwrite.</li>
<li><strong>return_table:</strong>  whether to return the BIDS table or just build the persistent
index.</li>
</ul>

<h6 id="returns">Returns:</h6>

<blockquote>
  <p>A <code><a href="#BIDSTable">BIDSTable</a></code> representing the indexed dataset(s), or <code>None</code> if <code>return_table</code>
  is <code>False</code>.</p>
</blockquote>
</div>


                </section>
                <section id="BIDSTable">
                            <input id="BIDSTable-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">BIDSTable</span><wbr>(<span class="base">pandas.core.frame.DataFrame</span>):

                <label class="view-source-button" for="BIDSTable-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#BIDSTable"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="BIDSTable-12"><a href="#BIDSTable-12"><span class="linenos"> 12</span></a><span class="k">class</span> <span class="nc">BIDSTable</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">):</span>
</span><span id="BIDSTable-13"><a href="#BIDSTable-13"><span class="linenos"> 13</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="BIDSTable-14"><a href="#BIDSTable-14"><span class="linenos"> 14</span></a><span class="sd">    A table representing one or more BIDS datasets.</span>
</span><span id="BIDSTable-15"><a href="#BIDSTable-15"><span class="linenos"> 15</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="BIDSTable-16"><a href="#BIDSTable-16"><span class="linenos"> 16</span></a>
</span><span id="BIDSTable-17"><a href="#BIDSTable-17"><span class="linenos"> 17</span></a>    <span class="nd">@cached_property</span>
</span><span id="BIDSTable-18"><a href="#BIDSTable-18"><span class="linenos"> 18</span></a>    <span class="k">def</span> <span class="nf">ds</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
</span><span id="BIDSTable-19"><a href="#BIDSTable-19"><span class="linenos"> 19</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="BIDSTable-20"><a href="#BIDSTable-20"><span class="linenos"> 20</span></a><span class="sd">        The dataset (`ds`) subtable.</span>
</span><span id="BIDSTable-21"><a href="#BIDSTable-21"><span class="linenos"> 21</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="BIDSTable-22"><a href="#BIDSTable-22"><span class="linenos"> 22</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">nested</span><span class="p">[</span><span class="s2">&quot;ds&quot;</span><span class="p">]</span>
</span><span id="BIDSTable-23"><a href="#BIDSTable-23"><span class="linenos"> 23</span></a>
</span><span id="BIDSTable-24"><a href="#BIDSTable-24"><span class="linenos"> 24</span></a>    <span class="nd">@cached_property</span>
</span><span id="BIDSTable-25"><a href="#BIDSTable-25"><span class="linenos"> 25</span></a>    <span class="k">def</span> <span class="nf">ent</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
</span><span id="BIDSTable-26"><a href="#BIDSTable-26"><span class="linenos"> 26</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="BIDSTable-27"><a href="#BIDSTable-27"><span class="linenos"> 27</span></a><span class="sd">        The entities (`ent`) subtable.</span>
</span><span id="BIDSTable-28"><a href="#BIDSTable-28"><span class="linenos"> 28</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="BIDSTable-29"><a href="#BIDSTable-29"><span class="linenos"> 29</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">nested</span><span class="p">[</span><span class="s2">&quot;ent&quot;</span><span class="p">]</span>
</span><span id="BIDSTable-30"><a href="#BIDSTable-30"><span class="linenos"> 30</span></a>
</span><span id="BIDSTable-31"><a href="#BIDSTable-31"><span class="linenos"> 31</span></a>    <span class="nd">@cached_property</span>
</span><span id="BIDSTable-32"><a href="#BIDSTable-32"><span class="linenos"> 32</span></a>    <span class="k">def</span> <span class="nf">meta</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
</span><span id="BIDSTable-33"><a href="#BIDSTable-33"><span class="linenos"> 33</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="BIDSTable-34"><a href="#BIDSTable-34"><span class="linenos"> 34</span></a><span class="sd">        The metadata (`meta`) subtable.</span>
</span><span id="BIDSTable-35"><a href="#BIDSTable-35"><span class="linenos"> 35</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="BIDSTable-36"><a href="#BIDSTable-36"><span class="linenos"> 36</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">nested</span><span class="p">[</span><span class="s2">&quot;meta&quot;</span><span class="p">]</span>
</span><span id="BIDSTable-37"><a href="#BIDSTable-37"><span class="linenos"> 37</span></a>
</span><span id="BIDSTable-38"><a href="#BIDSTable-38"><span class="linenos"> 38</span></a>    <span class="nd">@cached_property</span>
</span><span id="BIDSTable-39"><a href="#BIDSTable-39"><span class="linenos"> 39</span></a>    <span class="k">def</span> <span class="nf">finfo</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
</span><span id="BIDSTable-40"><a href="#BIDSTable-40"><span class="linenos"> 40</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="BIDSTable-41"><a href="#BIDSTable-41"><span class="linenos"> 41</span></a><span class="sd">        The file info (`finfo`) subtable.</span>
</span><span id="BIDSTable-42"><a href="#BIDSTable-42"><span class="linenos"> 42</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="BIDSTable-43"><a href="#BIDSTable-43"><span class="linenos"> 43</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">nested</span><span class="p">[</span><span class="s2">&quot;finfo&quot;</span><span class="p">]</span>
</span><span id="BIDSTable-44"><a href="#BIDSTable-44"><span class="linenos"> 44</span></a>
</span><span id="BIDSTable-45"><a href="#BIDSTable-45"><span class="linenos"> 45</span></a>    <span class="nd">@cached_property</span>
</span><span id="BIDSTable-46"><a href="#BIDSTable-46"><span class="linenos"> 46</span></a>    <span class="k">def</span> <span class="nf">files</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="s2">&quot;BIDSFile&quot;</span><span class="p">]:</span>
</span><span id="BIDSTable-47"><a href="#BIDSTable-47"><span class="linenos"> 47</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="BIDSTable-48"><a href="#BIDSTable-48"><span class="linenos"> 48</span></a><span class="sd">        Convert the table to a list of structured `BIDSFile`s.</span>
</span><span id="BIDSTable-49"><a href="#BIDSTable-49"><span class="linenos"> 49</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="BIDSTable-50"><a href="#BIDSTable-50"><span class="linenos"> 50</span></a>
</span><span id="BIDSTable-51"><a href="#BIDSTable-51"><span class="linenos"> 51</span></a>        <span class="k">def</span> <span class="nf">to_dict</span><span class="p">(</span><span class="n">val</span><span class="p">):</span>
</span><span id="BIDSTable-52"><a href="#BIDSTable-52"><span class="linenos"> 52</span></a>            <span class="k">if</span> <span class="n">pd</span><span class="o">.</span><span class="n">isna</span><span class="p">(</span><span class="n">val</span><span class="p">):</span>
</span><span id="BIDSTable-53"><a href="#BIDSTable-53"><span class="linenos"> 53</span></a>                <span class="k">return</span> <span class="p">{}</span>
</span><span id="BIDSTable-54"><a href="#BIDSTable-54"><span class="linenos"> 54</span></a>            <span class="k">return</span> <span class="nb">dict</span><span class="p">(</span><span class="n">val</span><span class="p">)</span>
</span><span id="BIDSTable-55"><a href="#BIDSTable-55"><span class="linenos"> 55</span></a>
</span><span id="BIDSTable-56"><a href="#BIDSTable-56"><span class="linenos"> 56</span></a>        <span class="k">return</span> <span class="p">[</span>
</span><span id="BIDSTable-57"><a href="#BIDSTable-57"><span class="linenos"> 57</span></a>            <span class="n">BIDSFile</span><span class="p">(</span>
</span><span id="BIDSTable-58"><a href="#BIDSTable-58"><span class="linenos"> 58</span></a>                <span class="n">dataset</span><span class="o">=</span><span class="n">row</span><span class="p">[</span><span class="s2">&quot;ds&quot;</span><span class="p">][</span><span class="s2">&quot;dataset&quot;</span><span class="p">],</span>
</span><span id="BIDSTable-59"><a href="#BIDSTable-59"><span class="linenos"> 59</span></a>                <span class="n">root</span><span class="o">=</span><span class="n">Path</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s2">&quot;ds&quot;</span><span class="p">][</span><span class="s2">&quot;dataset_path&quot;</span><span class="p">]),</span>
</span><span id="BIDSTable-60"><a href="#BIDSTable-60"><span class="linenos"> 60</span></a>                <span class="n">path</span><span class="o">=</span><span class="n">Path</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s2">&quot;finfo&quot;</span><span class="p">][</span><span class="s2">&quot;file_path&quot;</span><span class="p">]),</span>
</span><span id="BIDSTable-61"><a href="#BIDSTable-61"><span class="linenos"> 61</span></a>                <span class="n">entities</span><span class="o">=</span><span class="n">BIDSEntities</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s2">&quot;ent&quot;</span><span class="p">]),</span>
</span><span id="BIDSTable-62"><a href="#BIDSTable-62"><span class="linenos"> 62</span></a>                <span class="n">metadata</span><span class="o">=</span><span class="n">to_dict</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s2">&quot;meta&quot;</span><span class="p">][</span><span class="s2">&quot;json&quot;</span><span class="p">]),</span>
</span><span id="BIDSTable-63"><a href="#BIDSTable-63"><span class="linenos"> 63</span></a>            <span class="p">)</span>
</span><span id="BIDSTable-64"><a href="#BIDSTable-64"><span class="linenos"> 64</span></a>            <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">nested</span><span class="o">.</span><span class="n">iterrows</span><span class="p">()</span>
</span><span id="BIDSTable-65"><a href="#BIDSTable-65"><span class="linenos"> 65</span></a>        <span class="p">]</span>
</span><span id="BIDSTable-66"><a href="#BIDSTable-66"><span class="linenos"> 66</span></a>
</span><span id="BIDSTable-67"><a href="#BIDSTable-67"><span class="linenos"> 67</span></a>    <span class="nd">@cached_property</span>
</span><span id="BIDSTable-68"><a href="#BIDSTable-68"><span class="linenos"> 68</span></a>    <span class="k">def</span> <span class="nf">datatypes</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
</span><span id="BIDSTable-69"><a href="#BIDSTable-69"><span class="linenos"> 69</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="BIDSTable-70"><a href="#BIDSTable-70"><span class="linenos"> 70</span></a><span class="sd">        Get all datatypes present in the table.</span>
</span><span id="BIDSTable-71"><a href="#BIDSTable-71"><span class="linenos"> 71</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="BIDSTable-72"><a href="#BIDSTable-72"><span class="linenos"> 72</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">ent</span><span class="p">[</span><span class="s2">&quot;datatype&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
</span><span id="BIDSTable-73"><a href="#BIDSTable-73"><span class="linenos"> 73</span></a>
</span><span id="BIDSTable-74"><a href="#BIDSTable-74"><span class="linenos"> 74</span></a>    <span class="nd">@cached_property</span>
</span><span id="BIDSTable-75"><a href="#BIDSTable-75"><span class="linenos"> 75</span></a>    <span class="k">def</span> <span class="nf">modalities</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
</span><span id="BIDSTable-76"><a href="#BIDSTable-76"><span class="linenos"> 76</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="BIDSTable-77"><a href="#BIDSTable-77"><span class="linenos"> 77</span></a><span class="sd">        Get all modalities present in the table.</span>
</span><span id="BIDSTable-78"><a href="#BIDSTable-78"><span class="linenos"> 78</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="BIDSTable-79"><a href="#BIDSTable-79"><span class="linenos"> 79</span></a>        <span class="c1"># TODO: Is this the right way to get the modality</span>
</span><span id="BIDSTable-80"><a href="#BIDSTable-80"><span class="linenos"> 80</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">ent</span><span class="p">[</span><span class="s2">&quot;mod&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
</span><span id="BIDSTable-81"><a href="#BIDSTable-81"><span class="linenos"> 81</span></a>
</span><span id="BIDSTable-82"><a href="#BIDSTable-82"><span class="linenos"> 82</span></a>    <span class="nd">@cached_property</span>
</span><span id="BIDSTable-83"><a href="#BIDSTable-83"><span class="linenos"> 83</span></a>    <span class="k">def</span> <span class="nf">subjects</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
</span><span id="BIDSTable-84"><a href="#BIDSTable-84"><span class="linenos"> 84</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="BIDSTable-85"><a href="#BIDSTable-85"><span class="linenos"> 85</span></a><span class="sd">        Get all unique subjects in the table.</span>
</span><span id="BIDSTable-86"><a href="#BIDSTable-86"><span class="linenos"> 86</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="BIDSTable-87"><a href="#BIDSTable-87"><span class="linenos"> 87</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">ent</span><span class="p">[</span><span class="s2">&quot;sub&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
</span><span id="BIDSTable-88"><a href="#BIDSTable-88"><span class="linenos"> 88</span></a>
</span><span id="BIDSTable-89"><a href="#BIDSTable-89"><span class="linenos"> 89</span></a>    <span class="nd">@cached_property</span>
</span><span id="BIDSTable-90"><a href="#BIDSTable-90"><span class="linenos"> 90</span></a>    <span class="k">def</span> <span class="nf">entities</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
</span><span id="BIDSTable-91"><a href="#BIDSTable-91"><span class="linenos"> 91</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="BIDSTable-92"><a href="#BIDSTable-92"><span class="linenos"> 92</span></a><span class="sd">        Get all entity keys with at least one non-NA entry in the table.</span>
</span><span id="BIDSTable-93"><a href="#BIDSTable-93"><span class="linenos"> 93</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="BIDSTable-94"><a href="#BIDSTable-94"><span class="linenos"> 94</span></a>        <span class="n">entities</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ent</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s2">&quot;all&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
</span><span id="BIDSTable-95"><a href="#BIDSTable-95"><span class="linenos"> 95</span></a>        <span class="n">special</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">BIDSEntities</span><span class="o">.</span><span class="n">special</span><span class="p">())</span>
</span><span id="BIDSTable-96"><a href="#BIDSTable-96"><span class="linenos"> 96</span></a>        <span class="k">return</span> <span class="p">[</span><span class="n">key</span> <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">entities</span> <span class="k">if</span> <span class="n">key</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">special</span><span class="p">]</span>
</span><span id="BIDSTable-97"><a href="#BIDSTable-97"><span class="linenos"> 97</span></a>
</span><span id="BIDSTable-98"><a href="#BIDSTable-98"><span class="linenos"> 98</span></a>    <span class="nd">@cached_property</span>
</span><span id="BIDSTable-99"><a href="#BIDSTable-99"><span class="linenos"> 99</span></a>    <span class="k">def</span> <span class="nf">flat_meta</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
</span><span id="BIDSTable-100"><a href="#BIDSTable-100"><span class="linenos">100</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="BIDSTable-101"><a href="#BIDSTable-101"><span class="linenos">101</span></a><span class="sd">        A table of flattened JSON metadata where each metadata field is converted to its</span>
</span><span id="BIDSTable-102"><a href="#BIDSTable-102"><span class="linenos">102</span></a><span class="sd">        own column, with nested levels separated by `&#39;.&#39;`.</span>
</span><span id="BIDSTable-103"><a href="#BIDSTable-103"><span class="linenos">103</span></a>
</span><span id="BIDSTable-104"><a href="#BIDSTable-104"><span class="linenos">104</span></a><span class="sd">        See also:</span>
</span><span id="BIDSTable-105"><a href="#BIDSTable-105"><span class="linenos">105</span></a>
</span><span id="BIDSTable-106"><a href="#BIDSTable-106"><span class="linenos">106</span></a><span class="sd">        - [`pd.json_normalize`](https://pandas.pydata.org/docs/reference/api/pandas.json_normalize.html):</span>
</span><span id="BIDSTable-107"><a href="#BIDSTable-107"><span class="linenos">107</span></a><span class="sd">        more general function in pandas.</span>
</span><span id="BIDSTable-108"><a href="#BIDSTable-108"><span class="linenos">108</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="BIDSTable-109"><a href="#BIDSTable-109"><span class="linenos">109</span></a>        <span class="c1"># Need to replace None with empty dict for max_level=0 to work.</span>
</span><span id="BIDSTable-110"><a href="#BIDSTable-110"><span class="linenos">110</span></a>        <span class="n">metadata</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">json_normalize</span><span class="p">(</span>
</span><span id="BIDSTable-111"><a href="#BIDSTable-111"><span class="linenos">111</span></a>            <span class="bp">self</span><span class="p">[</span><span class="s2">&quot;meta__json&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">v</span><span class="p">:</span> <span class="n">v</span> <span class="ow">or</span> <span class="p">{}),</span> <span class="n">max_level</span><span class="o">=</span><span class="mi">0</span>
</span><span id="BIDSTable-112"><a href="#BIDSTable-112"><span class="linenos">112</span></a>        <span class="p">)</span>
</span><span id="BIDSTable-113"><a href="#BIDSTable-113"><span class="linenos">113</span></a>        <span class="n">metadata</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">index</span>
</span><span id="BIDSTable-114"><a href="#BIDSTable-114"><span class="linenos">114</span></a>        <span class="k">return</span> <span class="n">metadata</span>
</span><span id="BIDSTable-115"><a href="#BIDSTable-115"><span class="linenos">115</span></a>
</span><span id="BIDSTable-116"><a href="#BIDSTable-116"><span class="linenos">116</span></a>    <span class="nd">@cached_property</span>
</span><span id="BIDSTable-117"><a href="#BIDSTable-117"><span class="linenos">117</span></a>    <span class="k">def</span> <span class="nf">nested</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
</span><span id="BIDSTable-118"><a href="#BIDSTable-118"><span class="linenos">118</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="BIDSTable-119"><a href="#BIDSTable-119"><span class="linenos">119</span></a><span class="sd">        A copy of the table with column labels organized in a nested</span>
</span><span id="BIDSTable-120"><a href="#BIDSTable-120"><span class="linenos">120</span></a><span class="sd">        [`MultiIndex`](https://pandas.pydata.org/docs/user_guide/advanced.html#hierarchical-indexing-multiindex).</span>
</span><span id="BIDSTable-121"><a href="#BIDSTable-121"><span class="linenos">121</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="BIDSTable-122"><a href="#BIDSTable-122"><span class="linenos">122</span></a>        <span class="c1"># Cast back to the base class since we no longer have the full BIDS table</span>
</span><span id="BIDSTable-123"><a href="#BIDSTable-123"><span class="linenos">123</span></a>        <span class="c1"># structure.</span>
</span><span id="BIDSTable-124"><a href="#BIDSTable-124"><span class="linenos">124</span></a>        <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">flat_to_multi_columns</span><span class="p">(</span><span class="bp">self</span><span class="p">))</span>
</span><span id="BIDSTable-125"><a href="#BIDSTable-125"><span class="linenos">125</span></a>
</span><span id="BIDSTable-126"><a href="#BIDSTable-126"><span class="linenos">126</span></a>    <span class="nd">@cached_property</span>
</span><span id="BIDSTable-127"><a href="#BIDSTable-127"><span class="linenos">127</span></a>    <span class="k">def</span> <span class="nf">flat</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
</span><span id="BIDSTable-128"><a href="#BIDSTable-128"><span class="linenos">128</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="BIDSTable-129"><a href="#BIDSTable-129"><span class="linenos">129</span></a><span class="sd">        A copy of the table with subtable prefixes e.g. `ds__`, `ent__` removed.</span>
</span><span id="BIDSTable-130"><a href="#BIDSTable-130"><span class="linenos">130</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="BIDSTable-131"><a href="#BIDSTable-131"><span class="linenos">131</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">nested</span><span class="o">.</span><span class="n">droplevel</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span><span id="BIDSTable-132"><a href="#BIDSTable-132"><span class="linenos">132</span></a>
</span><span id="BIDSTable-133"><a href="#BIDSTable-133"><span class="linenos">133</span></a>    <span class="k">def</span> <span class="nf">filter</span><span class="p">(</span>
</span><span id="BIDSTable-134"><a href="#BIDSTable-134"><span class="linenos">134</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="BIDSTable-135"><a href="#BIDSTable-135"><span class="linenos">135</span></a>        <span class="n">key</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="BIDSTable-136"><a href="#BIDSTable-136"><span class="linenos">136</span></a>        <span class="n">value</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="BIDSTable-137"><a href="#BIDSTable-137"><span class="linenos">137</span></a>        <span class="o">*</span><span class="p">,</span>
</span><span id="BIDSTable-138"><a href="#BIDSTable-138"><span class="linenos">138</span></a>        <span class="n">items</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Iterable</span><span class="p">[</span><span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="BIDSTable-139"><a href="#BIDSTable-139"><span class="linenos">139</span></a>        <span class="n">contains</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="BIDSTable-140"><a href="#BIDSTable-140"><span class="linenos">140</span></a>        <span class="n">regex</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="BIDSTable-141"><a href="#BIDSTable-141"><span class="linenos">141</span></a>        <span class="n">func</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Callable</span><span class="p">[[</span><span class="n">Any</span><span class="p">],</span> <span class="nb">bool</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="BIDSTable-142"><a href="#BIDSTable-142"><span class="linenos">142</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;BIDSTable&quot;</span><span class="p">:</span>
</span><span id="BIDSTable-143"><a href="#BIDSTable-143"><span class="linenos">143</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="BIDSTable-144"><a href="#BIDSTable-144"><span class="linenos">144</span></a><span class="sd">        Filter the rows of the table.</span>
</span><span id="BIDSTable-145"><a href="#BIDSTable-145"><span class="linenos">145</span></a>
</span><span id="BIDSTable-146"><a href="#BIDSTable-146"><span class="linenos">146</span></a><span class="sd">        Args:</span>
</span><span id="BIDSTable-147"><a href="#BIDSTable-147"><span class="linenos">147</span></a><span class="sd">            key: Column to filter. Can be a metadata field, BIDS entity name, or any</span>
</span><span id="BIDSTable-148"><a href="#BIDSTable-148"><span class="linenos">148</span></a><span class="sd">                unprefixed column label in the `flat` table.</span>
</span><span id="BIDSTable-149"><a href="#BIDSTable-149"><span class="linenos">149</span></a><span class="sd">            value: Keep rows with this exact value.</span>
</span><span id="BIDSTable-150"><a href="#BIDSTable-150"><span class="linenos">150</span></a><span class="sd">            items: Keep rows whose value is in `items`.</span>
</span><span id="BIDSTable-151"><a href="#BIDSTable-151"><span class="linenos">151</span></a><span class="sd">            contains: Keep rows whose value contains `contains` (string only).</span>
</span><span id="BIDSTable-152"><a href="#BIDSTable-152"><span class="linenos">152</span></a><span class="sd">            regex: Keep rows whose value matches `regex` (string only).</span>
</span><span id="BIDSTable-153"><a href="#BIDSTable-153"><span class="linenos">153</span></a><span class="sd">            func: Apply an arbitrary function and keep values that evaluate to `True`.</span>
</span><span id="BIDSTable-154"><a href="#BIDSTable-154"><span class="linenos">154</span></a>
</span><span id="BIDSTable-155"><a href="#BIDSTable-155"><span class="linenos">155</span></a><span class="sd">        Returns:</span>
</span><span id="BIDSTable-156"><a href="#BIDSTable-156"><span class="linenos">156</span></a><span class="sd">            A filtered BIDS table.</span>
</span><span id="BIDSTable-157"><a href="#BIDSTable-157"><span class="linenos">157</span></a>
</span><span id="BIDSTable-158"><a href="#BIDSTable-158"><span class="linenos">158</span></a><span class="sd">        Example::</span>
</span><span id="BIDSTable-159"><a href="#BIDSTable-159"><span class="linenos">159</span></a><span class="sd">            filtered = (</span>
</span><span id="BIDSTable-160"><a href="#BIDSTable-160"><span class="linenos">160</span></a><span class="sd">                tab</span>
</span><span id="BIDSTable-161"><a href="#BIDSTable-161"><span class="linenos">161</span></a><span class="sd">                .filter(&quot;task&quot;, &quot;rest&quot;)</span>
</span><span id="BIDSTable-162"><a href="#BIDSTable-162"><span class="linenos">162</span></a><span class="sd">                .filter(&quot;sub&quot;, items=[&quot;04&quot;, &quot;06&quot;])</span>
</span><span id="BIDSTable-163"><a href="#BIDSTable-163"><span class="linenos">163</span></a><span class="sd">                .filter(&quot;RepetitionTime&quot;, 2.0)</span>
</span><span id="BIDSTable-164"><a href="#BIDSTable-164"><span class="linenos">164</span></a><span class="sd">            )</span>
</span><span id="BIDSTable-165"><a href="#BIDSTable-165"><span class="linenos">165</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="BIDSTable-166"><a href="#BIDSTable-166"><span class="linenos">166</span></a>        <span class="c1"># NOTE: Should be careful about reinventing a new style of query API. There are</span>
</span><span id="BIDSTable-167"><a href="#BIDSTable-167"><span class="linenos">167</span></a>        <span class="c1"># some obvious things this can&#39;t do:</span>
</span><span id="BIDSTable-168"><a href="#BIDSTable-168"><span class="linenos">168</span></a>        <span class="c1">#   - comparison operators &lt;, &gt;, &lt;=, &gt;=</span>
</span><span id="BIDSTable-169"><a href="#BIDSTable-169"><span class="linenos">169</span></a>        <span class="c1">#   - negation</span>
</span><span id="BIDSTable-170"><a href="#BIDSTable-170"><span class="linenos">170</span></a>        <span class="c1">#   - combining filters with &#39;or&#39; instead of &#39;and&#39;</span>
</span><span id="BIDSTable-171"><a href="#BIDSTable-171"><span class="linenos">171</span></a>        <span class="c1"># At the bottom of this rabbit hole are more general query interfaces like those</span>
</span><span id="BIDSTable-172"><a href="#BIDSTable-172"><span class="linenos">172</span></a>        <span class="c1"># already implemented in pandas, duckdb, polars. The goal should be not to</span>
</span><span id="BIDSTable-173"><a href="#BIDSTable-173"><span class="linenos">173</span></a>        <span class="c1"># create a new one, but to make the 95% of use cases as easy as possible, and</span>
</span><span id="BIDSTable-174"><a href="#BIDSTable-174"><span class="linenos">174</span></a>        <span class="c1"># empower users to interact with the underlying table using their more powerful</span>
</span><span id="BIDSTable-175"><a href="#BIDSTable-175"><span class="linenos">175</span></a>        <span class="c1"># tool of choice if necessary.</span>
</span><span id="BIDSTable-176"><a href="#BIDSTable-176"><span class="linenos">176</span></a>        <span class="k">if</span> <span class="nb">sum</span><span class="p">(</span><span class="n">k</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="p">[</span><span class="n">value</span><span class="p">,</span> <span class="n">items</span><span class="p">,</span> <span class="n">contains</span><span class="p">,</span> <span class="n">regex</span><span class="p">,</span> <span class="n">func</span><span class="p">])</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="BIDSTable-177"><a href="#BIDSTable-177"><span class="linenos">177</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
</span><span id="BIDSTable-178"><a href="#BIDSTable-178"><span class="linenos">178</span></a>                <span class="s2">&quot;Exactly one of value, items, contains, regex, or func must not be None&quot;</span>
</span><span id="BIDSTable-179"><a href="#BIDSTable-179"><span class="linenos">179</span></a>            <span class="p">)</span>
</span><span id="BIDSTable-180"><a href="#BIDSTable-180"><span class="linenos">180</span></a>
</span><span id="BIDSTable-181"><a href="#BIDSTable-181"><span class="linenos">181</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="BIDSTable-182"><a href="#BIDSTable-182"><span class="linenos">182</span></a>            <span class="c1"># JSON metadata field</span>
</span><span id="BIDSTable-183"><a href="#BIDSTable-183"><span class="linenos">183</span></a>            <span class="c1"># NOTE: Assuming all JSON metadata fields are uppercase.</span>
</span><span id="BIDSTable-184"><a href="#BIDSTable-184"><span class="linenos">184</span></a>            <span class="k">if</span> <span class="n">key</span><span class="p">[:</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">isupper</span><span class="p">():</span>
</span><span id="BIDSTable-185"><a href="#BIDSTable-185"><span class="linenos">185</span></a>                <span class="n">col</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">flat_meta</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
</span><span id="BIDSTable-186"><a href="#BIDSTable-186"><span class="linenos">186</span></a>            <span class="c1"># Long name entity</span>
</span><span id="BIDSTable-187"><a href="#BIDSTable-187"><span class="linenos">187</span></a>            <span class="k">elif</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">ENTITY_NAMES_TO_KEYS</span><span class="p">:</span>
</span><span id="BIDSTable-188"><a href="#BIDSTable-188"><span class="linenos">188</span></a>                <span class="n">col</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ent</span><span class="p">[</span><span class="n">ENTITY_NAMES_TO_KEYS</span><span class="p">[</span><span class="n">key</span><span class="p">]]</span>
</span><span id="BIDSTable-189"><a href="#BIDSTable-189"><span class="linenos">189</span></a>            <span class="c1"># Any other unprefixed column</span>
</span><span id="BIDSTable-190"><a href="#BIDSTable-190"><span class="linenos">190</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="BIDSTable-191"><a href="#BIDSTable-191"><span class="linenos">191</span></a>                <span class="n">col</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">flat</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
</span><span id="BIDSTable-192"><a href="#BIDSTable-192"><span class="linenos">192</span></a>        <span class="k">except</span> <span class="ne">KeyError</span> <span class="k">as</span> <span class="n">exc</span><span class="p">:</span>
</span><span id="BIDSTable-193"><a href="#BIDSTable-193"><span class="linenos">193</span></a>            <span class="k">raise</span> <span class="ne">KeyError</span><span class="p">(</span>
</span><span id="BIDSTable-194"><a href="#BIDSTable-194"><span class="linenos">194</span></a>                <span class="sa">f</span><span class="s2">&quot;Invalid key </span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s2">; expected a valid BIDS entity or metadata field &quot;</span>
</span><span id="BIDSTable-195"><a href="#BIDSTable-195"><span class="linenos">195</span></a>                <span class="s2">&quot;present in the dataset&quot;</span>
</span><span id="BIDSTable-196"><a href="#BIDSTable-196"><span class="linenos">196</span></a>            <span class="p">)</span> <span class="kn">from</span> <span class="nn">exc</span>
</span><span id="BIDSTable-197"><a href="#BIDSTable-197"><span class="linenos">197</span></a>
</span><span id="BIDSTable-198"><a href="#BIDSTable-198"><span class="linenos">198</span></a>        <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="BIDSTable-199"><a href="#BIDSTable-199"><span class="linenos">199</span></a>            <span class="n">mask</span> <span class="o">=</span> <span class="n">col</span> <span class="o">==</span> <span class="n">value</span>
</span><span id="BIDSTable-200"><a href="#BIDSTable-200"><span class="linenos">200</span></a>        <span class="k">elif</span> <span class="n">items</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="BIDSTable-201"><a href="#BIDSTable-201"><span class="linenos">201</span></a>            <span class="n">mask</span> <span class="o">=</span> <span class="n">col</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">items</span><span class="p">)</span>
</span><span id="BIDSTable-202"><a href="#BIDSTable-202"><span class="linenos">202</span></a>        <span class="k">elif</span> <span class="n">contains</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="BIDSTable-203"><a href="#BIDSTable-203"><span class="linenos">203</span></a>            <span class="n">mask</span> <span class="o">=</span> <span class="n">col</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="n">contains</span><span class="p">)</span>
</span><span id="BIDSTable-204"><a href="#BIDSTable-204"><span class="linenos">204</span></a>        <span class="k">elif</span> <span class="n">regex</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="BIDSTable-205"><a href="#BIDSTable-205"><span class="linenos">205</span></a>            <span class="n">mask</span> <span class="o">=</span> <span class="n">col</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="n">regex</span><span class="p">)</span>
</span><span id="BIDSTable-206"><a href="#BIDSTable-206"><span class="linenos">206</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="BIDSTable-207"><a href="#BIDSTable-207"><span class="linenos">207</span></a>            <span class="n">mask</span> <span class="o">=</span> <span class="n">col</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">func</span><span class="p">)</span>
</span><span id="BIDSTable-208"><a href="#BIDSTable-208"><span class="linenos">208</span></a>        <span class="n">mask</span> <span class="o">=</span> <span class="n">mask</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">bool</span><span class="p">)</span>
</span><span id="BIDSTable-209"><a href="#BIDSTable-209"><span class="linenos">209</span></a>
</span><span id="BIDSTable-210"><a href="#BIDSTable-210"><span class="linenos">210</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">mask</span><span class="p">]</span>
</span><span id="BIDSTable-211"><a href="#BIDSTable-211"><span class="linenos">211</span></a>
</span><span id="BIDSTable-212"><a href="#BIDSTable-212"><span class="linenos">212</span></a>    <span class="k">def</span> <span class="nf">filter_multi</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">filters</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;BIDSTable&quot;</span><span class="p">:</span>
</span><span id="BIDSTable-213"><a href="#BIDSTable-213"><span class="linenos">213</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="BIDSTable-214"><a href="#BIDSTable-214"><span class="linenos">214</span></a><span class="sd">        Apply multiple filters to the table sequentially.</span>
</span><span id="BIDSTable-215"><a href="#BIDSTable-215"><span class="linenos">215</span></a>
</span><span id="BIDSTable-216"><a href="#BIDSTable-216"><span class="linenos">216</span></a><span class="sd">        Args:</span>
</span><span id="BIDSTable-217"><a href="#BIDSTable-217"><span class="linenos">217</span></a><span class="sd">            filters: A mapping of column labels to queries. Each query can either be</span>
</span><span id="BIDSTable-218"><a href="#BIDSTable-218"><span class="linenos">218</span></a><span class="sd">                a single value for an exact equality check or a `dict` for a more</span>
</span><span id="BIDSTable-219"><a href="#BIDSTable-219"><span class="linenos">219</span></a><span class="sd">                complex query, e.g. `{&quot;items&quot;: [1, 2, 3]}`, that&#39;s passed through to</span>
</span><span id="BIDSTable-220"><a href="#BIDSTable-220"><span class="linenos">220</span></a><span class="sd">                `filter`.</span>
</span><span id="BIDSTable-221"><a href="#BIDSTable-221"><span class="linenos">221</span></a>
</span><span id="BIDSTable-222"><a href="#BIDSTable-222"><span class="linenos">222</span></a><span class="sd">        Returns:</span>
</span><span id="BIDSTable-223"><a href="#BIDSTable-223"><span class="linenos">223</span></a><span class="sd">            A filtered BIDS table.</span>
</span><span id="BIDSTable-224"><a href="#BIDSTable-224"><span class="linenos">224</span></a>
</span><span id="BIDSTable-225"><a href="#BIDSTable-225"><span class="linenos">225</span></a><span class="sd">        Example::</span>
</span><span id="BIDSTable-226"><a href="#BIDSTable-226"><span class="linenos">226</span></a><span class="sd">            filtered = tab.filter_multi(</span>
</span><span id="BIDSTable-227"><a href="#BIDSTable-227"><span class="linenos">227</span></a><span class="sd">                task=&quot;rest&quot;</span>
</span><span id="BIDSTable-228"><a href="#BIDSTable-228"><span class="linenos">228</span></a><span class="sd">                sub={&quot;items&quot;: [&quot;04&quot;, &quot;06&quot;]},</span>
</span><span id="BIDSTable-229"><a href="#BIDSTable-229"><span class="linenos">229</span></a><span class="sd">                RepetitionTime=2.0,</span>
</span><span id="BIDSTable-230"><a href="#BIDSTable-230"><span class="linenos">230</span></a><span class="sd">            )</span>
</span><span id="BIDSTable-231"><a href="#BIDSTable-231"><span class="linenos">231</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="BIDSTable-232"><a href="#BIDSTable-232"><span class="linenos">232</span></a>        <span class="n">tab</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">deep</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="BIDSTable-233"><a href="#BIDSTable-233"><span class="linenos">233</span></a>
</span><span id="BIDSTable-234"><a href="#BIDSTable-234"><span class="linenos">234</span></a>        <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">query</span> <span class="ow">in</span> <span class="n">filters</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="BIDSTable-235"><a href="#BIDSTable-235"><span class="linenos">235</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">query</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
</span><span id="BIDSTable-236"><a href="#BIDSTable-236"><span class="linenos">236</span></a>                <span class="n">query</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="n">query</span><span class="p">}</span>
</span><span id="BIDSTable-237"><a href="#BIDSTable-237"><span class="linenos">237</span></a>            <span class="n">tab</span> <span class="o">=</span> <span class="n">tab</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="o">**</span><span class="n">query</span><span class="p">)</span>
</span><span id="BIDSTable-238"><a href="#BIDSTable-238"><span class="linenos">238</span></a>        <span class="k">return</span> <span class="n">tab</span>
</span><span id="BIDSTable-239"><a href="#BIDSTable-239"><span class="linenos">239</span></a>
</span><span id="BIDSTable-240"><a href="#BIDSTable-240"><span class="linenos">240</span></a>    <span class="k">def</span> <span class="nf">sort_entities</span><span class="p">(</span>
</span><span id="BIDSTable-241"><a href="#BIDSTable-241"><span class="linenos">241</span></a>        <span class="bp">self</span><span class="p">,</span> <span class="n">by</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]],</span> <span class="n">inplace</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="BIDSTable-242"><a href="#BIDSTable-242"><span class="linenos">242</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;BIDSTable&quot;</span><span class="p">:</span>
</span><span id="BIDSTable-243"><a href="#BIDSTable-243"><span class="linenos">243</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="BIDSTable-244"><a href="#BIDSTable-244"><span class="linenos">244</span></a><span class="sd">        Sort the values of the table by entities.</span>
</span><span id="BIDSTable-245"><a href="#BIDSTable-245"><span class="linenos">245</span></a>
</span><span id="BIDSTable-246"><a href="#BIDSTable-246"><span class="linenos">246</span></a><span class="sd">        Args:</span>
</span><span id="BIDSTable-247"><a href="#BIDSTable-247"><span class="linenos">247</span></a><span class="sd">            by: label or list of labels. Can be `&quot;dataset&quot;` or a short or long entity</span>
</span><span id="BIDSTable-248"><a href="#BIDSTable-248"><span class="linenos">248</span></a><span class="sd">                name.</span>
</span><span id="BIDSTable-249"><a href="#BIDSTable-249"><span class="linenos">249</span></a><span class="sd">            inplace: sort the table in place</span>
</span><span id="BIDSTable-250"><a href="#BIDSTable-250"><span class="linenos">250</span></a>
</span><span id="BIDSTable-251"><a href="#BIDSTable-251"><span class="linenos">251</span></a><span class="sd">        Returns:</span>
</span><span id="BIDSTable-252"><a href="#BIDSTable-252"><span class="linenos">252</span></a><span class="sd">            A sorted BIDS table.</span>
</span><span id="BIDSTable-253"><a href="#BIDSTable-253"><span class="linenos">253</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="BIDSTable-254"><a href="#BIDSTable-254"><span class="linenos">254</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">by</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
</span><span id="BIDSTable-255"><a href="#BIDSTable-255"><span class="linenos">255</span></a>            <span class="n">by</span> <span class="o">=</span> <span class="p">[</span><span class="n">by</span><span class="p">]</span>
</span><span id="BIDSTable-256"><a href="#BIDSTable-256"><span class="linenos">256</span></a>
</span><span id="BIDSTable-257"><a href="#BIDSTable-257"><span class="linenos">257</span></a>        <span class="c1"># TODO: what about sorting by other columns, e.g. file_path?</span>
</span><span id="BIDSTable-258"><a href="#BIDSTable-258"><span class="linenos">258</span></a>        <span class="k">def</span> <span class="nf">add_prefix</span><span class="p">(</span><span class="n">k</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
</span><span id="BIDSTable-259"><a href="#BIDSTable-259"><span class="linenos">259</span></a>            <span class="k">if</span> <span class="n">k</span> <span class="o">==</span> <span class="s2">&quot;dataset&quot;</span><span class="p">:</span>
</span><span id="BIDSTable-260"><a href="#BIDSTable-260"><span class="linenos">260</span></a>                <span class="n">k</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;ds__</span><span class="si">{</span><span class="n">k</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="BIDSTable-261"><a href="#BIDSTable-261"><span class="linenos">261</span></a>            <span class="k">elif</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">ENTITY_NAMES_TO_KEYS</span><span class="p">:</span>
</span><span id="BIDSTable-262"><a href="#BIDSTable-262"><span class="linenos">262</span></a>                <span class="n">k</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;ent__</span><span class="si">{</span><span class="n">ENTITY_NAMES_TO_KEYS</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="BIDSTable-263"><a href="#BIDSTable-263"><span class="linenos">263</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="BIDSTable-264"><a href="#BIDSTable-264"><span class="linenos">264</span></a>                <span class="n">k</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;ent__</span><span class="si">{</span><span class="n">k</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="BIDSTable-265"><a href="#BIDSTable-265"><span class="linenos">265</span></a>            <span class="k">return</span> <span class="n">k</span>
</span><span id="BIDSTable-266"><a href="#BIDSTable-266"><span class="linenos">266</span></a>
</span><span id="BIDSTable-267"><a href="#BIDSTable-267"><span class="linenos">267</span></a>        <span class="n">by</span> <span class="o">=</span> <span class="p">[</span><span class="n">add_prefix</span><span class="p">(</span><span class="n">k</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">by</span><span class="p">]</span>
</span><span id="BIDSTable-268"><a href="#BIDSTable-268"><span class="linenos">268</span></a>        <span class="n">out</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="n">inplace</span><span class="p">)</span>
</span><span id="BIDSTable-269"><a href="#BIDSTable-269"><span class="linenos">269</span></a>        <span class="k">if</span> <span class="n">inplace</span><span class="p">:</span>
</span><span id="BIDSTable-270"><a href="#BIDSTable-270"><span class="linenos">270</span></a>            <span class="k">return</span> <span class="bp">self</span>
</span><span id="BIDSTable-271"><a href="#BIDSTable-271"><span class="linenos">271</span></a>        <span class="k">return</span> <span class="n">out</span>
</span><span id="BIDSTable-272"><a href="#BIDSTable-272"><span class="linenos">272</span></a>
</span><span id="BIDSTable-273"><a href="#BIDSTable-273"><span class="linenos">273</span></a>    <span class="nd">@classmethod</span>
</span><span id="BIDSTable-274"><a href="#BIDSTable-274"><span class="linenos">274</span></a>    <span class="k">def</span> <span class="nf">from_df</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">df</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;BIDSTable&quot;</span><span class="p">:</span>
</span><span id="BIDSTable-275"><a href="#BIDSTable-275"><span class="linenos">275</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="BIDSTable-276"><a href="#BIDSTable-276"><span class="linenos">276</span></a><span class="sd">        Create a BIDS table from a pandas `DataFrame` generated by `bids2table`.</span>
</span><span id="BIDSTable-277"><a href="#BIDSTable-277"><span class="linenos">277</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="BIDSTable-278"><a href="#BIDSTable-278"><span class="linenos">278</span></a>        <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
</span><span id="BIDSTable-279"><a href="#BIDSTable-279"><span class="linenos">279</span></a>
</span><span id="BIDSTable-280"><a href="#BIDSTable-280"><span class="linenos">280</span></a>    <span class="nd">@classmethod</span>
</span><span id="BIDSTable-281"><a href="#BIDSTable-281"><span class="linenos">281</span></a>    <span class="k">def</span> <span class="nf">from_parquet</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">path</span><span class="p">:</span> <span class="n">Path</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;BIDSTable&quot;</span><span class="p">:</span>
</span><span id="BIDSTable-282"><a href="#BIDSTable-282"><span class="linenos">282</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="BIDSTable-283"><a href="#BIDSTable-283"><span class="linenos">283</span></a><span class="sd">        Read a BIDS table from a Parquet file or dataset directory generated by</span>
</span><span id="BIDSTable-284"><a href="#BIDSTable-284"><span class="linenos">284</span></a><span class="sd">        `bids2table`.</span>
</span><span id="BIDSTable-285"><a href="#BIDSTable-285"><span class="linenos">285</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="BIDSTable-286"><a href="#BIDSTable-286"><span class="linenos">286</span></a>        <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_parquet</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
</span><span id="BIDSTable-287"><a href="#BIDSTable-287"><span class="linenos">287</span></a>        <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">from_df</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
</span><span id="BIDSTable-288"><a href="#BIDSTable-288"><span class="linenos">288</span></a>
</span><span id="BIDSTable-289"><a href="#BIDSTable-289"><span class="linenos">289</span></a>    <span class="nd">@property</span>
</span><span id="BIDSTable-290"><a href="#BIDSTable-290"><span class="linenos">290</span></a>    <span class="k">def</span> <span class="nf">_constructor</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="BIDSTable-291"><a href="#BIDSTable-291"><span class="linenos">291</span></a>        <span class="c1"># Makes sure that dataframe slices return a subclass instance</span>
</span><span id="BIDSTable-292"><a href="#BIDSTable-292"><span class="linenos">292</span></a>        <span class="c1"># https://pandas.pydata.org/docs/development/extending.html#override-constructor-properties</span>
</span><span id="BIDSTable-293"><a href="#BIDSTable-293"><span class="linenos">293</span></a>        <span class="k">return</span> <span class="n">BIDSTable</span>
</span></pre></div>


            <div class="docstring"><p>A table representing one or more BIDS datasets.</p>
</div>


                            <div id="BIDSTable.ds" class="classattr">
                                <div class="attr variable">
            <span class="name">ds</span><span class="annotation">: pandas.core.frame.DataFrame</span>

        
    </div>
    <a class="headerlink" href="#BIDSTable.ds"></a>
    
            <div class="docstring"><p>The dataset (<code><a href="#BIDSTable.ds">ds</a></code>) subtable.</p>
</div>


                            </div>
                            <div id="BIDSTable.ent" class="classattr">
                                <div class="attr variable">
            <span class="name">ent</span><span class="annotation">: pandas.core.frame.DataFrame</span>

        
    </div>
    <a class="headerlink" href="#BIDSTable.ent"></a>
    
            <div class="docstring"><p>The entities (<code><a href="#BIDSTable.ent">ent</a></code>) subtable.</p>
</div>


                            </div>
                            <div id="BIDSTable.meta" class="classattr">
                                <div class="attr variable">
            <span class="name">meta</span><span class="annotation">: pandas.core.frame.DataFrame</span>

        
    </div>
    <a class="headerlink" href="#BIDSTable.meta"></a>
    
            <div class="docstring"><p>The metadata (<code><a href="#BIDSTable.meta">meta</a></code>) subtable.</p>
</div>


                            </div>
                            <div id="BIDSTable.finfo" class="classattr">
                                <div class="attr variable">
            <span class="name">finfo</span><span class="annotation">: pandas.core.frame.DataFrame</span>

        
    </div>
    <a class="headerlink" href="#BIDSTable.finfo"></a>
    
            <div class="docstring"><p>The file info (<code><a href="#BIDSTable.finfo">finfo</a></code>) subtable.</p>
</div>


                            </div>
                            <div id="BIDSTable.files" class="classattr">
                                <div class="attr variable">
            <span class="name">files</span><span class="annotation">: List[<a href="#BIDSFile">bids2table.BIDSFile</a>]</span>

        
    </div>
    <a class="headerlink" href="#BIDSTable.files"></a>
    
            <div class="docstring"><p>Convert the table to a list of structured <code><a href="#BIDSFile">BIDSFile</a></code>s.</p>
</div>


                            </div>
                            <div id="BIDSTable.datatypes" class="classattr">
                                <div class="attr variable">
            <span class="name">datatypes</span><span class="annotation">: List[str]</span>

        
    </div>
    <a class="headerlink" href="#BIDSTable.datatypes"></a>
    
            <div class="docstring"><p>Get all datatypes present in the table.</p>
</div>


                            </div>
                            <div id="BIDSTable.modalities" class="classattr">
                                <div class="attr variable">
            <span class="name">modalities</span><span class="annotation">: List[str]</span>

        
    </div>
    <a class="headerlink" href="#BIDSTable.modalities"></a>
    
            <div class="docstring"><p>Get all modalities present in the table.</p>
</div>


                            </div>
                            <div id="BIDSTable.subjects" class="classattr">
                                <div class="attr variable">
            <span class="name">subjects</span><span class="annotation">: List[str]</span>

        
    </div>
    <a class="headerlink" href="#BIDSTable.subjects"></a>
    
            <div class="docstring"><p>Get all unique subjects in the table.</p>
</div>


                            </div>
                            <div id="BIDSTable.entities" class="classattr">
                                <div class="attr variable">
            <span class="name">entities</span><span class="annotation">: List[str]</span>

        
    </div>
    <a class="headerlink" href="#BIDSTable.entities"></a>
    
            <div class="docstring"><p>Get all entity keys with at least one non-NA entry in the table.</p>
</div>


                            </div>
                            <div id="BIDSTable.flat_meta" class="classattr">
                                <div class="attr variable">
            <span class="name">flat_meta</span><span class="annotation">: pandas.core.frame.DataFrame</span>

        
    </div>
    <a class="headerlink" href="#BIDSTable.flat_meta"></a>
    
            <div class="docstring"><p>A table of flattened JSON metadata where each metadata field is converted to its
own column, with nested levels separated by <code>'.'</code>.</p>

<p>See also:</p>

<ul>
<li><a href="https://pandas.pydata.org/docs/reference/api/pandas.json_normalize.html"><code>pd.json_normalize</code></a>:
more general function in pandas.</li>
</ul>
</div>


                            </div>
                            <div id="BIDSTable.nested" class="classattr">
                                <div class="attr variable">
            <span class="name">nested</span><span class="annotation">: pandas.core.frame.DataFrame</span>

        
    </div>
    <a class="headerlink" href="#BIDSTable.nested"></a>
    
            <div class="docstring"><p>A copy of the table with column labels organized in a nested
<a href="https://pandas.pydata.org/docs/user_guide/advanced.html#hierarchical-indexing-multiindex"><code>MultiIndex</code></a>.</p>
</div>


                            </div>
                            <div id="BIDSTable.flat" class="classattr">
                                <div class="attr variable">
            <span class="name">flat</span><span class="annotation">: pandas.core.frame.DataFrame</span>

        
    </div>
    <a class="headerlink" href="#BIDSTable.flat"></a>
    
            <div class="docstring"><p>A copy of the table with subtable prefixes e.g. <code>ds__</code>, <code>ent__</code> removed.</p>
</div>


                            </div>
                            <div id="BIDSTable.filter" class="classattr">
                                        <input id="BIDSTable.filter-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">filter</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">key</span><span class="p">:</span> <span class="nb">str</span>,</span><span class="param">	<span class="n">value</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="o">*</span>,</span><span class="param">	<span class="n">items</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Iterable</span><span class="p">[</span><span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">contains</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">regex</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">func</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Callable</span><span class="p">[[</span><span class="n">Any</span><span class="p">],</span> <span class="nb">bool</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span></span><span class="return-annotation">) -> <span class="n"><a href="#BIDSTable">bids2table.BIDSTable</a></span>:</span></span>

                <label class="view-source-button" for="BIDSTable.filter-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#BIDSTable.filter"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="BIDSTable.filter-133"><a href="#BIDSTable.filter-133"><span class="linenos">133</span></a>    <span class="k">def</span> <span class="nf">filter</span><span class="p">(</span>
</span><span id="BIDSTable.filter-134"><a href="#BIDSTable.filter-134"><span class="linenos">134</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="BIDSTable.filter-135"><a href="#BIDSTable.filter-135"><span class="linenos">135</span></a>        <span class="n">key</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="BIDSTable.filter-136"><a href="#BIDSTable.filter-136"><span class="linenos">136</span></a>        <span class="n">value</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="BIDSTable.filter-137"><a href="#BIDSTable.filter-137"><span class="linenos">137</span></a>        <span class="o">*</span><span class="p">,</span>
</span><span id="BIDSTable.filter-138"><a href="#BIDSTable.filter-138"><span class="linenos">138</span></a>        <span class="n">items</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Iterable</span><span class="p">[</span><span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="BIDSTable.filter-139"><a href="#BIDSTable.filter-139"><span class="linenos">139</span></a>        <span class="n">contains</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="BIDSTable.filter-140"><a href="#BIDSTable.filter-140"><span class="linenos">140</span></a>        <span class="n">regex</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="BIDSTable.filter-141"><a href="#BIDSTable.filter-141"><span class="linenos">141</span></a>        <span class="n">func</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Callable</span><span class="p">[[</span><span class="n">Any</span><span class="p">],</span> <span class="nb">bool</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="BIDSTable.filter-142"><a href="#BIDSTable.filter-142"><span class="linenos">142</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;BIDSTable&quot;</span><span class="p">:</span>
</span><span id="BIDSTable.filter-143"><a href="#BIDSTable.filter-143"><span class="linenos">143</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="BIDSTable.filter-144"><a href="#BIDSTable.filter-144"><span class="linenos">144</span></a><span class="sd">        Filter the rows of the table.</span>
</span><span id="BIDSTable.filter-145"><a href="#BIDSTable.filter-145"><span class="linenos">145</span></a>
</span><span id="BIDSTable.filter-146"><a href="#BIDSTable.filter-146"><span class="linenos">146</span></a><span class="sd">        Args:</span>
</span><span id="BIDSTable.filter-147"><a href="#BIDSTable.filter-147"><span class="linenos">147</span></a><span class="sd">            key: Column to filter. Can be a metadata field, BIDS entity name, or any</span>
</span><span id="BIDSTable.filter-148"><a href="#BIDSTable.filter-148"><span class="linenos">148</span></a><span class="sd">                unprefixed column label in the `flat` table.</span>
</span><span id="BIDSTable.filter-149"><a href="#BIDSTable.filter-149"><span class="linenos">149</span></a><span class="sd">            value: Keep rows with this exact value.</span>
</span><span id="BIDSTable.filter-150"><a href="#BIDSTable.filter-150"><span class="linenos">150</span></a><span class="sd">            items: Keep rows whose value is in `items`.</span>
</span><span id="BIDSTable.filter-151"><a href="#BIDSTable.filter-151"><span class="linenos">151</span></a><span class="sd">            contains: Keep rows whose value contains `contains` (string only).</span>
</span><span id="BIDSTable.filter-152"><a href="#BIDSTable.filter-152"><span class="linenos">152</span></a><span class="sd">            regex: Keep rows whose value matches `regex` (string only).</span>
</span><span id="BIDSTable.filter-153"><a href="#BIDSTable.filter-153"><span class="linenos">153</span></a><span class="sd">            func: Apply an arbitrary function and keep values that evaluate to `True`.</span>
</span><span id="BIDSTable.filter-154"><a href="#BIDSTable.filter-154"><span class="linenos">154</span></a>
</span><span id="BIDSTable.filter-155"><a href="#BIDSTable.filter-155"><span class="linenos">155</span></a><span class="sd">        Returns:</span>
</span><span id="BIDSTable.filter-156"><a href="#BIDSTable.filter-156"><span class="linenos">156</span></a><span class="sd">            A filtered BIDS table.</span>
</span><span id="BIDSTable.filter-157"><a href="#BIDSTable.filter-157"><span class="linenos">157</span></a>
</span><span id="BIDSTable.filter-158"><a href="#BIDSTable.filter-158"><span class="linenos">158</span></a><span class="sd">        Example::</span>
</span><span id="BIDSTable.filter-159"><a href="#BIDSTable.filter-159"><span class="linenos">159</span></a><span class="sd">            filtered = (</span>
</span><span id="BIDSTable.filter-160"><a href="#BIDSTable.filter-160"><span class="linenos">160</span></a><span class="sd">                tab</span>
</span><span id="BIDSTable.filter-161"><a href="#BIDSTable.filter-161"><span class="linenos">161</span></a><span class="sd">                .filter(&quot;task&quot;, &quot;rest&quot;)</span>
</span><span id="BIDSTable.filter-162"><a href="#BIDSTable.filter-162"><span class="linenos">162</span></a><span class="sd">                .filter(&quot;sub&quot;, items=[&quot;04&quot;, &quot;06&quot;])</span>
</span><span id="BIDSTable.filter-163"><a href="#BIDSTable.filter-163"><span class="linenos">163</span></a><span class="sd">                .filter(&quot;RepetitionTime&quot;, 2.0)</span>
</span><span id="BIDSTable.filter-164"><a href="#BIDSTable.filter-164"><span class="linenos">164</span></a><span class="sd">            )</span>
</span><span id="BIDSTable.filter-165"><a href="#BIDSTable.filter-165"><span class="linenos">165</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="BIDSTable.filter-166"><a href="#BIDSTable.filter-166"><span class="linenos">166</span></a>        <span class="c1"># NOTE: Should be careful about reinventing a new style of query API. There are</span>
</span><span id="BIDSTable.filter-167"><a href="#BIDSTable.filter-167"><span class="linenos">167</span></a>        <span class="c1"># some obvious things this can&#39;t do:</span>
</span><span id="BIDSTable.filter-168"><a href="#BIDSTable.filter-168"><span class="linenos">168</span></a>        <span class="c1">#   - comparison operators &lt;, &gt;, &lt;=, &gt;=</span>
</span><span id="BIDSTable.filter-169"><a href="#BIDSTable.filter-169"><span class="linenos">169</span></a>        <span class="c1">#   - negation</span>
</span><span id="BIDSTable.filter-170"><a href="#BIDSTable.filter-170"><span class="linenos">170</span></a>        <span class="c1">#   - combining filters with &#39;or&#39; instead of &#39;and&#39;</span>
</span><span id="BIDSTable.filter-171"><a href="#BIDSTable.filter-171"><span class="linenos">171</span></a>        <span class="c1"># At the bottom of this rabbit hole are more general query interfaces like those</span>
</span><span id="BIDSTable.filter-172"><a href="#BIDSTable.filter-172"><span class="linenos">172</span></a>        <span class="c1"># already implemented in pandas, duckdb, polars. The goal should be not to</span>
</span><span id="BIDSTable.filter-173"><a href="#BIDSTable.filter-173"><span class="linenos">173</span></a>        <span class="c1"># create a new one, but to make the 95% of use cases as easy as possible, and</span>
</span><span id="BIDSTable.filter-174"><a href="#BIDSTable.filter-174"><span class="linenos">174</span></a>        <span class="c1"># empower users to interact with the underlying table using their more powerful</span>
</span><span id="BIDSTable.filter-175"><a href="#BIDSTable.filter-175"><span class="linenos">175</span></a>        <span class="c1"># tool of choice if necessary.</span>
</span><span id="BIDSTable.filter-176"><a href="#BIDSTable.filter-176"><span class="linenos">176</span></a>        <span class="k">if</span> <span class="nb">sum</span><span class="p">(</span><span class="n">k</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="p">[</span><span class="n">value</span><span class="p">,</span> <span class="n">items</span><span class="p">,</span> <span class="n">contains</span><span class="p">,</span> <span class="n">regex</span><span class="p">,</span> <span class="n">func</span><span class="p">])</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="BIDSTable.filter-177"><a href="#BIDSTable.filter-177"><span class="linenos">177</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
</span><span id="BIDSTable.filter-178"><a href="#BIDSTable.filter-178"><span class="linenos">178</span></a>                <span class="s2">&quot;Exactly one of value, items, contains, regex, or func must not be None&quot;</span>
</span><span id="BIDSTable.filter-179"><a href="#BIDSTable.filter-179"><span class="linenos">179</span></a>            <span class="p">)</span>
</span><span id="BIDSTable.filter-180"><a href="#BIDSTable.filter-180"><span class="linenos">180</span></a>
</span><span id="BIDSTable.filter-181"><a href="#BIDSTable.filter-181"><span class="linenos">181</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="BIDSTable.filter-182"><a href="#BIDSTable.filter-182"><span class="linenos">182</span></a>            <span class="c1"># JSON metadata field</span>
</span><span id="BIDSTable.filter-183"><a href="#BIDSTable.filter-183"><span class="linenos">183</span></a>            <span class="c1"># NOTE: Assuming all JSON metadata fields are uppercase.</span>
</span><span id="BIDSTable.filter-184"><a href="#BIDSTable.filter-184"><span class="linenos">184</span></a>            <span class="k">if</span> <span class="n">key</span><span class="p">[:</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">isupper</span><span class="p">():</span>
</span><span id="BIDSTable.filter-185"><a href="#BIDSTable.filter-185"><span class="linenos">185</span></a>                <span class="n">col</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">flat_meta</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
</span><span id="BIDSTable.filter-186"><a href="#BIDSTable.filter-186"><span class="linenos">186</span></a>            <span class="c1"># Long name entity</span>
</span><span id="BIDSTable.filter-187"><a href="#BIDSTable.filter-187"><span class="linenos">187</span></a>            <span class="k">elif</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">ENTITY_NAMES_TO_KEYS</span><span class="p">:</span>
</span><span id="BIDSTable.filter-188"><a href="#BIDSTable.filter-188"><span class="linenos">188</span></a>                <span class="n">col</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ent</span><span class="p">[</span><span class="n">ENTITY_NAMES_TO_KEYS</span><span class="p">[</span><span class="n">key</span><span class="p">]]</span>
</span><span id="BIDSTable.filter-189"><a href="#BIDSTable.filter-189"><span class="linenos">189</span></a>            <span class="c1"># Any other unprefixed column</span>
</span><span id="BIDSTable.filter-190"><a href="#BIDSTable.filter-190"><span class="linenos">190</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="BIDSTable.filter-191"><a href="#BIDSTable.filter-191"><span class="linenos">191</span></a>                <span class="n">col</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">flat</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
</span><span id="BIDSTable.filter-192"><a href="#BIDSTable.filter-192"><span class="linenos">192</span></a>        <span class="k">except</span> <span class="ne">KeyError</span> <span class="k">as</span> <span class="n">exc</span><span class="p">:</span>
</span><span id="BIDSTable.filter-193"><a href="#BIDSTable.filter-193"><span class="linenos">193</span></a>            <span class="k">raise</span> <span class="ne">KeyError</span><span class="p">(</span>
</span><span id="BIDSTable.filter-194"><a href="#BIDSTable.filter-194"><span class="linenos">194</span></a>                <span class="sa">f</span><span class="s2">&quot;Invalid key </span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s2">; expected a valid BIDS entity or metadata field &quot;</span>
</span><span id="BIDSTable.filter-195"><a href="#BIDSTable.filter-195"><span class="linenos">195</span></a>                <span class="s2">&quot;present in the dataset&quot;</span>
</span><span id="BIDSTable.filter-196"><a href="#BIDSTable.filter-196"><span class="linenos">196</span></a>            <span class="p">)</span> <span class="kn">from</span> <span class="nn">exc</span>
</span><span id="BIDSTable.filter-197"><a href="#BIDSTable.filter-197"><span class="linenos">197</span></a>
</span><span id="BIDSTable.filter-198"><a href="#BIDSTable.filter-198"><span class="linenos">198</span></a>        <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="BIDSTable.filter-199"><a href="#BIDSTable.filter-199"><span class="linenos">199</span></a>            <span class="n">mask</span> <span class="o">=</span> <span class="n">col</span> <span class="o">==</span> <span class="n">value</span>
</span><span id="BIDSTable.filter-200"><a href="#BIDSTable.filter-200"><span class="linenos">200</span></a>        <span class="k">elif</span> <span class="n">items</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="BIDSTable.filter-201"><a href="#BIDSTable.filter-201"><span class="linenos">201</span></a>            <span class="n">mask</span> <span class="o">=</span> <span class="n">col</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">items</span><span class="p">)</span>
</span><span id="BIDSTable.filter-202"><a href="#BIDSTable.filter-202"><span class="linenos">202</span></a>        <span class="k">elif</span> <span class="n">contains</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="BIDSTable.filter-203"><a href="#BIDSTable.filter-203"><span class="linenos">203</span></a>            <span class="n">mask</span> <span class="o">=</span> <span class="n">col</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="n">contains</span><span class="p">)</span>
</span><span id="BIDSTable.filter-204"><a href="#BIDSTable.filter-204"><span class="linenos">204</span></a>        <span class="k">elif</span> <span class="n">regex</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="BIDSTable.filter-205"><a href="#BIDSTable.filter-205"><span class="linenos">205</span></a>            <span class="n">mask</span> <span class="o">=</span> <span class="n">col</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="n">regex</span><span class="p">)</span>
</span><span id="BIDSTable.filter-206"><a href="#BIDSTable.filter-206"><span class="linenos">206</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="BIDSTable.filter-207"><a href="#BIDSTable.filter-207"><span class="linenos">207</span></a>            <span class="n">mask</span> <span class="o">=</span> <span class="n">col</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">func</span><span class="p">)</span>
</span><span id="BIDSTable.filter-208"><a href="#BIDSTable.filter-208"><span class="linenos">208</span></a>        <span class="n">mask</span> <span class="o">=</span> <span class="n">mask</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">bool</span><span class="p">)</span>
</span><span id="BIDSTable.filter-209"><a href="#BIDSTable.filter-209"><span class="linenos">209</span></a>
</span><span id="BIDSTable.filter-210"><a href="#BIDSTable.filter-210"><span class="linenos">210</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">mask</span><span class="p">]</span>
</span></pre></div>


            <div class="docstring"><p>Filter the rows of the table.</p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>key:</strong>  Column to filter. Can be a metadata field, BIDS entity name, or any
unprefixed column label in the <code><a href="#BIDSTable.flat">flat</a></code> table.</li>
<li><strong>value:</strong>  Keep rows with this exact value.</li>
<li><strong>items:</strong>  Keep rows whose value is in <code><a href="#BIDSTable.items">items</a></code>.</li>
<li><strong>contains:</strong>  Keep rows whose value contains <code>contains</code> (string only).</li>
<li><strong>regex:</strong>  Keep rows whose value matches <code>regex</code> (string only).</li>
<li><strong>func:</strong>  Apply an arbitrary function and keep values that evaluate to <code>True</code>.</li>
</ul>

<h6 id="returns">Returns:</h6>

<blockquote>
  <p>A filtered BIDS table.</p>
</blockquote>

<p>Example::
    filtered = (
        tab
        .filter("task", "rest")
        .filter("sub", items=["04", "06"])
        .filter("RepetitionTime", 2.0)
    )</p>
</div>


                            </div>
                            <div id="BIDSTable.filter_multi" class="classattr">
                                        <input id="BIDSTable.filter_multi-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">filter_multi</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="o">**</span><span class="n">filters</span></span><span class="return-annotation">) -> <span class="n"><a href="#BIDSTable">bids2table.BIDSTable</a></span>:</span></span>

                <label class="view-source-button" for="BIDSTable.filter_multi-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#BIDSTable.filter_multi"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="BIDSTable.filter_multi-212"><a href="#BIDSTable.filter_multi-212"><span class="linenos">212</span></a>    <span class="k">def</span> <span class="nf">filter_multi</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">filters</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;BIDSTable&quot;</span><span class="p">:</span>
</span><span id="BIDSTable.filter_multi-213"><a href="#BIDSTable.filter_multi-213"><span class="linenos">213</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="BIDSTable.filter_multi-214"><a href="#BIDSTable.filter_multi-214"><span class="linenos">214</span></a><span class="sd">        Apply multiple filters to the table sequentially.</span>
</span><span id="BIDSTable.filter_multi-215"><a href="#BIDSTable.filter_multi-215"><span class="linenos">215</span></a>
</span><span id="BIDSTable.filter_multi-216"><a href="#BIDSTable.filter_multi-216"><span class="linenos">216</span></a><span class="sd">        Args:</span>
</span><span id="BIDSTable.filter_multi-217"><a href="#BIDSTable.filter_multi-217"><span class="linenos">217</span></a><span class="sd">            filters: A mapping of column labels to queries. Each query can either be</span>
</span><span id="BIDSTable.filter_multi-218"><a href="#BIDSTable.filter_multi-218"><span class="linenos">218</span></a><span class="sd">                a single value for an exact equality check or a `dict` for a more</span>
</span><span id="BIDSTable.filter_multi-219"><a href="#BIDSTable.filter_multi-219"><span class="linenos">219</span></a><span class="sd">                complex query, e.g. `{&quot;items&quot;: [1, 2, 3]}`, that&#39;s passed through to</span>
</span><span id="BIDSTable.filter_multi-220"><a href="#BIDSTable.filter_multi-220"><span class="linenos">220</span></a><span class="sd">                `filter`.</span>
</span><span id="BIDSTable.filter_multi-221"><a href="#BIDSTable.filter_multi-221"><span class="linenos">221</span></a>
</span><span id="BIDSTable.filter_multi-222"><a href="#BIDSTable.filter_multi-222"><span class="linenos">222</span></a><span class="sd">        Returns:</span>
</span><span id="BIDSTable.filter_multi-223"><a href="#BIDSTable.filter_multi-223"><span class="linenos">223</span></a><span class="sd">            A filtered BIDS table.</span>
</span><span id="BIDSTable.filter_multi-224"><a href="#BIDSTable.filter_multi-224"><span class="linenos">224</span></a>
</span><span id="BIDSTable.filter_multi-225"><a href="#BIDSTable.filter_multi-225"><span class="linenos">225</span></a><span class="sd">        Example::</span>
</span><span id="BIDSTable.filter_multi-226"><a href="#BIDSTable.filter_multi-226"><span class="linenos">226</span></a><span class="sd">            filtered = tab.filter_multi(</span>
</span><span id="BIDSTable.filter_multi-227"><a href="#BIDSTable.filter_multi-227"><span class="linenos">227</span></a><span class="sd">                task=&quot;rest&quot;</span>
</span><span id="BIDSTable.filter_multi-228"><a href="#BIDSTable.filter_multi-228"><span class="linenos">228</span></a><span class="sd">                sub={&quot;items&quot;: [&quot;04&quot;, &quot;06&quot;]},</span>
</span><span id="BIDSTable.filter_multi-229"><a href="#BIDSTable.filter_multi-229"><span class="linenos">229</span></a><span class="sd">                RepetitionTime=2.0,</span>
</span><span id="BIDSTable.filter_multi-230"><a href="#BIDSTable.filter_multi-230"><span class="linenos">230</span></a><span class="sd">            )</span>
</span><span id="BIDSTable.filter_multi-231"><a href="#BIDSTable.filter_multi-231"><span class="linenos">231</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="BIDSTable.filter_multi-232"><a href="#BIDSTable.filter_multi-232"><span class="linenos">232</span></a>        <span class="n">tab</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">deep</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="BIDSTable.filter_multi-233"><a href="#BIDSTable.filter_multi-233"><span class="linenos">233</span></a>
</span><span id="BIDSTable.filter_multi-234"><a href="#BIDSTable.filter_multi-234"><span class="linenos">234</span></a>        <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">query</span> <span class="ow">in</span> <span class="n">filters</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="BIDSTable.filter_multi-235"><a href="#BIDSTable.filter_multi-235"><span class="linenos">235</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">query</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
</span><span id="BIDSTable.filter_multi-236"><a href="#BIDSTable.filter_multi-236"><span class="linenos">236</span></a>                <span class="n">query</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="n">query</span><span class="p">}</span>
</span><span id="BIDSTable.filter_multi-237"><a href="#BIDSTable.filter_multi-237"><span class="linenos">237</span></a>            <span class="n">tab</span> <span class="o">=</span> <span class="n">tab</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="o">**</span><span class="n">query</span><span class="p">)</span>
</span><span id="BIDSTable.filter_multi-238"><a href="#BIDSTable.filter_multi-238"><span class="linenos">238</span></a>        <span class="k">return</span> <span class="n">tab</span>
</span></pre></div>


            <div class="docstring"><p>Apply multiple filters to the table sequentially.</p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>filters:</strong>  A mapping of column labels to queries. Each query can either be
a single value for an exact equality check or a <code>dict</code> for a more
complex query, e.g. <code>{"items": [1, 2, 3]}</code>, that's passed through to
<code><a href="#BIDSTable.filter">filter</a></code>.</li>
</ul>

<h6 id="returns">Returns:</h6>

<blockquote>
  <p>A filtered BIDS table.</p>
</blockquote>

<p>Example::
    filtered = tab.filter_multi(
        task="rest"
        sub={"items": ["04", "06"]},
        RepetitionTime=2.0,
    )</p>
</div>


                            </div>
                            <div id="BIDSTable.sort_entities" class="classattr">
                                        <input id="BIDSTable.sort_entities-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">sort_entities</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">by</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span>,</span><span class="param">	<span class="n">inplace</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span></span><span class="return-annotation">) -> <span class="n"><a href="#BIDSTable">bids2table.BIDSTable</a></span>:</span></span>

                <label class="view-source-button" for="BIDSTable.sort_entities-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#BIDSTable.sort_entities"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="BIDSTable.sort_entities-240"><a href="#BIDSTable.sort_entities-240"><span class="linenos">240</span></a>    <span class="k">def</span> <span class="nf">sort_entities</span><span class="p">(</span>
</span><span id="BIDSTable.sort_entities-241"><a href="#BIDSTable.sort_entities-241"><span class="linenos">241</span></a>        <span class="bp">self</span><span class="p">,</span> <span class="n">by</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]],</span> <span class="n">inplace</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="BIDSTable.sort_entities-242"><a href="#BIDSTable.sort_entities-242"><span class="linenos">242</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;BIDSTable&quot;</span><span class="p">:</span>
</span><span id="BIDSTable.sort_entities-243"><a href="#BIDSTable.sort_entities-243"><span class="linenos">243</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="BIDSTable.sort_entities-244"><a href="#BIDSTable.sort_entities-244"><span class="linenos">244</span></a><span class="sd">        Sort the values of the table by entities.</span>
</span><span id="BIDSTable.sort_entities-245"><a href="#BIDSTable.sort_entities-245"><span class="linenos">245</span></a>
</span><span id="BIDSTable.sort_entities-246"><a href="#BIDSTable.sort_entities-246"><span class="linenos">246</span></a><span class="sd">        Args:</span>
</span><span id="BIDSTable.sort_entities-247"><a href="#BIDSTable.sort_entities-247"><span class="linenos">247</span></a><span class="sd">            by: label or list of labels. Can be `&quot;dataset&quot;` or a short or long entity</span>
</span><span id="BIDSTable.sort_entities-248"><a href="#BIDSTable.sort_entities-248"><span class="linenos">248</span></a><span class="sd">                name.</span>
</span><span id="BIDSTable.sort_entities-249"><a href="#BIDSTable.sort_entities-249"><span class="linenos">249</span></a><span class="sd">            inplace: sort the table in place</span>
</span><span id="BIDSTable.sort_entities-250"><a href="#BIDSTable.sort_entities-250"><span class="linenos">250</span></a>
</span><span id="BIDSTable.sort_entities-251"><a href="#BIDSTable.sort_entities-251"><span class="linenos">251</span></a><span class="sd">        Returns:</span>
</span><span id="BIDSTable.sort_entities-252"><a href="#BIDSTable.sort_entities-252"><span class="linenos">252</span></a><span class="sd">            A sorted BIDS table.</span>
</span><span id="BIDSTable.sort_entities-253"><a href="#BIDSTable.sort_entities-253"><span class="linenos">253</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="BIDSTable.sort_entities-254"><a href="#BIDSTable.sort_entities-254"><span class="linenos">254</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">by</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
</span><span id="BIDSTable.sort_entities-255"><a href="#BIDSTable.sort_entities-255"><span class="linenos">255</span></a>            <span class="n">by</span> <span class="o">=</span> <span class="p">[</span><span class="n">by</span><span class="p">]</span>
</span><span id="BIDSTable.sort_entities-256"><a href="#BIDSTable.sort_entities-256"><span class="linenos">256</span></a>
</span><span id="BIDSTable.sort_entities-257"><a href="#BIDSTable.sort_entities-257"><span class="linenos">257</span></a>        <span class="c1"># TODO: what about sorting by other columns, e.g. file_path?</span>
</span><span id="BIDSTable.sort_entities-258"><a href="#BIDSTable.sort_entities-258"><span class="linenos">258</span></a>        <span class="k">def</span> <span class="nf">add_prefix</span><span class="p">(</span><span class="n">k</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
</span><span id="BIDSTable.sort_entities-259"><a href="#BIDSTable.sort_entities-259"><span class="linenos">259</span></a>            <span class="k">if</span> <span class="n">k</span> <span class="o">==</span> <span class="s2">&quot;dataset&quot;</span><span class="p">:</span>
</span><span id="BIDSTable.sort_entities-260"><a href="#BIDSTable.sort_entities-260"><span class="linenos">260</span></a>                <span class="n">k</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;ds__</span><span class="si">{</span><span class="n">k</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="BIDSTable.sort_entities-261"><a href="#BIDSTable.sort_entities-261"><span class="linenos">261</span></a>            <span class="k">elif</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">ENTITY_NAMES_TO_KEYS</span><span class="p">:</span>
</span><span id="BIDSTable.sort_entities-262"><a href="#BIDSTable.sort_entities-262"><span class="linenos">262</span></a>                <span class="n">k</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;ent__</span><span class="si">{</span><span class="n">ENTITY_NAMES_TO_KEYS</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="BIDSTable.sort_entities-263"><a href="#BIDSTable.sort_entities-263"><span class="linenos">263</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="BIDSTable.sort_entities-264"><a href="#BIDSTable.sort_entities-264"><span class="linenos">264</span></a>                <span class="n">k</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;ent__</span><span class="si">{</span><span class="n">k</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="BIDSTable.sort_entities-265"><a href="#BIDSTable.sort_entities-265"><span class="linenos">265</span></a>            <span class="k">return</span> <span class="n">k</span>
</span><span id="BIDSTable.sort_entities-266"><a href="#BIDSTable.sort_entities-266"><span class="linenos">266</span></a>
</span><span id="BIDSTable.sort_entities-267"><a href="#BIDSTable.sort_entities-267"><span class="linenos">267</span></a>        <span class="n">by</span> <span class="o">=</span> <span class="p">[</span><span class="n">add_prefix</span><span class="p">(</span><span class="n">k</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">by</span><span class="p">]</span>
</span><span id="BIDSTable.sort_entities-268"><a href="#BIDSTable.sort_entities-268"><span class="linenos">268</span></a>        <span class="n">out</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="n">inplace</span><span class="p">)</span>
</span><span id="BIDSTable.sort_entities-269"><a href="#BIDSTable.sort_entities-269"><span class="linenos">269</span></a>        <span class="k">if</span> <span class="n">inplace</span><span class="p">:</span>
</span><span id="BIDSTable.sort_entities-270"><a href="#BIDSTable.sort_entities-270"><span class="linenos">270</span></a>            <span class="k">return</span> <span class="bp">self</span>
</span><span id="BIDSTable.sort_entities-271"><a href="#BIDSTable.sort_entities-271"><span class="linenos">271</span></a>        <span class="k">return</span> <span class="n">out</span>
</span></pre></div>


            <div class="docstring"><p>Sort the values of the table by entities.</p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>by:</strong>  label or list of labels. Can be <code>"dataset"</code> or a short or long entity
name.</li>
<li><strong>inplace:</strong>  sort the table in place</li>
</ul>

<h6 id="returns">Returns:</h6>

<blockquote>
  <p>A sorted BIDS table.</p>
</blockquote>
</div>


                            </div>
                            <div id="BIDSTable.from_df" class="classattr">
                                        <input id="BIDSTable.from_df-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator">@classmethod</div>

        <span class="def">def</span>
        <span class="name">from_df</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">cls</span>, </span><span class="param"><span class="n">df</span><span class="p">:</span> <span class="n">pandas</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">frame</span><span class="o">.</span><span class="n">DataFrame</span></span><span class="return-annotation">) -> <span class="n"><a href="#BIDSTable">bids2table.BIDSTable</a></span>:</span></span>

                <label class="view-source-button" for="BIDSTable.from_df-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#BIDSTable.from_df"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="BIDSTable.from_df-273"><a href="#BIDSTable.from_df-273"><span class="linenos">273</span></a>    <span class="nd">@classmethod</span>
</span><span id="BIDSTable.from_df-274"><a href="#BIDSTable.from_df-274"><span class="linenos">274</span></a>    <span class="k">def</span> <span class="nf">from_df</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">df</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;BIDSTable&quot;</span><span class="p">:</span>
</span><span id="BIDSTable.from_df-275"><a href="#BIDSTable.from_df-275"><span class="linenos">275</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="BIDSTable.from_df-276"><a href="#BIDSTable.from_df-276"><span class="linenos">276</span></a><span class="sd">        Create a BIDS table from a pandas `DataFrame` generated by `bids2table`.</span>
</span><span id="BIDSTable.from_df-277"><a href="#BIDSTable.from_df-277"><span class="linenos">277</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="BIDSTable.from_df-278"><a href="#BIDSTable.from_df-278"><span class="linenos">278</span></a>        <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Create a BIDS table from a pandas <code>DataFrame</code> generated by <code><a href="#bids2table">bids2table</a></code>.</p>
</div>


                            </div>
                            <div id="BIDSTable.from_parquet" class="classattr">
                                        <input id="BIDSTable.from_parquet-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator">@classmethod</div>

        <span class="def">def</span>
        <span class="name">from_parquet</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">cls</span>, </span><span class="param"><span class="n">path</span><span class="p">:</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span></span><span class="return-annotation">) -> <span class="n"><a href="#BIDSTable">bids2table.BIDSTable</a></span>:</span></span>

                <label class="view-source-button" for="BIDSTable.from_parquet-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#BIDSTable.from_parquet"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="BIDSTable.from_parquet-280"><a href="#BIDSTable.from_parquet-280"><span class="linenos">280</span></a>    <span class="nd">@classmethod</span>
</span><span id="BIDSTable.from_parquet-281"><a href="#BIDSTable.from_parquet-281"><span class="linenos">281</span></a>    <span class="k">def</span> <span class="nf">from_parquet</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">path</span><span class="p">:</span> <span class="n">Path</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;BIDSTable&quot;</span><span class="p">:</span>
</span><span id="BIDSTable.from_parquet-282"><a href="#BIDSTable.from_parquet-282"><span class="linenos">282</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="BIDSTable.from_parquet-283"><a href="#BIDSTable.from_parquet-283"><span class="linenos">283</span></a><span class="sd">        Read a BIDS table from a Parquet file or dataset directory generated by</span>
</span><span id="BIDSTable.from_parquet-284"><a href="#BIDSTable.from_parquet-284"><span class="linenos">284</span></a><span class="sd">        `bids2table`.</span>
</span><span id="BIDSTable.from_parquet-285"><a href="#BIDSTable.from_parquet-285"><span class="linenos">285</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="BIDSTable.from_parquet-286"><a href="#BIDSTable.from_parquet-286"><span class="linenos">286</span></a>        <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_parquet</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
</span><span id="BIDSTable.from_parquet-287"><a href="#BIDSTable.from_parquet-287"><span class="linenos">287</span></a>        <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">from_df</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Read a BIDS table from a Parquet file or dataset directory generated by
<code><a href="#bids2table">bids2table</a></code>.</p>
</div>


                            </div>
                            <div class="inherited">
                                <h5>Inherited Members</h5>
                                <dl>
                                    <div><dt>pandas.core.frame.DataFrame</dt>
                                <dd id="BIDSTable.__init__" class="function">DataFrame</dd>
                <dd id="BIDSTable.axes" class="variable">axes</dd>
                <dd id="BIDSTable.shape" class="variable">shape</dd>
                <dd id="BIDSTable.to_string" class="function">to_string</dd>
                <dd id="BIDSTable.style" class="variable">style</dd>
                <dd id="BIDSTable.items" class="function">items</dd>
                <dd id="BIDSTable.iterrows" class="function">iterrows</dd>
                <dd id="BIDSTable.itertuples" class="function">itertuples</dd>
                <dd id="BIDSTable.dot" class="function">dot</dd>
                <dd id="BIDSTable.from_dict" class="function">from_dict</dd>
                <dd id="BIDSTable.to_numpy" class="function">to_numpy</dd>
                <dd id="BIDSTable.to_dict" class="function">to_dict</dd>
                <dd id="BIDSTable.to_gbq" class="function">to_gbq</dd>
                <dd id="BIDSTable.from_records" class="function">from_records</dd>
                <dd id="BIDSTable.to_records" class="function">to_records</dd>
                <dd id="BIDSTable.to_stata" class="function">to_stata</dd>
                <dd id="BIDSTable.to_feather" class="function">to_feather</dd>
                <dd id="BIDSTable.to_markdown" class="function">to_markdown</dd>
                <dd id="BIDSTable.to_parquet" class="function">to_parquet</dd>
                <dd id="BIDSTable.to_orc" class="function">to_orc</dd>
                <dd id="BIDSTable.to_html" class="function">to_html</dd>
                <dd id="BIDSTable.to_xml" class="function">to_xml</dd>
                <dd id="BIDSTable.info" class="function">info</dd>
                <dd id="BIDSTable.memory_usage" class="function">memory_usage</dd>
                <dd id="BIDSTable.transpose" class="function">transpose</dd>
                <dd id="BIDSTable.T" class="variable">T</dd>
                <dd id="BIDSTable.isetitem" class="function">isetitem</dd>
                <dd id="BIDSTable.query" class="function">query</dd>
                <dd id="BIDSTable.eval" class="function">eval</dd>
                <dd id="BIDSTable.select_dtypes" class="function">select_dtypes</dd>
                <dd id="BIDSTable.insert" class="function">insert</dd>
                <dd id="BIDSTable.assign" class="function">assign</dd>
                <dd id="BIDSTable.align" class="function">align</dd>
                <dd id="BIDSTable.set_axis" class="function">set_axis</dd>
                <dd id="BIDSTable.reindex" class="function">reindex</dd>
                <dd id="BIDSTable.drop" class="function">drop</dd>
                <dd id="BIDSTable.rename" class="function">rename</dd>
                <dd id="BIDSTable.fillna" class="function">fillna</dd>
                <dd id="BIDSTable.pop" class="function">pop</dd>
                <dd id="BIDSTable.replace" class="function">replace</dd>
                <dd id="BIDSTable.shift" class="function">shift</dd>
                <dd id="BIDSTable.set_index" class="function">set_index</dd>
                <dd id="BIDSTable.reset_index" class="function">reset_index</dd>
                <dd id="BIDSTable.isna" class="function">isna</dd>
                <dd id="BIDSTable.isnull" class="function">isnull</dd>
                <dd id="BIDSTable.notna" class="function">notna</dd>
                <dd id="BIDSTable.notnull" class="function">notnull</dd>
                <dd id="BIDSTable.dropna" class="function">dropna</dd>
                <dd id="BIDSTable.drop_duplicates" class="function">drop_duplicates</dd>
                <dd id="BIDSTable.duplicated" class="function">duplicated</dd>
                <dd id="BIDSTable.sort_values" class="function">sort_values</dd>
                <dd id="BIDSTable.sort_index" class="function">sort_index</dd>
                <dd id="BIDSTable.value_counts" class="function">value_counts</dd>
                <dd id="BIDSTable.nlargest" class="function">nlargest</dd>
                <dd id="BIDSTable.nsmallest" class="function">nsmallest</dd>
                <dd id="BIDSTable.swaplevel" class="function">swaplevel</dd>
                <dd id="BIDSTable.reorder_levels" class="function">reorder_levels</dd>
                <dd id="BIDSTable.compare" class="function">compare</dd>
                <dd id="BIDSTable.combine" class="function">combine</dd>
                <dd id="BIDSTable.combine_first" class="function">combine_first</dd>
                <dd id="BIDSTable.update" class="function">update</dd>
                <dd id="BIDSTable.groupby" class="function">groupby</dd>
                <dd id="BIDSTable.pivot" class="function">pivot</dd>
                <dd id="BIDSTable.pivot_table" class="function">pivot_table</dd>
                <dd id="BIDSTable.stack" class="function">stack</dd>
                <dd id="BIDSTable.explode" class="function">explode</dd>
                <dd id="BIDSTable.unstack" class="function">unstack</dd>
                <dd id="BIDSTable.melt" class="function">melt</dd>
                <dd id="BIDSTable.diff" class="function">diff</dd>
                <dd id="BIDSTable.aggregate" class="function">aggregate</dd>
                <dd id="BIDSTable.agg" class="function">agg</dd>
                <dd id="BIDSTable.any" class="function">any</dd>
                <dd id="BIDSTable.transform" class="function">transform</dd>
                <dd id="BIDSTable.apply" class="function">apply</dd>
                <dd id="BIDSTable.applymap" class="function">applymap</dd>
                <dd id="BIDSTable.join" class="function">join</dd>
                <dd id="BIDSTable.merge" class="function">merge</dd>
                <dd id="BIDSTable.round" class="function">round</dd>
                <dd id="BIDSTable.corr" class="function">corr</dd>
                <dd id="BIDSTable.cov" class="function">cov</dd>
                <dd id="BIDSTable.corrwith" class="function">corrwith</dd>
                <dd id="BIDSTable.count" class="function">count</dd>
                <dd id="BIDSTable.nunique" class="function">nunique</dd>
                <dd id="BIDSTable.idxmin" class="function">idxmin</dd>
                <dd id="BIDSTable.idxmax" class="function">idxmax</dd>
                <dd id="BIDSTable.mode" class="function">mode</dd>
                <dd id="BIDSTable.quantile" class="function">quantile</dd>
                <dd id="BIDSTable.asfreq" class="function">asfreq</dd>
                <dd id="BIDSTable.resample" class="function">resample</dd>
                <dd id="BIDSTable.to_timestamp" class="function">to_timestamp</dd>
                <dd id="BIDSTable.to_period" class="function">to_period</dd>
                <dd id="BIDSTable.isin" class="function">isin</dd>
                <dd id="BIDSTable.index" class="variable">index</dd>
                <dd id="BIDSTable.columns" class="variable">columns</dd>
                <dd id="BIDSTable.plot" class="function">plot</dd>
                <dd id="BIDSTable.hist" class="function">hist</dd>
                <dd id="BIDSTable.boxplot" class="function">boxplot</dd>
                <dd id="BIDSTable.sparse" class="function">sparse</dd>
                <dd id="BIDSTable.values" class="variable">values</dd>
                <dd id="BIDSTable.ffill" class="function">ffill</dd>
                <dd id="BIDSTable.bfill" class="function">bfill</dd>
                <dd id="BIDSTable.clip" class="function">clip</dd>
                <dd id="BIDSTable.interpolate" class="function">interpolate</dd>
                <dd id="BIDSTable.where" class="function">where</dd>
                <dd id="BIDSTable.mask" class="function">mask</dd>
                <dd id="BIDSTable.all" class="function">all</dd>
                <dd id="BIDSTable.cummax" class="function">cummax</dd>
                <dd id="BIDSTable.cummin" class="function">cummin</dd>
                <dd id="BIDSTable.cumsum" class="function">cumsum</dd>
                <dd id="BIDSTable.cumprod" class="function">cumprod</dd>
                <dd id="BIDSTable.sem" class="function">sem</dd>
                <dd id="BIDSTable.var" class="function">var</dd>
                <dd id="BIDSTable.std" class="function">std</dd>
                <dd id="BIDSTable.min" class="function">min</dd>
                <dd id="BIDSTable.max" class="function">max</dd>
                <dd id="BIDSTable.mean" class="function">mean</dd>
                <dd id="BIDSTable.median" class="function">median</dd>
                <dd id="BIDSTable.skew" class="function">skew</dd>
                <dd id="BIDSTable.kurt" class="function">kurt</dd>
                <dd id="BIDSTable.kurtosis" class="function">kurtosis</dd>
                <dd id="BIDSTable.sum" class="function">sum</dd>
                <dd id="BIDSTable.prod" class="function">prod</dd>
                <dd id="BIDSTable.product" class="function">product</dd>
                <dd id="BIDSTable.add" class="function">add</dd>
                <dd id="BIDSTable.radd" class="function">radd</dd>
                <dd id="BIDSTable.sub" class="function">sub</dd>
                <dd id="BIDSTable.mul" class="function">mul</dd>
                <dd id="BIDSTable.truediv" class="function">truediv</dd>
                <dd id="BIDSTable.floordiv" class="function">floordiv</dd>
                <dd id="BIDSTable.mod" class="function">mod</dd>
                <dd id="BIDSTable.pow" class="function">pow</dd>
                <dd id="BIDSTable.rmul" class="function">rmul</dd>
                <dd id="BIDSTable.rsub" class="function">rsub</dd>
                <dd id="BIDSTable.rtruediv" class="function">rtruediv</dd>
                <dd id="BIDSTable.rfloordiv" class="function">rfloordiv</dd>
                <dd id="BIDSTable.rpow" class="function">rpow</dd>
                <dd id="BIDSTable.rmod" class="function">rmod</dd>
                <dd id="BIDSTable.div" class="function">div</dd>
                <dd id="BIDSTable.rdiv" class="function">rdiv</dd>
                <dd id="BIDSTable.eq" class="function">eq</dd>
                <dd id="BIDSTable.ne" class="function">ne</dd>
                <dd id="BIDSTable.lt" class="function">lt</dd>
                <dd id="BIDSTable.gt" class="function">gt</dd>
                <dd id="BIDSTable.le" class="function">le</dd>
                <dd id="BIDSTable.ge" class="function">ge</dd>
                <dd id="BIDSTable.multiply" class="function">multiply</dd>
                <dd id="BIDSTable.subtract" class="function">subtract</dd>
                <dd id="BIDSTable.divide" class="function">divide</dd>

            </div>
            <div><dt>pandas.core.generic.NDFrame</dt>
                                <dd id="BIDSTable.attrs" class="variable">attrs</dd>
                <dd id="BIDSTable.flags" class="variable">flags</dd>
                <dd id="BIDSTable.set_flags" class="function">set_flags</dd>
                <dd id="BIDSTable.ndim" class="variable">ndim</dd>
                <dd id="BIDSTable.size" class="variable">size</dd>
                <dd id="BIDSTable.swapaxes" class="function">swapaxes</dd>
                <dd id="BIDSTable.droplevel" class="function">droplevel</dd>
                <dd id="BIDSTable.squeeze" class="function">squeeze</dd>
                <dd id="BIDSTable.rename_axis" class="function">rename_axis</dd>
                <dd id="BIDSTable.equals" class="function">equals</dd>
                <dd id="BIDSTable.bool" class="function">bool</dd>
                <dd id="BIDSTable.abs" class="function">abs</dd>
                <dd id="BIDSTable.keys" class="function">keys</dd>
                <dd id="BIDSTable.empty" class="variable">empty</dd>
                <dd id="BIDSTable.to_excel" class="function">to_excel</dd>
                <dd id="BIDSTable.to_json" class="function">to_json</dd>
                <dd id="BIDSTable.to_hdf" class="function">to_hdf</dd>
                <dd id="BIDSTable.to_sql" class="function">to_sql</dd>
                <dd id="BIDSTable.to_pickle" class="function">to_pickle</dd>
                <dd id="BIDSTable.to_clipboard" class="function">to_clipboard</dd>
                <dd id="BIDSTable.to_xarray" class="function">to_xarray</dd>
                <dd id="BIDSTable.to_latex" class="function">to_latex</dd>
                <dd id="BIDSTable.to_csv" class="function">to_csv</dd>
                <dd id="BIDSTable.take" class="function">take</dd>
                <dd id="BIDSTable.xs" class="function">xs</dd>
                <dd id="BIDSTable.get" class="function">get</dd>
                <dd id="BIDSTable.reindex_like" class="function">reindex_like</dd>
                <dd id="BIDSTable.add_prefix" class="function">add_prefix</dd>
                <dd id="BIDSTable.add_suffix" class="function">add_suffix</dd>
                <dd id="BIDSTable.head" class="function">head</dd>
                <dd id="BIDSTable.tail" class="function">tail</dd>
                <dd id="BIDSTable.sample" class="function">sample</dd>
                <dd id="BIDSTable.pipe" class="function">pipe</dd>
                <dd id="BIDSTable.dtypes" class="variable">dtypes</dd>
                <dd id="BIDSTable.astype" class="function">astype</dd>
                <dd id="BIDSTable.copy" class="function">copy</dd>
                <dd id="BIDSTable.infer_objects" class="function">infer_objects</dd>
                <dd id="BIDSTable.convert_dtypes" class="function">convert_dtypes</dd>
                <dd id="BIDSTable.pad" class="function">pad</dd>
                <dd id="BIDSTable.backfill" class="function">backfill</dd>
                <dd id="BIDSTable.asof" class="function">asof</dd>
                <dd id="BIDSTable.at_time" class="function">at_time</dd>
                <dd id="BIDSTable.between_time" class="function">between_time</dd>
                <dd id="BIDSTable.first" class="function">first</dd>
                <dd id="BIDSTable.last" class="function">last</dd>
                <dd id="BIDSTable.rank" class="function">rank</dd>
                <dd id="BIDSTable.truncate" class="function">truncate</dd>
                <dd id="BIDSTable.tz_convert" class="function">tz_convert</dd>
                <dd id="BIDSTable.tz_localize" class="function">tz_localize</dd>
                <dd id="BIDSTable.describe" class="function">describe</dd>
                <dd id="BIDSTable.pct_change" class="function">pct_change</dd>
                <dd id="BIDSTable.rolling" class="function">rolling</dd>
                <dd id="BIDSTable.expanding" class="function">expanding</dd>
                <dd id="BIDSTable.ewm" class="function">ewm</dd>
                <dd id="BIDSTable.first_valid_index" class="function">first_valid_index</dd>
                <dd id="BIDSTable.last_valid_index" class="function">last_valid_index</dd>

            </div>
            <div><dt>pandas.core.indexing.IndexingMixin</dt>
                                <dd id="BIDSTable.iloc" class="variable">iloc</dd>
                <dd id="BIDSTable.loc" class="variable">loc</dd>
                <dd id="BIDSTable.at" class="variable">at</dd>
                <dd id="BIDSTable.iat" class="variable">iat</dd>

            </div>
                                </dl>
                            </div>
                </section>
                <section id="BIDSFile">
                            <input id="BIDSFile-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
                    <div class="decorator">@dataclass</div>

    <span class="def">class</span>
    <span class="name">BIDSFile</span>:

                <label class="view-source-button" for="BIDSFile-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#BIDSFile"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="BIDSFile-296"><a href="#BIDSFile-296"><span class="linenos">296</span></a><span class="nd">@dataclass</span>
</span><span id="BIDSFile-297"><a href="#BIDSFile-297"><span class="linenos">297</span></a><span class="k">class</span> <span class="nc">BIDSFile</span><span class="p">:</span>
</span><span id="BIDSFile-298"><a href="#BIDSFile-298"><span class="linenos">298</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="BIDSFile-299"><a href="#BIDSFile-299"><span class="linenos">299</span></a><span class="sd">    A structured BIDS file.</span>
</span><span id="BIDSFile-300"><a href="#BIDSFile-300"><span class="linenos">300</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="BIDSFile-301"><a href="#BIDSFile-301"><span class="linenos">301</span></a>
</span><span id="BIDSFile-302"><a href="#BIDSFile-302"><span class="linenos">302</span></a>    <span class="n">dataset</span><span class="p">:</span> <span class="nb">str</span>
</span><span id="BIDSFile-303"><a href="#BIDSFile-303"><span class="linenos">303</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Parent BIDS dataset.&quot;&quot;&quot;</span>
</span><span id="BIDSFile-304"><a href="#BIDSFile-304"><span class="linenos">304</span></a>    <span class="n">root</span><span class="p">:</span> <span class="n">Path</span>
</span><span id="BIDSFile-305"><a href="#BIDSFile-305"><span class="linenos">305</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Path to parent dataset.&quot;&quot;&quot;</span>
</span><span id="BIDSFile-306"><a href="#BIDSFile-306"><span class="linenos">306</span></a>    <span class="n">path</span><span class="p">:</span> <span class="n">Path</span>
</span><span id="BIDSFile-307"><a href="#BIDSFile-307"><span class="linenos">307</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;File path.&quot;&quot;&quot;</span>
</span><span id="BIDSFile-308"><a href="#BIDSFile-308"><span class="linenos">308</span></a>    <span class="n">entities</span><span class="p">:</span> <span class="n">BIDSEntities</span>
</span><span id="BIDSFile-309"><a href="#BIDSFile-309"><span class="linenos">309</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;BIDS entities.&quot;&quot;&quot;</span>
</span><span id="BIDSFile-310"><a href="#BIDSFile-310"><span class="linenos">310</span></a>    <span class="n">metadata</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="nb">dict</span><span class="p">)</span>
</span><span id="BIDSFile-311"><a href="#BIDSFile-311"><span class="linenos">311</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;BIDS JSON metadata.&quot;&quot;&quot;</span>
</span><span id="BIDSFile-312"><a href="#BIDSFile-312"><span class="linenos">312</span></a>
</span><span id="BIDSFile-313"><a href="#BIDSFile-313"><span class="linenos">313</span></a>    <span class="nd">@property</span>
</span><span id="BIDSFile-314"><a href="#BIDSFile-314"><span class="linenos">314</span></a>    <span class="k">def</span> <span class="nf">relative_path</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Path</span><span class="p">:</span>
</span><span id="BIDSFile-315"><a href="#BIDSFile-315"><span class="linenos">315</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="BIDSFile-316"><a href="#BIDSFile-316"><span class="linenos">316</span></a><span class="sd">        The file path relative to the dataset root.</span>
</span><span id="BIDSFile-317"><a href="#BIDSFile-317"><span class="linenos">317</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="BIDSFile-318"><a href="#BIDSFile-318"><span class="linenos">318</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">relative_to</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>A structured BIDS file.</p>
</div>


                            <div id="BIDSFile.__init__" class="classattr">
                                <div class="attr function">
            
        <span class="name">BIDSFile</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">dataset</span><span class="p">:</span> <span class="nb">str</span>,</span><span class="param">	<span class="n">root</span><span class="p">:</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span>,</span><span class="param">	<span class="n">path</span><span class="p">:</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span>,</span><span class="param">	<span class="n">entities</span><span class="p">:</span> <span class="n"><a href="#BIDSEntities">bids2table.BIDSEntities</a></span>,</span><span class="param">	<span class="n">metadata</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">factory</span><span class="o">&gt;</span></span>)</span>

        
    </div>
    <a class="headerlink" href="#BIDSFile.__init__"></a>
    
    

                            </div>
                            <div id="BIDSFile.dataset" class="classattr">
                                <div class="attr variable">
            <span class="name">dataset</span><span class="annotation">: str</span>

        
    </div>
    <a class="headerlink" href="#BIDSFile.dataset"></a>
    
            <div class="docstring"><p>Parent BIDS dataset.</p>
</div>


                            </div>
                            <div id="BIDSFile.root" class="classattr">
                                <div class="attr variable">
            <span class="name">root</span><span class="annotation">: pathlib.Path</span>

        
    </div>
    <a class="headerlink" href="#BIDSFile.root"></a>
    
            <div class="docstring"><p>Path to parent dataset.</p>
</div>


                            </div>
                            <div id="BIDSFile.path" class="classattr">
                                <div class="attr variable">
            <span class="name">path</span><span class="annotation">: pathlib.Path</span>

        
    </div>
    <a class="headerlink" href="#BIDSFile.path"></a>
    
            <div class="docstring"><p>File path.</p>
</div>


                            </div>
                            <div id="BIDSFile.entities" class="classattr">
                                <div class="attr variable">
            <span class="name">entities</span><span class="annotation">: <a href="#BIDSEntities">bids2table.BIDSEntities</a></span>

        
    </div>
    <a class="headerlink" href="#BIDSFile.entities"></a>
    
            <div class="docstring"><p>BIDS entities.</p>
</div>


                            </div>
                            <div id="BIDSFile.metadata" class="classattr">
                                <div class="attr variable">
            <span class="name">metadata</span><span class="annotation">: Dict[str, Any]</span>

        
    </div>
    <a class="headerlink" href="#BIDSFile.metadata"></a>
    
            <div class="docstring"><p>BIDS JSON metadata.</p>
</div>


                            </div>
                            <div id="BIDSFile.relative_path" class="classattr">
                                <div class="attr variable">
            <span class="name">relative_path</span><span class="annotation">: pathlib.Path</span>

        
    </div>
    <a class="headerlink" href="#BIDSFile.relative_path"></a>
    
            <div class="docstring"><p>The file path relative to the dataset root.</p>
</div>


                            </div>
                </section>
                <section id="BIDSEntities">
                            <input id="BIDSEntities-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
                    <div class="decorator">@dataclass</div>

    <span class="def">class</span>
    <span class="name">BIDSEntities</span>:

                <label class="view-source-button" for="BIDSEntities-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#BIDSEntities"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="BIDSEntities-61"><a href="#BIDSEntities-61"><span class="linenos"> 61</span></a><span class="nd">@dataclass</span>
</span><span id="BIDSEntities-62"><a href="#BIDSEntities-62"><span class="linenos"> 62</span></a><span class="k">class</span> <span class="nc">BIDSEntities</span><span class="p">:</span>
</span><span id="BIDSEntities-63"><a href="#BIDSEntities-63"><span class="linenos"> 63</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="BIDSEntities-64"><a href="#BIDSEntities-64"><span class="linenos"> 64</span></a><span class="sd">    A dataclass representing known BIDS entities.</span>
</span><span id="BIDSEntities-65"><a href="#BIDSEntities-65"><span class="linenos"> 65</span></a>
</span><span id="BIDSEntities-66"><a href="#BIDSEntities-66"><span class="linenos"> 66</span></a><span class="sd">    Note:</span>
</span><span id="BIDSEntities-67"><a href="#BIDSEntities-67"><span class="linenos"> 67</span></a><span class="sd">        Only minimal validation of the entity values is performed. Use `bids_validator`</span>
</span><span id="BIDSEntities-68"><a href="#BIDSEntities-68"><span class="linenos"> 68</span></a><span class="sd">        for thorough validation of BIDS datasets.</span>
</span><span id="BIDSEntities-69"><a href="#BIDSEntities-69"><span class="linenos"> 69</span></a>
</span><span id="BIDSEntities-70"><a href="#BIDSEntities-70"><span class="linenos"> 70</span></a><span class="sd">    Reference:</span>
</span><span id="BIDSEntities-71"><a href="#BIDSEntities-71"><span class="linenos"> 71</span></a><span class="sd">        https://bids-specification.readthedocs.io/en/stable/appendices/entities.html</span>
</span><span id="BIDSEntities-72"><a href="#BIDSEntities-72"><span class="linenos"> 72</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="BIDSEntities-73"><a href="#BIDSEntities-73"><span class="linenos"> 73</span></a>
</span><span id="BIDSEntities-74"><a href="#BIDSEntities-74"><span class="linenos"> 74</span></a>    <span class="n">sub</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">bids_field</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;subject&quot;</span><span class="p">,</span> <span class="n">display_name</span><span class="o">=</span><span class="s2">&quot;Subject&quot;</span><span class="p">,</span> <span class="n">required</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="BIDSEntities-75"><a href="#BIDSEntities-75"><span class="linenos"> 75</span></a>    <span class="n">ses</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">bids_field</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;session&quot;</span><span class="p">,</span> <span class="n">display_name</span><span class="o">=</span><span class="s2">&quot;Session&quot;</span><span class="p">)</span>
</span><span id="BIDSEntities-76"><a href="#BIDSEntities-76"><span class="linenos"> 76</span></a>    <span class="n">sample</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">bids_field</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;sample&quot;</span><span class="p">,</span> <span class="n">display_name</span><span class="o">=</span><span class="s2">&quot;Sample&quot;</span><span class="p">)</span>
</span><span id="BIDSEntities-77"><a href="#BIDSEntities-77"><span class="linenos"> 77</span></a>    <span class="n">task</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">bids_field</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;task&quot;</span><span class="p">,</span> <span class="n">display_name</span><span class="o">=</span><span class="s2">&quot;Task&quot;</span><span class="p">)</span>
</span><span id="BIDSEntities-78"><a href="#BIDSEntities-78"><span class="linenos"> 78</span></a>    <span class="n">acq</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">bids_field</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;acquisition&quot;</span><span class="p">,</span> <span class="n">display_name</span><span class="o">=</span><span class="s2">&quot;Acquisition&quot;</span><span class="p">)</span>
</span><span id="BIDSEntities-79"><a href="#BIDSEntities-79"><span class="linenos"> 79</span></a>    <span class="n">ce</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">bids_field</span><span class="p">(</span>
</span><span id="BIDSEntities-80"><a href="#BIDSEntities-80"><span class="linenos"> 80</span></a>        <span class="n">name</span><span class="o">=</span><span class="s2">&quot;ceagent&quot;</span><span class="p">,</span> <span class="n">display_name</span><span class="o">=</span><span class="s2">&quot;Contrast Enhancing Agent&quot;</span>
</span><span id="BIDSEntities-81"><a href="#BIDSEntities-81"><span class="linenos"> 81</span></a>    <span class="p">)</span>
</span><span id="BIDSEntities-82"><a href="#BIDSEntities-82"><span class="linenos"> 82</span></a>    <span class="n">trc</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">bids_field</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;tracer&quot;</span><span class="p">,</span> <span class="n">display_name</span><span class="o">=</span><span class="s2">&quot;Tracer&quot;</span><span class="p">)</span>
</span><span id="BIDSEntities-83"><a href="#BIDSEntities-83"><span class="linenos"> 83</span></a>    <span class="n">stain</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">bids_field</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;stain&quot;</span><span class="p">,</span> <span class="n">display_name</span><span class="o">=</span><span class="s2">&quot;Stain&quot;</span><span class="p">)</span>
</span><span id="BIDSEntities-84"><a href="#BIDSEntities-84"><span class="linenos"> 84</span></a>    <span class="n">rec</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">bids_field</span><span class="p">(</span>
</span><span id="BIDSEntities-85"><a href="#BIDSEntities-85"><span class="linenos"> 85</span></a>        <span class="n">name</span><span class="o">=</span><span class="s2">&quot;reconstruction&quot;</span><span class="p">,</span> <span class="n">display_name</span><span class="o">=</span><span class="s2">&quot;Reconstruction&quot;</span>
</span><span id="BIDSEntities-86"><a href="#BIDSEntities-86"><span class="linenos"> 86</span></a>    <span class="p">)</span>
</span><span id="BIDSEntities-87"><a href="#BIDSEntities-87"><span class="linenos"> 87</span></a>    <span class="nb">dir</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">bids_field</span><span class="p">(</span>
</span><span id="BIDSEntities-88"><a href="#BIDSEntities-88"><span class="linenos"> 88</span></a>        <span class="n">name</span><span class="o">=</span><span class="s2">&quot;direction&quot;</span><span class="p">,</span> <span class="n">display_name</span><span class="o">=</span><span class="s2">&quot;Phase-Encoding Direction&quot;</span>
</span><span id="BIDSEntities-89"><a href="#BIDSEntities-89"><span class="linenos"> 89</span></a>    <span class="p">)</span>
</span><span id="BIDSEntities-90"><a href="#BIDSEntities-90"><span class="linenos"> 90</span></a>    <span class="n">run</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="n">bids_field</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;run&quot;</span><span class="p">,</span> <span class="n">display_name</span><span class="o">=</span><span class="s2">&quot;Run&quot;</span><span class="p">)</span>
</span><span id="BIDSEntities-91"><a href="#BIDSEntities-91"><span class="linenos"> 91</span></a>    <span class="n">mod</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">bids_field</span><span class="p">(</span>
</span><span id="BIDSEntities-92"><a href="#BIDSEntities-92"><span class="linenos"> 92</span></a>        <span class="n">name</span><span class="o">=</span><span class="s2">&quot;modality&quot;</span><span class="p">,</span> <span class="n">display_name</span><span class="o">=</span><span class="s2">&quot;Corresponding Modality&quot;</span>
</span><span id="BIDSEntities-93"><a href="#BIDSEntities-93"><span class="linenos"> 93</span></a>    <span class="p">)</span>
</span><span id="BIDSEntities-94"><a href="#BIDSEntities-94"><span class="linenos"> 94</span></a>    <span class="n">echo</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="n">bids_field</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;echo&quot;</span><span class="p">,</span> <span class="n">display_name</span><span class="o">=</span><span class="s2">&quot;Echo&quot;</span><span class="p">)</span>
</span><span id="BIDSEntities-95"><a href="#BIDSEntities-95"><span class="linenos"> 95</span></a>    <span class="n">flip</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="n">bids_field</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;flip&quot;</span><span class="p">,</span> <span class="n">display_name</span><span class="o">=</span><span class="s2">&quot;Flip Angle&quot;</span><span class="p">)</span>
</span><span id="BIDSEntities-96"><a href="#BIDSEntities-96"><span class="linenos"> 96</span></a>    <span class="n">inv</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="n">bids_field</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;inversion&quot;</span><span class="p">,</span> <span class="n">display_name</span><span class="o">=</span><span class="s2">&quot;Inversion Time&quot;</span><span class="p">)</span>
</span><span id="BIDSEntities-97"><a href="#BIDSEntities-97"><span class="linenos"> 97</span></a>    <span class="n">mt</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">bids_field</span><span class="p">(</span>
</span><span id="BIDSEntities-98"><a href="#BIDSEntities-98"><span class="linenos"> 98</span></a>        <span class="n">name</span><span class="o">=</span><span class="s2">&quot;mtransfer&quot;</span><span class="p">,</span>
</span><span id="BIDSEntities-99"><a href="#BIDSEntities-99"><span class="linenos"> 99</span></a>        <span class="n">display_name</span><span class="o">=</span><span class="s2">&quot;Magnetization Transfer&quot;</span><span class="p">,</span>
</span><span id="BIDSEntities-100"><a href="#BIDSEntities-100"><span class="linenos">100</span></a>        <span class="n">allowed_values</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;on&quot;</span><span class="p">,</span> <span class="s2">&quot;off&quot;</span><span class="p">},</span>
</span><span id="BIDSEntities-101"><a href="#BIDSEntities-101"><span class="linenos">101</span></a>    <span class="p">)</span>
</span><span id="BIDSEntities-102"><a href="#BIDSEntities-102"><span class="linenos">102</span></a>    <span class="n">part</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">bids_field</span><span class="p">(</span>
</span><span id="BIDSEntities-103"><a href="#BIDSEntities-103"><span class="linenos">103</span></a>        <span class="n">name</span><span class="o">=</span><span class="s2">&quot;part&quot;</span><span class="p">,</span>
</span><span id="BIDSEntities-104"><a href="#BIDSEntities-104"><span class="linenos">104</span></a>        <span class="n">display_name</span><span class="o">=</span><span class="s2">&quot;Part&quot;</span><span class="p">,</span>
</span><span id="BIDSEntities-105"><a href="#BIDSEntities-105"><span class="linenos">105</span></a>        <span class="n">allowed_values</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;mag&quot;</span><span class="p">,</span> <span class="s2">&quot;phase&quot;</span><span class="p">,</span> <span class="s2">&quot;real&quot;</span><span class="p">,</span> <span class="s2">&quot;imag&quot;</span><span class="p">},</span>
</span><span id="BIDSEntities-106"><a href="#BIDSEntities-106"><span class="linenos">106</span></a>    <span class="p">)</span>
</span><span id="BIDSEntities-107"><a href="#BIDSEntities-107"><span class="linenos">107</span></a>    <span class="n">proc</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">bids_field</span><span class="p">(</span>
</span><span id="BIDSEntities-108"><a href="#BIDSEntities-108"><span class="linenos">108</span></a>        <span class="n">name</span><span class="o">=</span><span class="s2">&quot;processing&quot;</span><span class="p">,</span> <span class="n">display_name</span><span class="o">=</span><span class="s2">&quot;Processed (on device)&quot;</span>
</span><span id="BIDSEntities-109"><a href="#BIDSEntities-109"><span class="linenos">109</span></a>    <span class="p">)</span>
</span><span id="BIDSEntities-110"><a href="#BIDSEntities-110"><span class="linenos">110</span></a>    <span class="n">hemi</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">bids_field</span><span class="p">(</span>
</span><span id="BIDSEntities-111"><a href="#BIDSEntities-111"><span class="linenos">111</span></a>        <span class="n">name</span><span class="o">=</span><span class="s2">&quot;hemisphere&quot;</span><span class="p">,</span> <span class="n">display_name</span><span class="o">=</span><span class="s2">&quot;Hemisphere&quot;</span><span class="p">,</span> <span class="n">allowed_values</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;L&quot;</span><span class="p">,</span> <span class="s2">&quot;R&quot;</span><span class="p">}</span>
</span><span id="BIDSEntities-112"><a href="#BIDSEntities-112"><span class="linenos">112</span></a>    <span class="p">)</span>
</span><span id="BIDSEntities-113"><a href="#BIDSEntities-113"><span class="linenos">113</span></a>    <span class="n">space</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">bids_field</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;space&quot;</span><span class="p">,</span> <span class="n">display_name</span><span class="o">=</span><span class="s2">&quot;Space&quot;</span><span class="p">)</span>
</span><span id="BIDSEntities-114"><a href="#BIDSEntities-114"><span class="linenos">114</span></a>    <span class="n">split</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="n">bids_field</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;split&quot;</span><span class="p">,</span> <span class="n">display_name</span><span class="o">=</span><span class="s2">&quot;Split&quot;</span><span class="p">)</span>
</span><span id="BIDSEntities-115"><a href="#BIDSEntities-115"><span class="linenos">115</span></a>    <span class="n">recording</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">bids_field</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;recording&quot;</span><span class="p">,</span> <span class="n">display_name</span><span class="o">=</span><span class="s2">&quot;Recording&quot;</span><span class="p">)</span>
</span><span id="BIDSEntities-116"><a href="#BIDSEntities-116"><span class="linenos">116</span></a>    <span class="n">chunk</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="n">bids_field</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;chunk&quot;</span><span class="p">,</span> <span class="n">display_name</span><span class="o">=</span><span class="s2">&quot;Chunk&quot;</span><span class="p">)</span>
</span><span id="BIDSEntities-117"><a href="#BIDSEntities-117"><span class="linenos">117</span></a>    <span class="n">atlas</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">bids_field</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;atlas&quot;</span><span class="p">,</span> <span class="n">display_name</span><span class="o">=</span><span class="s2">&quot;Atlas&quot;</span><span class="p">)</span>
</span><span id="BIDSEntities-118"><a href="#BIDSEntities-118"><span class="linenos">118</span></a>    <span class="n">res</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">bids_field</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;resolution&quot;</span><span class="p">,</span> <span class="n">display_name</span><span class="o">=</span><span class="s2">&quot;Resolution&quot;</span><span class="p">)</span>
</span><span id="BIDSEntities-119"><a href="#BIDSEntities-119"><span class="linenos">119</span></a>    <span class="n">den</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">bids_field</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;density&quot;</span><span class="p">,</span> <span class="n">display_name</span><span class="o">=</span><span class="s2">&quot;Density&quot;</span><span class="p">)</span>
</span><span id="BIDSEntities-120"><a href="#BIDSEntities-120"><span class="linenos">120</span></a>    <span class="n">label</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">bids_field</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;label&quot;</span><span class="p">,</span> <span class="n">display_name</span><span class="o">=</span><span class="s2">&quot;Label&quot;</span><span class="p">)</span>
</span><span id="BIDSEntities-121"><a href="#BIDSEntities-121"><span class="linenos">121</span></a>    <span class="n">desc</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">bids_field</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;description&quot;</span><span class="p">,</span> <span class="n">display_name</span><span class="o">=</span><span class="s2">&quot;Description&quot;</span><span class="p">)</span>
</span><span id="BIDSEntities-122"><a href="#BIDSEntities-122"><span class="linenos">122</span></a>    <span class="n">datatype</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">bids_field</span><span class="p">(</span>
</span><span id="BIDSEntities-123"><a href="#BIDSEntities-123"><span class="linenos">123</span></a>        <span class="n">name</span><span class="o">=</span><span class="s2">&quot;datatype&quot;</span><span class="p">,</span> <span class="n">display_name</span><span class="o">=</span><span class="s2">&quot;Data type&quot;</span><span class="p">,</span> <span class="n">allowed_values</span><span class="o">=</span><span class="n">BIDS_DATATYPES</span>
</span><span id="BIDSEntities-124"><a href="#BIDSEntities-124"><span class="linenos">124</span></a>    <span class="p">)</span>
</span><span id="BIDSEntities-125"><a href="#BIDSEntities-125"><span class="linenos">125</span></a>    <span class="n">suffix</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">bids_field</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;suffix&quot;</span><span class="p">,</span> <span class="n">display_name</span><span class="o">=</span><span class="s2">&quot;Suffix&quot;</span><span class="p">)</span>
</span><span id="BIDSEntities-126"><a href="#BIDSEntities-126"><span class="linenos">126</span></a>    <span class="n">ext</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">bids_field</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;extension&quot;</span><span class="p">,</span> <span class="n">display_name</span><span class="o">=</span><span class="s2">&quot;Extension&quot;</span><span class="p">)</span>
</span><span id="BIDSEntities-127"><a href="#BIDSEntities-127"><span class="linenos">127</span></a>    <span class="n">extra_entities</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">]]]</span> <span class="o">=</span> <span class="n">bids_field</span><span class="p">(</span>
</span><span id="BIDSEntities-128"><a href="#BIDSEntities-128"><span class="linenos">128</span></a>        <span class="n">name</span><span class="o">=</span><span class="s2">&quot;extra_entities&quot;</span><span class="p">,</span>
</span><span id="BIDSEntities-129"><a href="#BIDSEntities-129"><span class="linenos">129</span></a>        <span class="n">display_name</span><span class="o">=</span><span class="s2">&quot;Extra entities&quot;</span><span class="p">,</span>
</span><span id="BIDSEntities-130"><a href="#BIDSEntities-130"><span class="linenos">130</span></a>        <span class="n">default_factory</span><span class="o">=</span><span class="nb">dict</span><span class="p">,</span>
</span><span id="BIDSEntities-131"><a href="#BIDSEntities-131"><span class="linenos">131</span></a>    <span class="p">)</span>
</span><span id="BIDSEntities-132"><a href="#BIDSEntities-132"><span class="linenos">132</span></a>
</span><span id="BIDSEntities-133"><a href="#BIDSEntities-133"><span class="linenos">133</span></a>    <span class="nd">@staticmethod</span>
</span><span id="BIDSEntities-134"><a href="#BIDSEntities-134"><span class="linenos">134</span></a>    <span class="k">def</span> <span class="nf">special</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
</span><span id="BIDSEntities-135"><a href="#BIDSEntities-135"><span class="linenos">135</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="BIDSEntities-136"><a href="#BIDSEntities-136"><span class="linenos">136</span></a><span class="sd">        Get list of field keys which are not standard entities.</span>
</span><span id="BIDSEntities-137"><a href="#BIDSEntities-137"><span class="linenos">137</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="BIDSEntities-138"><a href="#BIDSEntities-138"><span class="linenos">138</span></a>        <span class="k">return</span> <span class="p">[</span><span class="s2">&quot;datatype&quot;</span><span class="p">,</span> <span class="s2">&quot;suffix&quot;</span><span class="p">,</span> <span class="s2">&quot;ext&quot;</span><span class="p">,</span> <span class="s2">&quot;extra_entities&quot;</span><span class="p">]</span>
</span><span id="BIDSEntities-139"><a href="#BIDSEntities-139"><span class="linenos">139</span></a>
</span><span id="BIDSEntities-140"><a href="#BIDSEntities-140"><span class="linenos">140</span></a>    <span class="nd">@classmethod</span>
</span><span id="BIDSEntities-141"><a href="#BIDSEntities-141"><span class="linenos">141</span></a>    <span class="k">def</span> <span class="nf">from_dict</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">entities</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span> <span class="n">valid_only</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">):</span>
</span><span id="BIDSEntities-142"><a href="#BIDSEntities-142"><span class="linenos">142</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="BIDSEntities-143"><a href="#BIDSEntities-143"><span class="linenos">143</span></a><span class="sd">        Initialize from a dict of entities.</span>
</span><span id="BIDSEntities-144"><a href="#BIDSEntities-144"><span class="linenos">144</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="BIDSEntities-145"><a href="#BIDSEntities-145"><span class="linenos">145</span></a>        <span class="n">filtered</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="BIDSEntities-146"><a href="#BIDSEntities-146"><span class="linenos">146</span></a>        <span class="n">extra_entities</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">]]</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="BIDSEntities-147"><a href="#BIDSEntities-147"><span class="linenos">147</span></a>        <span class="n">fields_map</span> <span class="o">=</span> <span class="p">{</span><span class="n">f</span><span class="o">.</span><span class="n">name</span><span class="p">:</span> <span class="n">f</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">fields</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span> <span class="k">if</span> <span class="n">f</span><span class="o">.</span><span class="n">name</span> <span class="o">!=</span> <span class="s2">&quot;extra_entities&quot;</span><span class="p">}</span>
</span><span id="BIDSEntities-148"><a href="#BIDSEntities-148"><span class="linenos">148</span></a>
</span><span id="BIDSEntities-149"><a href="#BIDSEntities-149"><span class="linenos">149</span></a>        <span class="k">def</span> <span class="nf">add_to_extra</span><span class="p">(</span><span class="n">k</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="n">v</span><span class="p">:</span> <span class="n">Any</span><span class="p">):</span>
</span><span id="BIDSEntities-150"><a href="#BIDSEntities-150"><span class="linenos">150</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
</span><span id="BIDSEntities-151"><a href="#BIDSEntities-151"><span class="linenos">151</span></a>                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
</span><span id="BIDSEntities-152"><a href="#BIDSEntities-152"><span class="linenos">152</span></a>                    <span class="sa">f</span><span class="s2">&quot;Extra entity </span><span class="si">{</span><span class="n">k</span><span class="si">}</span><span class="s2"> has type </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="si">}</span><span class="s2">; only str supported&quot;</span>
</span><span id="BIDSEntities-153"><a href="#BIDSEntities-153"><span class="linenos">153</span></a>                <span class="p">)</span>
</span><span id="BIDSEntities-154"><a href="#BIDSEntities-154"><span class="linenos">154</span></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">)):</span>
</span><span id="BIDSEntities-155"><a href="#BIDSEntities-155"><span class="linenos">155</span></a>                <span class="n">extra_entities</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">v</span>
</span><span id="BIDSEntities-156"><a href="#BIDSEntities-156"><span class="linenos">156</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="BIDSEntities-157"><a href="#BIDSEntities-157"><span class="linenos">157</span></a>                <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
</span><span id="BIDSEntities-158"><a href="#BIDSEntities-158"><span class="linenos">158</span></a>                    <span class="sa">f</span><span class="s2">&quot;Value </span><span class="si">{</span><span class="n">v</span><span class="si">}</span><span class="s2"> for extra entity </span><span class="si">{</span><span class="n">k</span><span class="si">}</span><span class="s2"> has type </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">v</span><span class="p">)</span><span class="si">}</span><span class="s2">; &quot;</span>
</span><span id="BIDSEntities-159"><a href="#BIDSEntities-159"><span class="linenos">159</span></a>                    <span class="sa">f</span><span class="s2">&quot;only str, int supported&quot;</span>
</span><span id="BIDSEntities-160"><a href="#BIDSEntities-160"><span class="linenos">160</span></a>                <span class="p">)</span>
</span><span id="BIDSEntities-161"><a href="#BIDSEntities-161"><span class="linenos">161</span></a>
</span><span id="BIDSEntities-162"><a href="#BIDSEntities-162"><span class="linenos">162</span></a>        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">entities</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="BIDSEntities-163"><a href="#BIDSEntities-163"><span class="linenos">163</span></a>            <span class="k">if</span> <span class="n">pd</span><span class="o">.</span><span class="n">isna</span><span class="p">(</span><span class="n">val</span><span class="p">):</span>
</span><span id="BIDSEntities-164"><a href="#BIDSEntities-164"><span class="linenos">164</span></a>                <span class="k">continue</span>
</span><span id="BIDSEntities-165"><a href="#BIDSEntities-165"><span class="linenos">165</span></a>
</span><span id="BIDSEntities-166"><a href="#BIDSEntities-166"><span class="linenos">166</span></a>            <span class="k">if</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">fields_map</span><span class="p">:</span>
</span><span id="BIDSEntities-167"><a href="#BIDSEntities-167"><span class="linenos">167</span></a>                <span class="n">fld</span> <span class="o">=</span> <span class="n">fields_map</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
</span><span id="BIDSEntities-168"><a href="#BIDSEntities-168"><span class="linenos">168</span></a>                <span class="n">typ</span> <span class="o">=</span> <span class="n">_get_type</span><span class="p">(</span><span class="n">fld</span><span class="o">.</span><span class="n">type</span><span class="p">)</span>
</span><span id="BIDSEntities-169"><a href="#BIDSEntities-169"><span class="linenos">169</span></a>                <span class="k">try</span><span class="p">:</span>
</span><span id="BIDSEntities-170"><a href="#BIDSEntities-170"><span class="linenos">170</span></a>                    <span class="n">val</span> <span class="o">=</span> <span class="n">typ</span><span class="p">(</span><span class="n">val</span><span class="p">)</span>
</span><span id="BIDSEntities-171"><a href="#BIDSEntities-171"><span class="linenos">171</span></a>                <span class="k">except</span> <span class="ne">ValueError</span> <span class="k">as</span> <span class="n">exc</span><span class="p">:</span>
</span><span id="BIDSEntities-172"><a href="#BIDSEntities-172"><span class="linenos">172</span></a>                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
</span><span id="BIDSEntities-173"><a href="#BIDSEntities-173"><span class="linenos">173</span></a>                        <span class="sa">f</span><span class="s2">&quot;Unable to coerce </span><span class="si">{</span><span class="nb">repr</span><span class="p">(</span><span class="n">val</span><span class="p">)</span><span class="si">}</span><span class="s2"> to type </span><span class="si">{</span><span class="n">typ</span><span class="si">}</span><span class="s2"> for &quot;</span>
</span><span id="BIDSEntities-174"><a href="#BIDSEntities-174"><span class="linenos">174</span></a>                        <span class="sa">f</span><span class="s2">&quot;entity </span><span class="si">{</span><span class="n">fld</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="BIDSEntities-175"><a href="#BIDSEntities-175"><span class="linenos">175</span></a>                    <span class="p">)</span> <span class="kn">from</span> <span class="nn">exc</span>
</span><span id="BIDSEntities-176"><a href="#BIDSEntities-176"><span class="linenos">176</span></a>
</span><span id="BIDSEntities-177"><a href="#BIDSEntities-177"><span class="linenos">177</span></a>                <span class="n">allowed_values</span> <span class="o">=</span> <span class="n">fld</span><span class="o">.</span><span class="n">metadata</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;allowed_values&quot;</span><span class="p">)</span>
</span><span id="BIDSEntities-178"><a href="#BIDSEntities-178"><span class="linenos">178</span></a>                <span class="k">if</span> <span class="n">allowed_values</span> <span class="ow">and</span> <span class="n">val</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">allowed_values</span><span class="p">:</span>
</span><span id="BIDSEntities-179"><a href="#BIDSEntities-179"><span class="linenos">179</span></a>                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
</span><span id="BIDSEntities-180"><a href="#BIDSEntities-180"><span class="linenos">180</span></a>                        <span class="sa">f</span><span class="s2">&quot;Value </span><span class="si">{</span><span class="n">val</span><span class="si">}</span><span class="s2"> for entity </span><span class="si">{</span><span class="n">fld</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2"> isn&#39;t one of the &quot;</span>
</span><span id="BIDSEntities-181"><a href="#BIDSEntities-181"><span class="linenos">181</span></a>                        <span class="sa">f</span><span class="s2">&quot;allowed values </span><span class="si">{</span><span class="n">allowed_values</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="BIDSEntities-182"><a href="#BIDSEntities-182"><span class="linenos">182</span></a>                    <span class="p">)</span>
</span><span id="BIDSEntities-183"><a href="#BIDSEntities-183"><span class="linenos">183</span></a>
</span><span id="BIDSEntities-184"><a href="#BIDSEntities-184"><span class="linenos">184</span></a>                <span class="n">filtered</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">val</span>
</span><span id="BIDSEntities-185"><a href="#BIDSEntities-185"><span class="linenos">185</span></a>
</span><span id="BIDSEntities-186"><a href="#BIDSEntities-186"><span class="linenos">186</span></a>            <span class="c1"># Special handling if the dict already contains &#39;extra_entities&#39;. This makes</span>
</span><span id="BIDSEntities-187"><a href="#BIDSEntities-187"><span class="linenos">187</span></a>            <span class="c1"># it easy to reconstruct entities from a df row.</span>
</span><span id="BIDSEntities-188"><a href="#BIDSEntities-188"><span class="linenos">188</span></a>            <span class="k">elif</span> <span class="n">key</span> <span class="o">==</span> <span class="s2">&quot;extra_entities&quot;</span><span class="p">:</span>
</span><span id="BIDSEntities-189"><a href="#BIDSEntities-189"><span class="linenos">189</span></a>                <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span>
</span><span id="BIDSEntities-190"><a href="#BIDSEntities-190"><span class="linenos">190</span></a>                    <span class="n">val</span><span class="p">,</span> <span class="nb">dict</span>
</span><span id="BIDSEntities-191"><a href="#BIDSEntities-191"><span class="linenos">191</span></a>                <span class="p">),</span> <span class="s2">&quot;Value for &#39;extra_entities&#39; key must be a dict&quot;</span>
</span><span id="BIDSEntities-192"><a href="#BIDSEntities-192"><span class="linenos">192</span></a>                <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">val</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="BIDSEntities-193"><a href="#BIDSEntities-193"><span class="linenos">193</span></a>                    <span class="n">add_to_extra</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span>
</span><span id="BIDSEntities-194"><a href="#BIDSEntities-194"><span class="linenos">194</span></a>
</span><span id="BIDSEntities-195"><a href="#BIDSEntities-195"><span class="linenos">195</span></a>            <span class="k">elif</span> <span class="ow">not</span> <span class="n">valid_only</span><span class="p">:</span>
</span><span id="BIDSEntities-196"><a href="#BIDSEntities-196"><span class="linenos">196</span></a>                <span class="n">add_to_extra</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">val</span><span class="p">)</span>
</span><span id="BIDSEntities-197"><a href="#BIDSEntities-197"><span class="linenos">197</span></a>
</span><span id="BIDSEntities-198"><a href="#BIDSEntities-198"><span class="linenos">198</span></a>        <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="o">**</span><span class="n">filtered</span><span class="p">,</span> <span class="n">extra_entities</span><span class="o">=</span><span class="n">extra_entities</span><span class="p">)</span>
</span><span id="BIDSEntities-199"><a href="#BIDSEntities-199"><span class="linenos">199</span></a>
</span><span id="BIDSEntities-200"><a href="#BIDSEntities-200"><span class="linenos">200</span></a>    <span class="nd">@classmethod</span>
</span><span id="BIDSEntities-201"><a href="#BIDSEntities-201"><span class="linenos">201</span></a>    <span class="k">def</span> <span class="nf">from_path</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">path</span><span class="p">:</span> <span class="n">StrOrPath</span><span class="p">):</span>
</span><span id="BIDSEntities-202"><a href="#BIDSEntities-202"><span class="linenos">202</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="BIDSEntities-203"><a href="#BIDSEntities-203"><span class="linenos">203</span></a><span class="sd">        Initialize from a file path.</span>
</span><span id="BIDSEntities-204"><a href="#BIDSEntities-204"><span class="linenos">204</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="BIDSEntities-205"><a href="#BIDSEntities-205"><span class="linenos">205</span></a>        <span class="n">entities</span> <span class="o">=</span> <span class="n">parse_bids_entities</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
</span><span id="BIDSEntities-206"><a href="#BIDSEntities-206"><span class="linenos">206</span></a>        <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span><span class="n">entities</span><span class="p">)</span>
</span><span id="BIDSEntities-207"><a href="#BIDSEntities-207"><span class="linenos">207</span></a>
</span><span id="BIDSEntities-208"><a href="#BIDSEntities-208"><span class="linenos">208</span></a>    <span class="k">def</span> <span class="nf">to_dict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">valid_only</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
</span><span id="BIDSEntities-209"><a href="#BIDSEntities-209"><span class="linenos">209</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="BIDSEntities-210"><a href="#BIDSEntities-210"><span class="linenos">210</span></a><span class="sd">        Convert entities to a plain dict.</span>
</span><span id="BIDSEntities-211"><a href="#BIDSEntities-211"><span class="linenos">211</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="BIDSEntities-212"><a href="#BIDSEntities-212"><span class="linenos">212</span></a>        <span class="n">data</span> <span class="o">=</span> <span class="n">asdict</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</span><span id="BIDSEntities-213"><a href="#BIDSEntities-213"><span class="linenos">213</span></a>        <span class="n">extra</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;extra_entities&quot;</span><span class="p">)</span>
</span><span id="BIDSEntities-214"><a href="#BIDSEntities-214"><span class="linenos">214</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">valid_only</span> <span class="ow">and</span> <span class="n">extra</span><span class="p">:</span>
</span><span id="BIDSEntities-215"><a href="#BIDSEntities-215"><span class="linenos">215</span></a>            <span class="n">data</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">extra</span><span class="p">)</span>
</span><span id="BIDSEntities-216"><a href="#BIDSEntities-216"><span class="linenos">216</span></a>        <span class="k">return</span> <span class="n">data</span>
</span><span id="BIDSEntities-217"><a href="#BIDSEntities-217"><span class="linenos">217</span></a>
</span><span id="BIDSEntities-218"><a href="#BIDSEntities-218"><span class="linenos">218</span></a>    <span class="k">def</span> <span class="nf">to_path</span><span class="p">(</span>
</span><span id="BIDSEntities-219"><a href="#BIDSEntities-219"><span class="linenos">219</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="BIDSEntities-220"><a href="#BIDSEntities-220"><span class="linenos">220</span></a>        <span class="n">prefix</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">StrOrPath</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="BIDSEntities-221"><a href="#BIDSEntities-221"><span class="linenos">221</span></a>        <span class="n">valid_only</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="BIDSEntities-222"><a href="#BIDSEntities-222"><span class="linenos">222</span></a>        <span class="n">int_format</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%d</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="BIDSEntities-223"><a href="#BIDSEntities-223"><span class="linenos">223</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Path</span><span class="p">:</span>
</span><span id="BIDSEntities-224"><a href="#BIDSEntities-224"><span class="linenos">224</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="BIDSEntities-225"><a href="#BIDSEntities-225"><span class="linenos">225</span></a><span class="sd">        Generate a filepath based on the entitities.</span>
</span><span id="BIDSEntities-226"><a href="#BIDSEntities-226"><span class="linenos">226</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="BIDSEntities-227"><a href="#BIDSEntities-227"><span class="linenos">227</span></a>        <span class="n">special</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;datatype&quot;</span><span class="p">,</span> <span class="s2">&quot;suffix&quot;</span><span class="p">,</span> <span class="s2">&quot;ext&quot;</span><span class="p">}</span>
</span><span id="BIDSEntities-228"><a href="#BIDSEntities-228"><span class="linenos">228</span></a>        <span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">to_dict</span><span class="p">(</span><span class="n">valid_only</span><span class="o">=</span><span class="n">valid_only</span><span class="p">)</span>
</span><span id="BIDSEntities-229"><a href="#BIDSEntities-229"><span class="linenos">229</span></a>
</span><span id="BIDSEntities-230"><a href="#BIDSEntities-230"><span class="linenos">230</span></a>        <span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;_&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
</span><span id="BIDSEntities-231"><a href="#BIDSEntities-231"><span class="linenos">231</span></a>            <span class="n">_fmt_ent</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">int_format</span><span class="o">=</span><span class="n">int_format</span><span class="p">)</span>
</span><span id="BIDSEntities-232"><a href="#BIDSEntities-232"><span class="linenos">232</span></a>            <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
</span><span id="BIDSEntities-233"><a href="#BIDSEntities-233"><span class="linenos">233</span></a>            <span class="k">if</span> <span class="n">k</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">special</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">pd</span><span class="o">.</span><span class="n">isna</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
</span><span id="BIDSEntities-234"><a href="#BIDSEntities-234"><span class="linenos">234</span></a>        <span class="p">)</span>
</span><span id="BIDSEntities-235"><a href="#BIDSEntities-235"><span class="linenos">235</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">suffix</span><span class="p">:</span>
</span><span id="BIDSEntities-236"><a href="#BIDSEntities-236"><span class="linenos">236</span></a>            <span class="n">name</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;_</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">suffix</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="BIDSEntities-237"><a href="#BIDSEntities-237"><span class="linenos">237</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ext</span><span class="p">:</span>
</span><span id="BIDSEntities-238"><a href="#BIDSEntities-238"><span class="linenos">238</span></a>            <span class="n">name</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ext</span>
</span><span id="BIDSEntities-239"><a href="#BIDSEntities-239"><span class="linenos">239</span></a>
</span><span id="BIDSEntities-240"><a href="#BIDSEntities-240"><span class="linenos">240</span></a>        <span class="n">path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
</span><span id="BIDSEntities-241"><a href="#BIDSEntities-241"><span class="linenos">241</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">datatype</span><span class="p">:</span>
</span><span id="BIDSEntities-242"><a href="#BIDSEntities-242"><span class="linenos">242</span></a>            <span class="n">path</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">datatype</span> <span class="o">/</span> <span class="n">path</span>
</span><span id="BIDSEntities-243"><a href="#BIDSEntities-243"><span class="linenos">243</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ses</span><span class="p">:</span>
</span><span id="BIDSEntities-244"><a href="#BIDSEntities-244"><span class="linenos">244</span></a>            <span class="n">path</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;ses-</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">ses</span><span class="si">}</span><span class="s2">&quot;</span> <span class="o">/</span> <span class="n">path</span>
</span><span id="BIDSEntities-245"><a href="#BIDSEntities-245"><span class="linenos">245</span></a>        <span class="n">path</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;sub-</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">sub</span><span class="si">}</span><span class="s2">&quot;</span> <span class="o">/</span> <span class="n">path</span>
</span><span id="BIDSEntities-246"><a href="#BIDSEntities-246"><span class="linenos">246</span></a>        <span class="k">if</span> <span class="n">prefix</span><span class="p">:</span>
</span><span id="BIDSEntities-247"><a href="#BIDSEntities-247"><span class="linenos">247</span></a>            <span class="n">path</span> <span class="o">=</span> <span class="n">prefix</span> <span class="o">/</span> <span class="n">path</span>
</span><span id="BIDSEntities-248"><a href="#BIDSEntities-248"><span class="linenos">248</span></a>        <span class="k">return</span> <span class="n">path</span>
</span><span id="BIDSEntities-249"><a href="#BIDSEntities-249"><span class="linenos">249</span></a>
</span><span id="BIDSEntities-250"><a href="#BIDSEntities-250"><span class="linenos">250</span></a>    <span class="k">def</span> <span class="nf">with_update</span><span class="p">(</span>
</span><span id="BIDSEntities-251"><a href="#BIDSEntities-251"><span class="linenos">251</span></a>        <span class="bp">self</span><span class="p">,</span> <span class="n">entitities</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
</span><span id="BIDSEntities-252"><a href="#BIDSEntities-252"><span class="linenos">252</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;BIDSEntities&quot;</span><span class="p">:</span>
</span><span id="BIDSEntities-253"><a href="#BIDSEntities-253"><span class="linenos">253</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="BIDSEntities-254"><a href="#BIDSEntities-254"><span class="linenos">254</span></a><span class="sd">        Create a new instance with updated entities.</span>
</span><span id="BIDSEntities-255"><a href="#BIDSEntities-255"><span class="linenos">255</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="BIDSEntities-256"><a href="#BIDSEntities-256"><span class="linenos">256</span></a>        <span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">to_dict</span><span class="p">(</span><span class="n">valid_only</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="BIDSEntities-257"><a href="#BIDSEntities-257"><span class="linenos">257</span></a>        <span class="k">if</span> <span class="n">entitities</span><span class="p">:</span>
</span><span id="BIDSEntities-258"><a href="#BIDSEntities-258"><span class="linenos">258</span></a>            <span class="n">data</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">entitities</span><span class="p">)</span>
</span><span id="BIDSEntities-259"><a href="#BIDSEntities-259"><span class="linenos">259</span></a>        <span class="k">if</span> <span class="n">kwargs</span><span class="p">:</span>
</span><span id="BIDSEntities-260"><a href="#BIDSEntities-260"><span class="linenos">260</span></a>            <span class="n">data</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="BIDSEntities-261"><a href="#BIDSEntities-261"><span class="linenos">261</span></a>        <span class="k">return</span> <span class="n">BIDSEntities</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>A dataclass representing known BIDS entities.</p>

<h6 id="note">Note:</h6>

<blockquote>
  <p>Only minimal validation of the entity values is performed. Use <code>bids_validator</code>
  for thorough validation of BIDS datasets.</p>
</blockquote>

<h6 id="reference">Reference:</h6>

<blockquote>
  <p><a href="https://bids-specification.readthedocs.io/en/stable/appendices/entities.html">https://bids-specification.readthedocs.io/en/stable/appendices/entities.html</a></p>
</blockquote>
</div>


                            <div id="BIDSEntities.__init__" class="classattr">
                                <div class="attr function">
            
        <span class="name">BIDSEntities</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">sub</span><span class="p">:</span> <span class="nb">str</span>,</span><span class="param">	<span class="n">ses</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">sample</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">task</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">acq</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">ce</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">trc</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">stain</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">rec</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="nb">dir</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">run</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">mod</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">echo</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">flip</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">inv</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">mt</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">part</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">proc</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">hemi</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">space</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">split</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">recording</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">chunk</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">atlas</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">res</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">den</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">label</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">desc</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">datatype</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">suffix</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">ext</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">extra_entities</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">]]]</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">factory</span><span class="o">&gt;</span></span>)</span>

        
    </div>
    <a class="headerlink" href="#BIDSEntities.__init__"></a>
    
    

                            </div>
                            <div id="BIDSEntities.sub" class="classattr">
                                <div class="attr variable">
            <span class="name">sub</span><span class="annotation">: str</span>

        
    </div>
    <a class="headerlink" href="#BIDSEntities.sub"></a>
    
    

                            </div>
                            <div id="BIDSEntities.ses" class="classattr">
                                <div class="attr variable">
            <span class="name">ses</span><span class="annotation">: Optional[str]</span>        =
<span class="default_value">None</span>

        
    </div>
    <a class="headerlink" href="#BIDSEntities.ses"></a>
    
    

                            </div>
                            <div id="BIDSEntities.sample" class="classattr">
                                <div class="attr variable">
            <span class="name">sample</span><span class="annotation">: Optional[str]</span>        =
<span class="default_value">None</span>

        
    </div>
    <a class="headerlink" href="#BIDSEntities.sample"></a>
    
    

                            </div>
                            <div id="BIDSEntities.task" class="classattr">
                                <div class="attr variable">
            <span class="name">task</span><span class="annotation">: Optional[str]</span>        =
<span class="default_value">None</span>

        
    </div>
    <a class="headerlink" href="#BIDSEntities.task"></a>
    
    

                            </div>
                            <div id="BIDSEntities.acq" class="classattr">
                                <div class="attr variable">
            <span class="name">acq</span><span class="annotation">: Optional[str]</span>        =
<span class="default_value">None</span>

        
    </div>
    <a class="headerlink" href="#BIDSEntities.acq"></a>
    
    

                            </div>
                            <div id="BIDSEntities.ce" class="classattr">
                                <div class="attr variable">
            <span class="name">ce</span><span class="annotation">: Optional[str]</span>        =
<span class="default_value">None</span>

        
    </div>
    <a class="headerlink" href="#BIDSEntities.ce"></a>
    
    

                            </div>
                            <div id="BIDSEntities.trc" class="classattr">
                                <div class="attr variable">
            <span class="name">trc</span><span class="annotation">: Optional[str]</span>        =
<span class="default_value">None</span>

        
    </div>
    <a class="headerlink" href="#BIDSEntities.trc"></a>
    
    

                            </div>
                            <div id="BIDSEntities.stain" class="classattr">
                                <div class="attr variable">
            <span class="name">stain</span><span class="annotation">: Optional[str]</span>        =
<span class="default_value">None</span>

        
    </div>
    <a class="headerlink" href="#BIDSEntities.stain"></a>
    
    

                            </div>
                            <div id="BIDSEntities.rec" class="classattr">
                                <div class="attr variable">
            <span class="name">rec</span><span class="annotation">: Optional[str]</span>        =
<span class="default_value">None</span>

        
    </div>
    <a class="headerlink" href="#BIDSEntities.rec"></a>
    
    

                            </div>
                            <div id="BIDSEntities.dir" class="classattr">
                                <div class="attr variable">
            <span class="name">dir</span><span class="annotation">: Optional[str]</span>        =
<span class="default_value">None</span>

        
    </div>
    <a class="headerlink" href="#BIDSEntities.dir"></a>
    
    

                            </div>
                            <div id="BIDSEntities.run" class="classattr">
                                <div class="attr variable">
            <span class="name">run</span><span class="annotation">: Optional[int]</span>        =
<span class="default_value">None</span>

        
    </div>
    <a class="headerlink" href="#BIDSEntities.run"></a>
    
    

                            </div>
                            <div id="BIDSEntities.mod" class="classattr">
                                <div class="attr variable">
            <span class="name">mod</span><span class="annotation">: Optional[str]</span>        =
<span class="default_value">None</span>

        
    </div>
    <a class="headerlink" href="#BIDSEntities.mod"></a>
    
    

                            </div>
                            <div id="BIDSEntities.echo" class="classattr">
                                <div class="attr variable">
            <span class="name">echo</span><span class="annotation">: Optional[int]</span>        =
<span class="default_value">None</span>

        
    </div>
    <a class="headerlink" href="#BIDSEntities.echo"></a>
    
    

                            </div>
                            <div id="BIDSEntities.flip" class="classattr">
                                <div class="attr variable">
            <span class="name">flip</span><span class="annotation">: Optional[int]</span>        =
<span class="default_value">None</span>

        
    </div>
    <a class="headerlink" href="#BIDSEntities.flip"></a>
    
    

                            </div>
                            <div id="BIDSEntities.inv" class="classattr">
                                <div class="attr variable">
            <span class="name">inv</span><span class="annotation">: Optional[int]</span>        =
<span class="default_value">None</span>

        
    </div>
    <a class="headerlink" href="#BIDSEntities.inv"></a>
    
    

                            </div>
                            <div id="BIDSEntities.mt" class="classattr">
                                <div class="attr variable">
            <span class="name">mt</span><span class="annotation">: Optional[str]</span>        =
<span class="default_value">None</span>

        
    </div>
    <a class="headerlink" href="#BIDSEntities.mt"></a>
    
    

                            </div>
                            <div id="BIDSEntities.part" class="classattr">
                                <div class="attr variable">
            <span class="name">part</span><span class="annotation">: Optional[str]</span>        =
<span class="default_value">None</span>

        
    </div>
    <a class="headerlink" href="#BIDSEntities.part"></a>
    
    

                            </div>
                            <div id="BIDSEntities.proc" class="classattr">
                                <div class="attr variable">
            <span class="name">proc</span><span class="annotation">: Optional[str]</span>        =
<span class="default_value">None</span>

        
    </div>
    <a class="headerlink" href="#BIDSEntities.proc"></a>
    
    

                            </div>
                            <div id="BIDSEntities.hemi" class="classattr">
                                <div class="attr variable">
            <span class="name">hemi</span><span class="annotation">: Optional[str]</span>        =
<span class="default_value">None</span>

        
    </div>
    <a class="headerlink" href="#BIDSEntities.hemi"></a>
    
    

                            </div>
                            <div id="BIDSEntities.space" class="classattr">
                                <div class="attr variable">
            <span class="name">space</span><span class="annotation">: Optional[str]</span>        =
<span class="default_value">None</span>

        
    </div>
    <a class="headerlink" href="#BIDSEntities.space"></a>
    
    

                            </div>
                            <div id="BIDSEntities.split" class="classattr">
                                <div class="attr variable">
            <span class="name">split</span><span class="annotation">: Optional[int]</span>        =
<span class="default_value">None</span>

        
    </div>
    <a class="headerlink" href="#BIDSEntities.split"></a>
    
    

                            </div>
                            <div id="BIDSEntities.recording" class="classattr">
                                <div class="attr variable">
            <span class="name">recording</span><span class="annotation">: Optional[str]</span>        =
<span class="default_value">None</span>

        
    </div>
    <a class="headerlink" href="#BIDSEntities.recording"></a>
    
    

                            </div>
                            <div id="BIDSEntities.chunk" class="classattr">
                                <div class="attr variable">
            <span class="name">chunk</span><span class="annotation">: Optional[int]</span>        =
<span class="default_value">None</span>

        
    </div>
    <a class="headerlink" href="#BIDSEntities.chunk"></a>
    
    

                            </div>
                            <div id="BIDSEntities.atlas" class="classattr">
                                <div class="attr variable">
            <span class="name">atlas</span><span class="annotation">: Optional[str]</span>        =
<span class="default_value">None</span>

        
    </div>
    <a class="headerlink" href="#BIDSEntities.atlas"></a>
    
    

                            </div>
                            <div id="BIDSEntities.res" class="classattr">
                                <div class="attr variable">
            <span class="name">res</span><span class="annotation">: Optional[str]</span>        =
<span class="default_value">None</span>

        
    </div>
    <a class="headerlink" href="#BIDSEntities.res"></a>
    
    

                            </div>
                            <div id="BIDSEntities.den" class="classattr">
                                <div class="attr variable">
            <span class="name">den</span><span class="annotation">: Optional[str]</span>        =
<span class="default_value">None</span>

        
    </div>
    <a class="headerlink" href="#BIDSEntities.den"></a>
    
    

                            </div>
                            <div id="BIDSEntities.label" class="classattr">
                                <div class="attr variable">
            <span class="name">label</span><span class="annotation">: Optional[str]</span>        =
<span class="default_value">None</span>

        
    </div>
    <a class="headerlink" href="#BIDSEntities.label"></a>
    
    

                            </div>
                            <div id="BIDSEntities.desc" class="classattr">
                                <div class="attr variable">
            <span class="name">desc</span><span class="annotation">: Optional[str]</span>        =
<span class="default_value">None</span>

        
    </div>
    <a class="headerlink" href="#BIDSEntities.desc"></a>
    
    

                            </div>
                            <div id="BIDSEntities.datatype" class="classattr">
                                <div class="attr variable">
            <span class="name">datatype</span><span class="annotation">: Optional[str]</span>        =
<span class="default_value">None</span>

        
    </div>
    <a class="headerlink" href="#BIDSEntities.datatype"></a>
    
    

                            </div>
                            <div id="BIDSEntities.suffix" class="classattr">
                                <div class="attr variable">
            <span class="name">suffix</span><span class="annotation">: Optional[str]</span>        =
<span class="default_value">None</span>

        
    </div>
    <a class="headerlink" href="#BIDSEntities.suffix"></a>
    
    

                            </div>
                            <div id="BIDSEntities.ext" class="classattr">
                                <div class="attr variable">
            <span class="name">ext</span><span class="annotation">: Optional[str]</span>        =
<span class="default_value">None</span>

        
    </div>
    <a class="headerlink" href="#BIDSEntities.ext"></a>
    
    

                            </div>
                            <div id="BIDSEntities.extra_entities" class="classattr">
                                <div class="attr variable">
            <span class="name">extra_entities</span><span class="annotation">: Optional[Dict[str, Union[str, int]]]</span>

        
    </div>
    <a class="headerlink" href="#BIDSEntities.extra_entities"></a>
    
    

                            </div>
                            <div id="BIDSEntities.special" class="classattr">
                                        <input id="BIDSEntities.special-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator">@staticmethod</div>

        <span class="def">def</span>
        <span class="name">special</span><span class="signature pdoc-code condensed">(<span class="return-annotation">) -> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>:</span></span>

                <label class="view-source-button" for="BIDSEntities.special-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#BIDSEntities.special"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="BIDSEntities.special-133"><a href="#BIDSEntities.special-133"><span class="linenos">133</span></a>    <span class="nd">@staticmethod</span>
</span><span id="BIDSEntities.special-134"><a href="#BIDSEntities.special-134"><span class="linenos">134</span></a>    <span class="k">def</span> <span class="nf">special</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
</span><span id="BIDSEntities.special-135"><a href="#BIDSEntities.special-135"><span class="linenos">135</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="BIDSEntities.special-136"><a href="#BIDSEntities.special-136"><span class="linenos">136</span></a><span class="sd">        Get list of field keys which are not standard entities.</span>
</span><span id="BIDSEntities.special-137"><a href="#BIDSEntities.special-137"><span class="linenos">137</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="BIDSEntities.special-138"><a href="#BIDSEntities.special-138"><span class="linenos">138</span></a>        <span class="k">return</span> <span class="p">[</span><span class="s2">&quot;datatype&quot;</span><span class="p">,</span> <span class="s2">&quot;suffix&quot;</span><span class="p">,</span> <span class="s2">&quot;ext&quot;</span><span class="p">,</span> <span class="s2">&quot;extra_entities&quot;</span><span class="p">]</span>
</span></pre></div>


            <div class="docstring"><p>Get list of field keys which are not standard entities.</p>
</div>


                            </div>
                            <div id="BIDSEntities.from_dict" class="classattr">
                                        <input id="BIDSEntities.from_dict-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator">@classmethod</div>

        <span class="def">def</span>
        <span class="name">from_dict</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">cls</span>, </span><span class="param"><span class="n">entities</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span>, </span><span class="param"><span class="n">valid_only</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="BIDSEntities.from_dict-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#BIDSEntities.from_dict"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="BIDSEntities.from_dict-140"><a href="#BIDSEntities.from_dict-140"><span class="linenos">140</span></a>    <span class="nd">@classmethod</span>
</span><span id="BIDSEntities.from_dict-141"><a href="#BIDSEntities.from_dict-141"><span class="linenos">141</span></a>    <span class="k">def</span> <span class="nf">from_dict</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">entities</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span> <span class="n">valid_only</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">):</span>
</span><span id="BIDSEntities.from_dict-142"><a href="#BIDSEntities.from_dict-142"><span class="linenos">142</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="BIDSEntities.from_dict-143"><a href="#BIDSEntities.from_dict-143"><span class="linenos">143</span></a><span class="sd">        Initialize from a dict of entities.</span>
</span><span id="BIDSEntities.from_dict-144"><a href="#BIDSEntities.from_dict-144"><span class="linenos">144</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="BIDSEntities.from_dict-145"><a href="#BIDSEntities.from_dict-145"><span class="linenos">145</span></a>        <span class="n">filtered</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="BIDSEntities.from_dict-146"><a href="#BIDSEntities.from_dict-146"><span class="linenos">146</span></a>        <span class="n">extra_entities</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">]]</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="BIDSEntities.from_dict-147"><a href="#BIDSEntities.from_dict-147"><span class="linenos">147</span></a>        <span class="n">fields_map</span> <span class="o">=</span> <span class="p">{</span><span class="n">f</span><span class="o">.</span><span class="n">name</span><span class="p">:</span> <span class="n">f</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">fields</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span> <span class="k">if</span> <span class="n">f</span><span class="o">.</span><span class="n">name</span> <span class="o">!=</span> <span class="s2">&quot;extra_entities&quot;</span><span class="p">}</span>
</span><span id="BIDSEntities.from_dict-148"><a href="#BIDSEntities.from_dict-148"><span class="linenos">148</span></a>
</span><span id="BIDSEntities.from_dict-149"><a href="#BIDSEntities.from_dict-149"><span class="linenos">149</span></a>        <span class="k">def</span> <span class="nf">add_to_extra</span><span class="p">(</span><span class="n">k</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="n">v</span><span class="p">:</span> <span class="n">Any</span><span class="p">):</span>
</span><span id="BIDSEntities.from_dict-150"><a href="#BIDSEntities.from_dict-150"><span class="linenos">150</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
</span><span id="BIDSEntities.from_dict-151"><a href="#BIDSEntities.from_dict-151"><span class="linenos">151</span></a>                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
</span><span id="BIDSEntities.from_dict-152"><a href="#BIDSEntities.from_dict-152"><span class="linenos">152</span></a>                    <span class="sa">f</span><span class="s2">&quot;Extra entity </span><span class="si">{</span><span class="n">k</span><span class="si">}</span><span class="s2"> has type </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="si">}</span><span class="s2">; only str supported&quot;</span>
</span><span id="BIDSEntities.from_dict-153"><a href="#BIDSEntities.from_dict-153"><span class="linenos">153</span></a>                <span class="p">)</span>
</span><span id="BIDSEntities.from_dict-154"><a href="#BIDSEntities.from_dict-154"><span class="linenos">154</span></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">)):</span>
</span><span id="BIDSEntities.from_dict-155"><a href="#BIDSEntities.from_dict-155"><span class="linenos">155</span></a>                <span class="n">extra_entities</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">v</span>
</span><span id="BIDSEntities.from_dict-156"><a href="#BIDSEntities.from_dict-156"><span class="linenos">156</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="BIDSEntities.from_dict-157"><a href="#BIDSEntities.from_dict-157"><span class="linenos">157</span></a>                <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
</span><span id="BIDSEntities.from_dict-158"><a href="#BIDSEntities.from_dict-158"><span class="linenos">158</span></a>                    <span class="sa">f</span><span class="s2">&quot;Value </span><span class="si">{</span><span class="n">v</span><span class="si">}</span><span class="s2"> for extra entity </span><span class="si">{</span><span class="n">k</span><span class="si">}</span><span class="s2"> has type </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">v</span><span class="p">)</span><span class="si">}</span><span class="s2">; &quot;</span>
</span><span id="BIDSEntities.from_dict-159"><a href="#BIDSEntities.from_dict-159"><span class="linenos">159</span></a>                    <span class="sa">f</span><span class="s2">&quot;only str, int supported&quot;</span>
</span><span id="BIDSEntities.from_dict-160"><a href="#BIDSEntities.from_dict-160"><span class="linenos">160</span></a>                <span class="p">)</span>
</span><span id="BIDSEntities.from_dict-161"><a href="#BIDSEntities.from_dict-161"><span class="linenos">161</span></a>
</span><span id="BIDSEntities.from_dict-162"><a href="#BIDSEntities.from_dict-162"><span class="linenos">162</span></a>        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">entities</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="BIDSEntities.from_dict-163"><a href="#BIDSEntities.from_dict-163"><span class="linenos">163</span></a>            <span class="k">if</span> <span class="n">pd</span><span class="o">.</span><span class="n">isna</span><span class="p">(</span><span class="n">val</span><span class="p">):</span>
</span><span id="BIDSEntities.from_dict-164"><a href="#BIDSEntities.from_dict-164"><span class="linenos">164</span></a>                <span class="k">continue</span>
</span><span id="BIDSEntities.from_dict-165"><a href="#BIDSEntities.from_dict-165"><span class="linenos">165</span></a>
</span><span id="BIDSEntities.from_dict-166"><a href="#BIDSEntities.from_dict-166"><span class="linenos">166</span></a>            <span class="k">if</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">fields_map</span><span class="p">:</span>
</span><span id="BIDSEntities.from_dict-167"><a href="#BIDSEntities.from_dict-167"><span class="linenos">167</span></a>                <span class="n">fld</span> <span class="o">=</span> <span class="n">fields_map</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
</span><span id="BIDSEntities.from_dict-168"><a href="#BIDSEntities.from_dict-168"><span class="linenos">168</span></a>                <span class="n">typ</span> <span class="o">=</span> <span class="n">_get_type</span><span class="p">(</span><span class="n">fld</span><span class="o">.</span><span class="n">type</span><span class="p">)</span>
</span><span id="BIDSEntities.from_dict-169"><a href="#BIDSEntities.from_dict-169"><span class="linenos">169</span></a>                <span class="k">try</span><span class="p">:</span>
</span><span id="BIDSEntities.from_dict-170"><a href="#BIDSEntities.from_dict-170"><span class="linenos">170</span></a>                    <span class="n">val</span> <span class="o">=</span> <span class="n">typ</span><span class="p">(</span><span class="n">val</span><span class="p">)</span>
</span><span id="BIDSEntities.from_dict-171"><a href="#BIDSEntities.from_dict-171"><span class="linenos">171</span></a>                <span class="k">except</span> <span class="ne">ValueError</span> <span class="k">as</span> <span class="n">exc</span><span class="p">:</span>
</span><span id="BIDSEntities.from_dict-172"><a href="#BIDSEntities.from_dict-172"><span class="linenos">172</span></a>                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
</span><span id="BIDSEntities.from_dict-173"><a href="#BIDSEntities.from_dict-173"><span class="linenos">173</span></a>                        <span class="sa">f</span><span class="s2">&quot;Unable to coerce </span><span class="si">{</span><span class="nb">repr</span><span class="p">(</span><span class="n">val</span><span class="p">)</span><span class="si">}</span><span class="s2"> to type </span><span class="si">{</span><span class="n">typ</span><span class="si">}</span><span class="s2"> for &quot;</span>
</span><span id="BIDSEntities.from_dict-174"><a href="#BIDSEntities.from_dict-174"><span class="linenos">174</span></a>                        <span class="sa">f</span><span class="s2">&quot;entity </span><span class="si">{</span><span class="n">fld</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="BIDSEntities.from_dict-175"><a href="#BIDSEntities.from_dict-175"><span class="linenos">175</span></a>                    <span class="p">)</span> <span class="kn">from</span> <span class="nn">exc</span>
</span><span id="BIDSEntities.from_dict-176"><a href="#BIDSEntities.from_dict-176"><span class="linenos">176</span></a>
</span><span id="BIDSEntities.from_dict-177"><a href="#BIDSEntities.from_dict-177"><span class="linenos">177</span></a>                <span class="n">allowed_values</span> <span class="o">=</span> <span class="n">fld</span><span class="o">.</span><span class="n">metadata</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;allowed_values&quot;</span><span class="p">)</span>
</span><span id="BIDSEntities.from_dict-178"><a href="#BIDSEntities.from_dict-178"><span class="linenos">178</span></a>                <span class="k">if</span> <span class="n">allowed_values</span> <span class="ow">and</span> <span class="n">val</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">allowed_values</span><span class="p">:</span>
</span><span id="BIDSEntities.from_dict-179"><a href="#BIDSEntities.from_dict-179"><span class="linenos">179</span></a>                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
</span><span id="BIDSEntities.from_dict-180"><a href="#BIDSEntities.from_dict-180"><span class="linenos">180</span></a>                        <span class="sa">f</span><span class="s2">&quot;Value </span><span class="si">{</span><span class="n">val</span><span class="si">}</span><span class="s2"> for entity </span><span class="si">{</span><span class="n">fld</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2"> isn&#39;t one of the &quot;</span>
</span><span id="BIDSEntities.from_dict-181"><a href="#BIDSEntities.from_dict-181"><span class="linenos">181</span></a>                        <span class="sa">f</span><span class="s2">&quot;allowed values </span><span class="si">{</span><span class="n">allowed_values</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="BIDSEntities.from_dict-182"><a href="#BIDSEntities.from_dict-182"><span class="linenos">182</span></a>                    <span class="p">)</span>
</span><span id="BIDSEntities.from_dict-183"><a href="#BIDSEntities.from_dict-183"><span class="linenos">183</span></a>
</span><span id="BIDSEntities.from_dict-184"><a href="#BIDSEntities.from_dict-184"><span class="linenos">184</span></a>                <span class="n">filtered</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">val</span>
</span><span id="BIDSEntities.from_dict-185"><a href="#BIDSEntities.from_dict-185"><span class="linenos">185</span></a>
</span><span id="BIDSEntities.from_dict-186"><a href="#BIDSEntities.from_dict-186"><span class="linenos">186</span></a>            <span class="c1"># Special handling if the dict already contains &#39;extra_entities&#39;. This makes</span>
</span><span id="BIDSEntities.from_dict-187"><a href="#BIDSEntities.from_dict-187"><span class="linenos">187</span></a>            <span class="c1"># it easy to reconstruct entities from a df row.</span>
</span><span id="BIDSEntities.from_dict-188"><a href="#BIDSEntities.from_dict-188"><span class="linenos">188</span></a>            <span class="k">elif</span> <span class="n">key</span> <span class="o">==</span> <span class="s2">&quot;extra_entities&quot;</span><span class="p">:</span>
</span><span id="BIDSEntities.from_dict-189"><a href="#BIDSEntities.from_dict-189"><span class="linenos">189</span></a>                <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span>
</span><span id="BIDSEntities.from_dict-190"><a href="#BIDSEntities.from_dict-190"><span class="linenos">190</span></a>                    <span class="n">val</span><span class="p">,</span> <span class="nb">dict</span>
</span><span id="BIDSEntities.from_dict-191"><a href="#BIDSEntities.from_dict-191"><span class="linenos">191</span></a>                <span class="p">),</span> <span class="s2">&quot;Value for &#39;extra_entities&#39; key must be a dict&quot;</span>
</span><span id="BIDSEntities.from_dict-192"><a href="#BIDSEntities.from_dict-192"><span class="linenos">192</span></a>                <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">val</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="BIDSEntities.from_dict-193"><a href="#BIDSEntities.from_dict-193"><span class="linenos">193</span></a>                    <span class="n">add_to_extra</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span>
</span><span id="BIDSEntities.from_dict-194"><a href="#BIDSEntities.from_dict-194"><span class="linenos">194</span></a>
</span><span id="BIDSEntities.from_dict-195"><a href="#BIDSEntities.from_dict-195"><span class="linenos">195</span></a>            <span class="k">elif</span> <span class="ow">not</span> <span class="n">valid_only</span><span class="p">:</span>
</span><span id="BIDSEntities.from_dict-196"><a href="#BIDSEntities.from_dict-196"><span class="linenos">196</span></a>                <span class="n">add_to_extra</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">val</span><span class="p">)</span>
</span><span id="BIDSEntities.from_dict-197"><a href="#BIDSEntities.from_dict-197"><span class="linenos">197</span></a>
</span><span id="BIDSEntities.from_dict-198"><a href="#BIDSEntities.from_dict-198"><span class="linenos">198</span></a>        <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="o">**</span><span class="n">filtered</span><span class="p">,</span> <span class="n">extra_entities</span><span class="o">=</span><span class="n">extra_entities</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Initialize from a dict of entities.</p>
</div>


                            </div>
                            <div id="BIDSEntities.from_path" class="classattr">
                                        <input id="BIDSEntities.from_path-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator">@classmethod</div>

        <span class="def">def</span>
        <span class="name">from_path</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">cls</span>, </span><span class="param"><span class="n">path</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">]</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="BIDSEntities.from_path-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#BIDSEntities.from_path"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="BIDSEntities.from_path-200"><a href="#BIDSEntities.from_path-200"><span class="linenos">200</span></a>    <span class="nd">@classmethod</span>
</span><span id="BIDSEntities.from_path-201"><a href="#BIDSEntities.from_path-201"><span class="linenos">201</span></a>    <span class="k">def</span> <span class="nf">from_path</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">path</span><span class="p">:</span> <span class="n">StrOrPath</span><span class="p">):</span>
</span><span id="BIDSEntities.from_path-202"><a href="#BIDSEntities.from_path-202"><span class="linenos">202</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="BIDSEntities.from_path-203"><a href="#BIDSEntities.from_path-203"><span class="linenos">203</span></a><span class="sd">        Initialize from a file path.</span>
</span><span id="BIDSEntities.from_path-204"><a href="#BIDSEntities.from_path-204"><span class="linenos">204</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="BIDSEntities.from_path-205"><a href="#BIDSEntities.from_path-205"><span class="linenos">205</span></a>        <span class="n">entities</span> <span class="o">=</span> <span class="n">parse_bids_entities</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
</span><span id="BIDSEntities.from_path-206"><a href="#BIDSEntities.from_path-206"><span class="linenos">206</span></a>        <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span><span class="n">entities</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Initialize from a file path.</p>
</div>


                            </div>
                            <div id="BIDSEntities.to_dict" class="classattr">
                                        <input id="BIDSEntities.to_dict-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">to_dict</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">valid_only</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span></span><span class="return-annotation">) -> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span>:</span></span>

                <label class="view-source-button" for="BIDSEntities.to_dict-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#BIDSEntities.to_dict"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="BIDSEntities.to_dict-208"><a href="#BIDSEntities.to_dict-208"><span class="linenos">208</span></a>    <span class="k">def</span> <span class="nf">to_dict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">valid_only</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
</span><span id="BIDSEntities.to_dict-209"><a href="#BIDSEntities.to_dict-209"><span class="linenos">209</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="BIDSEntities.to_dict-210"><a href="#BIDSEntities.to_dict-210"><span class="linenos">210</span></a><span class="sd">        Convert entities to a plain dict.</span>
</span><span id="BIDSEntities.to_dict-211"><a href="#BIDSEntities.to_dict-211"><span class="linenos">211</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="BIDSEntities.to_dict-212"><a href="#BIDSEntities.to_dict-212"><span class="linenos">212</span></a>        <span class="n">data</span> <span class="o">=</span> <span class="n">asdict</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</span><span id="BIDSEntities.to_dict-213"><a href="#BIDSEntities.to_dict-213"><span class="linenos">213</span></a>        <span class="n">extra</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;extra_entities&quot;</span><span class="p">)</span>
</span><span id="BIDSEntities.to_dict-214"><a href="#BIDSEntities.to_dict-214"><span class="linenos">214</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">valid_only</span> <span class="ow">and</span> <span class="n">extra</span><span class="p">:</span>
</span><span id="BIDSEntities.to_dict-215"><a href="#BIDSEntities.to_dict-215"><span class="linenos">215</span></a>            <span class="n">data</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">extra</span><span class="p">)</span>
</span><span id="BIDSEntities.to_dict-216"><a href="#BIDSEntities.to_dict-216"><span class="linenos">216</span></a>        <span class="k">return</span> <span class="n">data</span>
</span></pre></div>


            <div class="docstring"><p>Convert entities to a plain dict.</p>
</div>


                            </div>
                            <div id="BIDSEntities.to_path" class="classattr">
                                        <input id="BIDSEntities.to_path-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">to_path</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">prefix</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">,</span> <span class="n">NoneType</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">valid_only</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>,</span><span class="param">	<span class="n">int_format</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%d</span><span class="s1">&#39;</span></span><span class="return-annotation">) -> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span>:</span></span>

                <label class="view-source-button" for="BIDSEntities.to_path-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#BIDSEntities.to_path"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="BIDSEntities.to_path-218"><a href="#BIDSEntities.to_path-218"><span class="linenos">218</span></a>    <span class="k">def</span> <span class="nf">to_path</span><span class="p">(</span>
</span><span id="BIDSEntities.to_path-219"><a href="#BIDSEntities.to_path-219"><span class="linenos">219</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="BIDSEntities.to_path-220"><a href="#BIDSEntities.to_path-220"><span class="linenos">220</span></a>        <span class="n">prefix</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">StrOrPath</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="BIDSEntities.to_path-221"><a href="#BIDSEntities.to_path-221"><span class="linenos">221</span></a>        <span class="n">valid_only</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="BIDSEntities.to_path-222"><a href="#BIDSEntities.to_path-222"><span class="linenos">222</span></a>        <span class="n">int_format</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%d</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="BIDSEntities.to_path-223"><a href="#BIDSEntities.to_path-223"><span class="linenos">223</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Path</span><span class="p">:</span>
</span><span id="BIDSEntities.to_path-224"><a href="#BIDSEntities.to_path-224"><span class="linenos">224</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="BIDSEntities.to_path-225"><a href="#BIDSEntities.to_path-225"><span class="linenos">225</span></a><span class="sd">        Generate a filepath based on the entitities.</span>
</span><span id="BIDSEntities.to_path-226"><a href="#BIDSEntities.to_path-226"><span class="linenos">226</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="BIDSEntities.to_path-227"><a href="#BIDSEntities.to_path-227"><span class="linenos">227</span></a>        <span class="n">special</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;datatype&quot;</span><span class="p">,</span> <span class="s2">&quot;suffix&quot;</span><span class="p">,</span> <span class="s2">&quot;ext&quot;</span><span class="p">}</span>
</span><span id="BIDSEntities.to_path-228"><a href="#BIDSEntities.to_path-228"><span class="linenos">228</span></a>        <span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">to_dict</span><span class="p">(</span><span class="n">valid_only</span><span class="o">=</span><span class="n">valid_only</span><span class="p">)</span>
</span><span id="BIDSEntities.to_path-229"><a href="#BIDSEntities.to_path-229"><span class="linenos">229</span></a>
</span><span id="BIDSEntities.to_path-230"><a href="#BIDSEntities.to_path-230"><span class="linenos">230</span></a>        <span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;_&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
</span><span id="BIDSEntities.to_path-231"><a href="#BIDSEntities.to_path-231"><span class="linenos">231</span></a>            <span class="n">_fmt_ent</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">int_format</span><span class="o">=</span><span class="n">int_format</span><span class="p">)</span>
</span><span id="BIDSEntities.to_path-232"><a href="#BIDSEntities.to_path-232"><span class="linenos">232</span></a>            <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
</span><span id="BIDSEntities.to_path-233"><a href="#BIDSEntities.to_path-233"><span class="linenos">233</span></a>            <span class="k">if</span> <span class="n">k</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">special</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">pd</span><span class="o">.</span><span class="n">isna</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
</span><span id="BIDSEntities.to_path-234"><a href="#BIDSEntities.to_path-234"><span class="linenos">234</span></a>        <span class="p">)</span>
</span><span id="BIDSEntities.to_path-235"><a href="#BIDSEntities.to_path-235"><span class="linenos">235</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">suffix</span><span class="p">:</span>
</span><span id="BIDSEntities.to_path-236"><a href="#BIDSEntities.to_path-236"><span class="linenos">236</span></a>            <span class="n">name</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;_</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">suffix</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="BIDSEntities.to_path-237"><a href="#BIDSEntities.to_path-237"><span class="linenos">237</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ext</span><span class="p">:</span>
</span><span id="BIDSEntities.to_path-238"><a href="#BIDSEntities.to_path-238"><span class="linenos">238</span></a>            <span class="n">name</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ext</span>
</span><span id="BIDSEntities.to_path-239"><a href="#BIDSEntities.to_path-239"><span class="linenos">239</span></a>
</span><span id="BIDSEntities.to_path-240"><a href="#BIDSEntities.to_path-240"><span class="linenos">240</span></a>        <span class="n">path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
</span><span id="BIDSEntities.to_path-241"><a href="#BIDSEntities.to_path-241"><span class="linenos">241</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">datatype</span><span class="p">:</span>
</span><span id="BIDSEntities.to_path-242"><a href="#BIDSEntities.to_path-242"><span class="linenos">242</span></a>            <span class="n">path</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">datatype</span> <span class="o">/</span> <span class="n">path</span>
</span><span id="BIDSEntities.to_path-243"><a href="#BIDSEntities.to_path-243"><span class="linenos">243</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ses</span><span class="p">:</span>
</span><span id="BIDSEntities.to_path-244"><a href="#BIDSEntities.to_path-244"><span class="linenos">244</span></a>            <span class="n">path</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;ses-</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">ses</span><span class="si">}</span><span class="s2">&quot;</span> <span class="o">/</span> <span class="n">path</span>
</span><span id="BIDSEntities.to_path-245"><a href="#BIDSEntities.to_path-245"><span class="linenos">245</span></a>        <span class="n">path</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;sub-</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">sub</span><span class="si">}</span><span class="s2">&quot;</span> <span class="o">/</span> <span class="n">path</span>
</span><span id="BIDSEntities.to_path-246"><a href="#BIDSEntities.to_path-246"><span class="linenos">246</span></a>        <span class="k">if</span> <span class="n">prefix</span><span class="p">:</span>
</span><span id="BIDSEntities.to_path-247"><a href="#BIDSEntities.to_path-247"><span class="linenos">247</span></a>            <span class="n">path</span> <span class="o">=</span> <span class="n">prefix</span> <span class="o">/</span> <span class="n">path</span>
</span><span id="BIDSEntities.to_path-248"><a href="#BIDSEntities.to_path-248"><span class="linenos">248</span></a>        <span class="k">return</span> <span class="n">path</span>
</span></pre></div>


            <div class="docstring"><p>Generate a filepath based on the entitities.</p>
</div>


                            </div>
                            <div id="BIDSEntities.with_update" class="classattr">
                                        <input id="BIDSEntities.with_update-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">with_update</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">entitities</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="o">**</span><span class="n">kwargs</span></span><span class="return-annotation">) -> <span class="n"><a href="#BIDSEntities">bids2table.BIDSEntities</a></span>:</span></span>

                <label class="view-source-button" for="BIDSEntities.with_update-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#BIDSEntities.with_update"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="BIDSEntities.with_update-250"><a href="#BIDSEntities.with_update-250"><span class="linenos">250</span></a>    <span class="k">def</span> <span class="nf">with_update</span><span class="p">(</span>
</span><span id="BIDSEntities.with_update-251"><a href="#BIDSEntities.with_update-251"><span class="linenos">251</span></a>        <span class="bp">self</span><span class="p">,</span> <span class="n">entitities</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
</span><span id="BIDSEntities.with_update-252"><a href="#BIDSEntities.with_update-252"><span class="linenos">252</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;BIDSEntities&quot;</span><span class="p">:</span>
</span><span id="BIDSEntities.with_update-253"><a href="#BIDSEntities.with_update-253"><span class="linenos">253</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="BIDSEntities.with_update-254"><a href="#BIDSEntities.with_update-254"><span class="linenos">254</span></a><span class="sd">        Create a new instance with updated entities.</span>
</span><span id="BIDSEntities.with_update-255"><a href="#BIDSEntities.with_update-255"><span class="linenos">255</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="BIDSEntities.with_update-256"><a href="#BIDSEntities.with_update-256"><span class="linenos">256</span></a>        <span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">to_dict</span><span class="p">(</span><span class="n">valid_only</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="BIDSEntities.with_update-257"><a href="#BIDSEntities.with_update-257"><span class="linenos">257</span></a>        <span class="k">if</span> <span class="n">entitities</span><span class="p">:</span>
</span><span id="BIDSEntities.with_update-258"><a href="#BIDSEntities.with_update-258"><span class="linenos">258</span></a>            <span class="n">data</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">entitities</span><span class="p">)</span>
</span><span id="BIDSEntities.with_update-259"><a href="#BIDSEntities.with_update-259"><span class="linenos">259</span></a>        <span class="k">if</span> <span class="n">kwargs</span><span class="p">:</span>
</span><span id="BIDSEntities.with_update-260"><a href="#BIDSEntities.with_update-260"><span class="linenos">260</span></a>            <span class="n">data</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="BIDSEntities.with_update-261"><a href="#BIDSEntities.with_update-261"><span class="linenos">261</span></a>        <span class="k">return</span> <span class="n">BIDSEntities</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Create a new instance with updated entities.</p>
</div>


                            </div>
                </section>
                <section id="parse_bids_entities">
                            <input id="parse_bids_entities-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator">@lru_cache()</div>

        <span class="def">def</span>
        <span class="name">parse_bids_entities</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">path</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">]</span></span><span class="return-annotation">) -> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span>:</span></span>

                <label class="view-source-button" for="parse_bids_entities-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#parse_bids_entities"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="parse_bids_entities-296"><a href="#parse_bids_entities-296"><span class="linenos">296</span></a><span class="nd">@lru_cache</span><span class="p">()</span>
</span><span id="parse_bids_entities-297"><a href="#parse_bids_entities-297"><span class="linenos">297</span></a><span class="k">def</span> <span class="nf">parse_bids_entities</span><span class="p">(</span><span class="n">path</span><span class="p">:</span> <span class="n">StrOrPath</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]:</span>
</span><span id="parse_bids_entities-298"><a href="#parse_bids_entities-298"><span class="linenos">298</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="parse_bids_entities-299"><a href="#parse_bids_entities-299"><span class="linenos">299</span></a><span class="sd">    Parse all BIDS filename ``&quot;{key}-{value}&quot;`` entities as well as special entities:</span>
</span><span id="parse_bids_entities-300"><a href="#parse_bids_entities-300"><span class="linenos">300</span></a>
</span><span id="parse_bids_entities-301"><a href="#parse_bids_entities-301"><span class="linenos">301</span></a><span class="sd">        - datatype</span>
</span><span id="parse_bids_entities-302"><a href="#parse_bids_entities-302"><span class="linenos">302</span></a><span class="sd">        - suffix</span>
</span><span id="parse_bids_entities-303"><a href="#parse_bids_entities-303"><span class="linenos">303</span></a><span class="sd">        - ext (extension)</span>
</span><span id="parse_bids_entities-304"><a href="#parse_bids_entities-304"><span class="linenos">304</span></a>
</span><span id="parse_bids_entities-305"><a href="#parse_bids_entities-305"><span class="linenos">305</span></a><span class="sd">    from the file path.</span>
</span><span id="parse_bids_entities-306"><a href="#parse_bids_entities-306"><span class="linenos">306</span></a>
</span><span id="parse_bids_entities-307"><a href="#parse_bids_entities-307"><span class="linenos">307</span></a><span class="sd">    .. note:: This function does not validate entities.</span>
</span><span id="parse_bids_entities-308"><a href="#parse_bids_entities-308"><span class="linenos">308</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="parse_bids_entities-309"><a href="#parse_bids_entities-309"><span class="linenos">309</span></a>    <span class="n">path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
</span><span id="parse_bids_entities-310"><a href="#parse_bids_entities-310"><span class="linenos">310</span></a>    <span class="n">entities</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="parse_bids_entities-311"><a href="#parse_bids_entities-311"><span class="linenos">311</span></a>
</span><span id="parse_bids_entities-312"><a href="#parse_bids_entities-312"><span class="linenos">312</span></a>    <span class="c1"># datatype</span>
</span><span id="parse_bids_entities-313"><a href="#parse_bids_entities-313"><span class="linenos">313</span></a>    <span class="n">match</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span>
</span><span id="parse_bids_entities-314"><a href="#parse_bids_entities-314"><span class="linenos">314</span></a>        <span class="sa">f</span><span class="s2">&quot;/(</span><span class="si">{</span><span class="s1">&#39;|&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">BIDS_DATATYPES</span><span class="p">)</span><span class="si">}</span><span class="s2">)/&quot;</span><span class="p">,</span>
</span><span id="parse_bids_entities-315"><a href="#parse_bids_entities-315"><span class="linenos">315</span></a>        <span class="n">path</span><span class="o">.</span><span class="n">as_posix</span><span class="p">(),</span>
</span><span id="parse_bids_entities-316"><a href="#parse_bids_entities-316"><span class="linenos">316</span></a>    <span class="p">)</span>
</span><span id="parse_bids_entities-317"><a href="#parse_bids_entities-317"><span class="linenos">317</span></a>    <span class="n">datatype</span> <span class="o">=</span> <span class="n">match</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="k">if</span> <span class="n">match</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="kc">None</span>
</span><span id="parse_bids_entities-318"><a href="#parse_bids_entities-318"><span class="linenos">318</span></a>
</span><span id="parse_bids_entities-319"><a href="#parse_bids_entities-319"><span class="linenos">319</span></a>    <span class="n">filename</span> <span class="o">=</span> <span class="n">path</span><span class="o">.</span><span class="n">name</span>
</span><span id="parse_bids_entities-320"><a href="#parse_bids_entities-320"><span class="linenos">320</span></a>    <span class="n">parts</span> <span class="o">=</span> <span class="n">filename</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">)</span>
</span><span id="parse_bids_entities-321"><a href="#parse_bids_entities-321"><span class="linenos">321</span></a>
</span><span id="parse_bids_entities-322"><a href="#parse_bids_entities-322"><span class="linenos">322</span></a>    <span class="c1"># suffix and extension</span>
</span><span id="parse_bids_entities-323"><a href="#parse_bids_entities-323"><span class="linenos">323</span></a>    <span class="n">suffix_ext</span> <span class="o">=</span> <span class="n">parts</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>
</span><span id="parse_bids_entities-324"><a href="#parse_bids_entities-324"><span class="linenos">324</span></a>    <span class="n">idx</span> <span class="o">=</span> <span class="n">suffix_ext</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">)</span>
</span><span id="parse_bids_entities-325"><a href="#parse_bids_entities-325"><span class="linenos">325</span></a>    <span class="k">if</span> <span class="n">idx</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="parse_bids_entities-326"><a href="#parse_bids_entities-326"><span class="linenos">326</span></a>        <span class="n">suffix</span><span class="p">,</span> <span class="n">ext</span> <span class="o">=</span> <span class="n">suffix_ext</span><span class="p">,</span> <span class="kc">None</span>
</span><span id="parse_bids_entities-327"><a href="#parse_bids_entities-327"><span class="linenos">327</span></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="parse_bids_entities-328"><a href="#parse_bids_entities-328"><span class="linenos">328</span></a>        <span class="n">suffix</span><span class="p">,</span> <span class="n">ext</span> <span class="o">=</span> <span class="n">suffix_ext</span><span class="p">[:</span><span class="n">idx</span><span class="p">],</span> <span class="n">suffix_ext</span><span class="p">[</span><span class="n">idx</span><span class="p">:]</span>
</span><span id="parse_bids_entities-329"><a href="#parse_bids_entities-329"><span class="linenos">329</span></a>
</span><span id="parse_bids_entities-330"><a href="#parse_bids_entities-330"><span class="linenos">330</span></a>    <span class="c1"># suffix is actually an entity, put back in list</span>
</span><span id="parse_bids_entities-331"><a href="#parse_bids_entities-331"><span class="linenos">331</span></a>    <span class="k">if</span> <span class="s2">&quot;-&quot;</span> <span class="ow">in</span> <span class="n">suffix</span><span class="p">:</span>
</span><span id="parse_bids_entities-332"><a href="#parse_bids_entities-332"><span class="linenos">332</span></a>        <span class="n">parts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">suffix</span><span class="p">)</span>
</span><span id="parse_bids_entities-333"><a href="#parse_bids_entities-333"><span class="linenos">333</span></a>        <span class="n">suffix</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="parse_bids_entities-334"><a href="#parse_bids_entities-334"><span class="linenos">334</span></a>
</span><span id="parse_bids_entities-335"><a href="#parse_bids_entities-335"><span class="linenos">335</span></a>    <span class="c1"># parse entities</span>
</span><span id="parse_bids_entities-336"><a href="#parse_bids_entities-336"><span class="linenos">336</span></a>    <span class="k">for</span> <span class="n">part</span> <span class="ow">in</span> <span class="n">parts</span><span class="p">:</span>
</span><span id="parse_bids_entities-337"><a href="#parse_bids_entities-337"><span class="linenos">337</span></a>        <span class="k">if</span> <span class="s2">&quot;-&quot;</span> <span class="ow">in</span> <span class="n">part</span><span class="p">:</span>
</span><span id="parse_bids_entities-338"><a href="#parse_bids_entities-338"><span class="linenos">338</span></a>            <span class="n">key</span><span class="p">,</span> <span class="n">val</span> <span class="o">=</span> <span class="n">part</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;-&quot;</span><span class="p">,</span> <span class="n">maxsplit</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span><span id="parse_bids_entities-339"><a href="#parse_bids_entities-339"><span class="linenos">339</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="parse_bids_entities-340"><a href="#parse_bids_entities-340"><span class="linenos">340</span></a>            <span class="n">key</span><span class="p">,</span> <span class="n">val</span> <span class="o">=</span> <span class="n">part</span><span class="p">,</span> <span class="s2">&quot;&quot;</span>
</span><span id="parse_bids_entities-341"><a href="#parse_bids_entities-341"><span class="linenos">341</span></a>        <span class="n">entities</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">val</span>
</span><span id="parse_bids_entities-342"><a href="#parse_bids_entities-342"><span class="linenos">342</span></a>
</span><span id="parse_bids_entities-343"><a href="#parse_bids_entities-343"><span class="linenos">343</span></a>    <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">([</span><span class="s2">&quot;datatype&quot;</span><span class="p">,</span> <span class="s2">&quot;suffix&quot;</span><span class="p">,</span> <span class="s2">&quot;ext&quot;</span><span class="p">],</span> <span class="p">[</span><span class="n">datatype</span><span class="p">,</span> <span class="n">suffix</span><span class="p">,</span> <span class="n">ext</span><span class="p">]):</span>
</span><span id="parse_bids_entities-344"><a href="#parse_bids_entities-344"><span class="linenos">344</span></a>        <span class="k">if</span> <span class="n">v</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="parse_bids_entities-345"><a href="#parse_bids_entities-345"><span class="linenos">345</span></a>            <span class="n">entities</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">v</span>
</span><span id="parse_bids_entities-346"><a href="#parse_bids_entities-346"><span class="linenos">346</span></a>    <span class="k">return</span> <span class="n">entities</span>
</span></pre></div>


            <div class="docstring"><p>Parse all BIDS filename <code>"{key}-{value}"</code> entities as well as special entities:</p>

<pre><code>- datatype
- suffix
- ext (extension)
</code></pre>

<p>from the file path.</p>

<div class="pdoc-alert pdoc-alert-note">

<h6 id="this-function-does-not-validate-entities">This function does not validate entities.</h6>

</div>
</div>


                </section>
                <section id="join_bids_path">
                            <input id="join_bids_path-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">join_bids_path</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">row</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">pandas</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">series</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]</span>,</span><span class="param">	<span class="n">prefix</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">,</span> <span class="n">NoneType</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">valid_only</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span></span><span class="return-annotation">) -> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span>:</span></span>

                <label class="view-source-button" for="join_bids_path-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#join_bids_path"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="join_bids_path-362"><a href="#join_bids_path-362"><span class="linenos">362</span></a><span class="k">def</span> <span class="nf">join_bids_path</span><span class="p">(</span>
</span><span id="join_bids_path-363"><a href="#join_bids_path-363"><span class="linenos">363</span></a>    <span class="n">row</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]],</span>
</span><span id="join_bids_path-364"><a href="#join_bids_path-364"><span class="linenos">364</span></a>    <span class="n">prefix</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Path</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="join_bids_path-365"><a href="#join_bids_path-365"><span class="linenos">365</span></a>    <span class="n">valid_only</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
</span><span id="join_bids_path-366"><a href="#join_bids_path-366"><span class="linenos">366</span></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Path</span><span class="p">:</span>
</span><span id="join_bids_path-367"><a href="#join_bids_path-367"><span class="linenos">367</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="join_bids_path-368"><a href="#join_bids_path-368"><span class="linenos">368</span></a><span class="sd">    Reconstruct a BIDS path from a table row or entities dict.</span>
</span><span id="join_bids_path-369"><a href="#join_bids_path-369"><span class="linenos">369</span></a>
</span><span id="join_bids_path-370"><a href="#join_bids_path-370"><span class="linenos">370</span></a><span class="sd">    Args:</span>
</span><span id="join_bids_path-371"><a href="#join_bids_path-371"><span class="linenos">371</span></a><span class="sd">        row: row from a `BIDSTable` or `BIDSTable.ent` subtable.</span>
</span><span id="join_bids_path-372"><a href="#join_bids_path-372"><span class="linenos">372</span></a><span class="sd">        prefix: output file prefix path.</span>
</span><span id="join_bids_path-373"><a href="#join_bids_path-373"><span class="linenos">373</span></a><span class="sd">        valid_only: only include valid BIDS entities.</span>
</span><span id="join_bids_path-374"><a href="#join_bids_path-374"><span class="linenos">374</span></a>
</span><span id="join_bids_path-375"><a href="#join_bids_path-375"><span class="linenos">375</span></a><span class="sd">    Example::</span>
</span><span id="join_bids_path-376"><a href="#join_bids_path-376"><span class="linenos">376</span></a>
</span><span id="join_bids_path-377"><a href="#join_bids_path-377"><span class="linenos">377</span></a><span class="sd">        tab = BIDSTable.from_parquet(&quot;dataset/index.b2t&quot;)</span>
</span><span id="join_bids_path-378"><a href="#join_bids_path-378"><span class="linenos">378</span></a><span class="sd">        paths = tab.apply(join_bids_path, axis=1)</span>
</span><span id="join_bids_path-379"><a href="#join_bids_path-379"><span class="linenos">379</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="join_bids_path-380"><a href="#join_bids_path-380"><span class="linenos">380</span></a>    <span class="c1"># Filter in case input is a row from the raw dataframe and not the entities group.</span>
</span><span id="join_bids_path-381"><a href="#join_bids_path-381"><span class="linenos">381</span></a>    <span class="n">row</span> <span class="o">=</span> <span class="n">_filter_row</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="n">group</span><span class="o">=</span><span class="s2">&quot;ent&quot;</span><span class="p">)</span>
</span><span id="join_bids_path-382"><a href="#join_bids_path-382"><span class="linenos">382</span></a>    <span class="n">entities</span> <span class="o">=</span> <span class="n">BIDSEntities</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="n">valid_only</span><span class="o">=</span><span class="n">valid_only</span><span class="p">)</span>
</span><span id="join_bids_path-383"><a href="#join_bids_path-383"><span class="linenos">383</span></a>    <span class="n">path</span> <span class="o">=</span> <span class="n">entities</span><span class="o">.</span><span class="n">to_path</span><span class="p">(</span><span class="n">prefix</span><span class="o">=</span><span class="n">prefix</span><span class="p">,</span> <span class="n">valid_only</span><span class="o">=</span><span class="n">valid_only</span><span class="p">)</span>
</span><span id="join_bids_path-384"><a href="#join_bids_path-384"><span class="linenos">384</span></a>    <span class="k">return</span> <span class="n">path</span>
</span></pre></div>


            <div class="docstring"><p>Reconstruct a BIDS path from a table row or entities dict.</p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>row:</strong>  row from a <code><a href="#BIDSTable">BIDSTable</a></code> or <code><a href="#BIDSTable.ent">BIDSTable.ent</a></code> subtable.</li>
<li><strong>prefix:</strong>  output file prefix path.</li>
<li><strong>valid_only:</strong>  only include valid BIDS entities.</li>
</ul>

<p>Example::</p>

<pre><code>tab = <a href="#BIDSTable.from_parquet">BIDSTable.from_parquet</a>("dataset/index.b2t")
paths = tab.apply(join_bids_path, axis=1)
</code></pre>
</div>


                </section>
    </main>
</body>
</html>